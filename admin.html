<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>לוח ניהול – יערת העמק</title>

  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="admin.css" />
  <link rel="stylesheet" href="admin-login-pretty.css" />


  <!-- ADMIN THEME (ONLY ADMIN) -->
  <script>
    (function () {
      try {
        const key = "admin_theme";
        const saved = localStorage.getItem(key);
        const theme = saved || "dark";
        document.documentElement.setAttribute("data-theme", theme);
      } catch {}
    })();
  </script>

  <style>
/* =========================
   ADMIN – CLEAN TOP BAR (DARK ONLY)
   ========================= */

/* רקע עמוד אדמין */
body.admin-page{
  background:
    radial-gradient(1200px 600px at 50% -10%, rgba(56,189,248,.18), transparent 60%),
    linear-gradient(180deg, #020617, #020617);
  color: #e3f2fd;
}

/* container רחב */
body.admin-page .container{
  max-width: 1400px !important;
  width: min(1400px, calc(100% - 40px)) !important;
  margin-inline: auto !important;
}

/* HEADER */
body.admin-page .header-main{
  position: sticky;
  top: 0;
  z-index: 9999;
  background: rgba(2,6,23,.75);
  border-bottom: 1px solid rgba(148,163,184,.18);
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
}

/* NAV STRUCTURE */
body.admin-page .admin-nav{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 18px;
  padding: 12px 0;
}

/* LEFT = LOGO */
body.admin-page .admin-nav-left{
  display: flex;
  align-items: center;
  flex-shrink: 0;
}

body.admin-page .logo-circle{
  width: 54px;
  height: 54px;
  border-radius: 999px;
  overflow: hidden;
  border: 2px solid rgba(56,189,248,.35);
  background: rgba(15,23,42,.55);
  box-shadow: 0 10px 26px rgba(0,0,0,.35);
  display: flex;
  align-items: center;
  justify-content: center;
}
body.admin-page .logo-img{
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* RIGHT = BUTTONS */
body.admin-page .admin-nav-right{
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 10px;
  flex-wrap: wrap;
}

/* BUTTON LOOK */
body.admin-page .admin-btn{
  display: inline-flex;
  align-items: center;
  justify-content: center;

  padding: 8px 16px;
  border-radius: 999px;

  font-size: .95rem;
  font-weight: 800;
  text-decoration: none;
  white-space: nowrap;

  color: #e5e7eb;
  background: rgba(15,23,42,.55);
  border: 1px solid rgba(148,163,184,.28);

  box-shadow: 0 10px 26px rgba(0,0,0,.25);
  transition: transform .15s ease, box-shadow .15s ease, background .2s ease, border-color .2s ease;
}

body.admin-page .admin-btn:hover{
  transform: translateY(-1px);
  background: rgba(15,23,42,.78);
  border-color: rgba(96,165,250,.55);
  box-shadow: 0 14px 34px rgba(0,0,0,.35);
}

/* ACTIVE */
body.admin-page .admin-btn.active{
  background: linear-gradient(135deg,#2563eb,#38bdf8);
  color: #fff;
  border-color: rgba(56,189,248,.55);
  box-shadow: 0 14px 42px rgba(37,99,235,.55);
}

/* ✅ המרחק שאתה רוצה: כפתורים רחוקים מהלוגו */
body.admin-page .admin-nav-right{
  margin-inline-start: 42px; /* ב-RTL זה יוצר רווח מהלוגו */
}

/* MOBILE */
@media (max-width: 900px){
  body.admin-page .admin-nav{
    gap: 12px;
  }
  body.admin-page .logo-circle{
    width: 48px;
    height: 48px;
  }
  body.admin-page .admin-btn{
    padding: 8px 12px;
    font-size: .9rem;
  }
  body.admin-page .admin-nav-right{
    margin-inline-start: 18px;
  }
}

/* =========================
   ADMIN COLUMNS (כמו שהיה)
   ========================= */
.admin-columns{
  display: grid !important;
  gap: 18px;
  align-items: start;
  margin-top: 10px;
}
@media (min-width: 1100px){
  .admin-columns{ grid-template-columns: repeat(3, minmax(0, 1fr)) !important; }
}
@media (min-width: 700px) and (max-width: 1099px){
  .admin-columns{ grid-template-columns: repeat(2, minmax(0, 1fr)) !important; }
}
@media (max-width: 699px){
  .admin-columns{ grid-template-columns: 1fr !important; }
}
.admin-grade-section,
.admin-columns > section,
.admin-columns > .card{
  min-width: 0 !important;
}

/* LIST/IMAGES */
.admin-list .admin-item{
  padding: 8px 10px;
  margin-bottom: 8px;
  border-radius: 12px;
}
.admin-images-row{
  display: flex;
  gap: 6px;
  margin-top: 4px;
  flex-wrap: wrap;
}
.admin-image-wrapper{
  width: 90px;
  height: 70px;
  flex: 0 0 auto;
  overflow: hidden;
  border-radius: 8px;
}
.admin-image-wrapper img.admin-image{
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}
.admin-item-body{
  font-size: 0.9rem;
  line-height: 1.45;
  max-height: 6.5em;
  overflow-y: auto;
}
.admin-class-title{
  font-size: 0.95rem;
  margin-top: 10px;
  margin-bottom: 4px;
  opacity: 0.9;
}
.admin-exam-item{
  border-radius: 10px;
  padding: 6px 8px;
  margin-bottom: 6px;
}

/* =========================
   LOGIN LINKS
   ========================= */
.login-links{
  margin-top: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;

  font-size: 0.85rem;
  font-weight: 600;
  color: #93c5fd;
}
.login-links a{
  color: #38bdf8;
  text-decoration: none;
  position: relative;
  transition: color .15s ease, text-shadow .15s ease;
}
.login-links a::after{
  content: "";
  position: absolute;
  left: 50%;
  bottom: -2px;
  width: 0;
  height: 2px;
  background: linear-gradient(90deg,#38bdf8,#2563eb);
  border-radius: 2px;
  transform: translateX(-50%);
  transition: width .2s ease;
}
.login-links a:hover{
  color: #7dd3fc;
  text-shadow: 0 0 6px rgba(56,189,248,.55);
}
.login-links a:hover::after{ width: 100%; }
.login-links .dot{
  color: #60a5fa;
  font-weight: 900;
  opacity: 0.8;
  cursor: default;
}

/* =========================
   MOBILE LAYOUT: prevent horizontal mess
   ========================= */
body.admin-page,
body.admin-page .container,
body.admin-page .card{
  overflow-x: hidden;
}

/* =========================================================
   ✅ FINAL MOBILE OVERRIDES (PUT LAST): 
   left hamburger | center logo | right grades
   Works with: admin-mobile-toggle/admin-mobile-menu + admin-grade-switcher
   ========================================================= */
@media (max-width: 900px){

  /* header becomes positioning context */
  body.admin-page .header-main{ position: sticky; top:0; z-index: 20000; }
  body.admin-page .header-main .container{ position: relative; }
  body.admin-page .admin-nav{ position: relative; min-height: 72px; padding: 10px 0; }

  /* hide desktop nav buttons */
  body.admin-page .admin-nav-right{ display:none !important; }

  /* center logo */
  body.admin-page .admin-nav-left{
    display:flex !important;
    position:absolute !important;
    left: 50% !important;
    top: 50% !important;
    transform: translate(-50%, -50%) !important;
    z-index: 20002 !important;
  }

  /* hamburger left */
  body.admin-page .admin-mobile-toggle{
    display:flex !important;
    position:absolute !important;
    left: 12px !important;
    right: auto !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    z-index: 20003 !important;

    width: 44px !important;
    height: 44px !important;
    border-radius: 14px !important;
    border: 1px solid rgba(148,163,184,.25) !important;
    background: rgba(2,6,23,.55) !important;
    backdrop-filter: blur(12px) !important;
    -webkit-backdrop-filter: blur(12px) !important;
    align-items:center !important;
    justify-content:center !important;
    gap:4px !important;
  }
  body.admin-page .admin-mobile-toggle span{
    display:block !important;
    width: 20px !important;
    height: 2px !important;
    background: rgba(226,232,240,.92) !important;
    border-radius: 3px !important;
  }

  /* mobile menu: fixed, opens from left under header */
  body.admin-page .admin-mobile-menu{
    position: fixed !important;
    top: 76px !important;
    left: 12px !important;
    right: auto !important;

    width: min(280px, calc(100vw - 24px)) !important;
    max-height: min(60vh, 520px) !important;
    overflow: auto !important;

    padding: 12px !important;
    border-radius: 18px !important;
    background: rgba(2,6,23,.92) !important;
    border: 1px solid rgba(148,163,184,.18) !important;
    box-shadow: 0 22px 55px rgba(0,0,0,.55) !important;
    backdrop-filter: blur(14px) !important;
    -webkit-backdrop-filter: blur(14px) !important;

    display:none !important;
    z-index: 20010 !important;
  }
  body.admin-page .admin-mobile-menu.open{ display:block !important; }

  body.admin-page .admin-mobile-menu a.admin-btn{
    display:flex !important;
    align-items:center !important;
    justify-content:flex-start !important;
    width:100% !important;

    padding: 12px 12px !important;
    margin: 8px 0 !important;

    border-radius: 14px !important;
    font-weight: 900 !important;
    font-size: 1rem !important;
    color:#e5e7eb !important;
    text-decoration:none !important;

    background: rgba(15,23,42,.55) !important;
    border: 1px solid rgba(148,163,184,.16) !important;
    box-shadow: none !important;
  }
  body.admin-page .admin-mobile-menu a.admin-btn.active{
    background: linear-gradient(135deg,#2563eb,#38bdf8) !important;
    border-color: rgba(56,189,248,.45) !important;
    color:#fff !important;
  }

  /* grades right (small, scrollable) */
  body.admin-page .admin-grade-switcher{
    position: absolute !important;
    right: 12px !important;
    left: auto !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    z-index: 20003 !important;

    display:flex !important;
    align-items:center !important;
    gap: 8px !important;

    max-width: 46vw !important;
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
    scrollbar-width: none !important;

    padding: 0 !important;
    margin: 0 !important;
    background: transparent !important;
    border: 0 !important;
    box-shadow: none !important;
  }
  body.admin-page .admin-grade-switcher::-webkit-scrollbar{ display:none; }

  body.admin-page .admin-grade-switcher .grade-filter-btn{
    all: unset;
    box-sizing: border-box;

    display:inline-flex !important;
    align-items:center !important;
    justify-content:center !important;

    padding: 7px 10px !important;
    border-radius: 999px !important;
    font-size: .82rem !important;
    font-weight: 900 !important;
    line-height: 1 !important;
    white-space: nowrap !important;
    cursor: pointer !important;

    background: rgba(15,23,42,.55) !important;
    color: #e5e7eb !important;
    border: 1px solid rgba(148,163,184,.22) !important;
  }
  body.admin-page .admin-grade-switcher .grade-filter-btn.active{
    background: linear-gradient(135deg,#22c55e,#38bdf8) !important;
    color: #06121f !important;
    border-color: rgba(56,189,248,.45) !important;
  }
}

/* תזוזה קטנה למעלה, שלא "ישב" באמצע ההדר */
@media (max-width: 600px){
  body.admin-page .admin-grade-switcher{
    top: 18px !important;
    transform: none !important;
  }
}

/* כשמציגים שכבה אחת בלבד – שתרחיב לרוחב מלא */
.admin-columns.one-visible{
  grid-template-columns: 1fr !important;
}
.admin-columns.one-visible > .admin-grade-section{
  grid-column: 1 / -1 !important;
}
/* ✅ FIX: הכפתורי שכבות לא יכסו את הסמל */
@media (max-width: 900px){

  /* הלוגו מעל הכל */
  body.admin-page .admin-nav-left{
    z-index: 30000 !important;
  }

  /* השכבות מתחת ללוגו + קצת יותר ימינה/מטה */
  body.admin-page .admin-grade-switcher{
    top: 56px !important;        /* היה 50%/18px -> עכשיו יורד מתחת לסמל */
    transform: none !important;
    max-width: 92vw !important;  /* שלא ייכנס על האמצע */
    padding-inline-start: 62px !important; /* מרווח כדי לא להתנגש בהמבורגר */
    padding-inline-end: 12px !important;
  }
}

/* במסכים ממש קטנים עוד טיפה למטה */
@media (max-width: 420px){
  body.admin-page .admin-grade-switcher{
    top: 60px !important;
  }
}
/* ✅ MOBILE: הכל לרוחב מלא, בלי רווח שחור בצד */
@media (max-width: 900px){

  /* הקונטיינר באמת 100% */
  body.admin-page .container{
    width: 100% !important;
    max-width: 100% !important;
    padding: 0 12px !important;  /* מרווח קטן מהקצוות */
    margin: 0 auto !important;
  }

  /* הגריד תמיד טור אחד */
  body.admin-page .admin-columns{
    grid-template-columns: 1fr !important;
    width: 100% !important;
  }

  /* כל ה-sections/כרטיסים יתפסו 100% */
  body.admin-page .admin-grade-section,
  body.admin-page .admin-columns > section,
  body.admin-page .card{
    width: 100% !important;
    max-width: 100% !important;
    margin: 0 !important;
    box-sizing: border-box !important;
  }

  /* למנוע “בריחה” שגורמת לרווחים */
  body.admin-page *{
    max-width: 100%;
  }
}
/* ✅ MOBILE TOPBAR: left hamburger | center logo | right grades (LOCK) */
@media (max-width: 900px){

  /* אבא */
  body.admin-page .header-main{ position: sticky; top:0; z-index: 30000; }
  body.admin-page .admin-nav{
    position: relative !important;
    min-height: 72px !important;
    padding: 10px 0 !important;
  }

  /* המבורגר בשמאל */
  body.admin-page .admin-mobile-toggle{
    display:flex !important;
    position:absolute !important;
    left: 12px !important;
    right: auto !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    z-index: 30003 !important;
  }

  /* הלוגו במרכז */
  body.admin-page .admin-nav-left{
    display:flex !important;
    position:absolute !important;
    left: 50% !important;
    right: auto !important;
    top: 50% !important;
    transform: translate(-50%, -50%) !important;
    z-index: 30002 !important;
  }

  /* השכבות בימין */
  body.admin-page .admin-grade-switcher{
    position:absolute !important;
    right: 12px !important;
    left: auto !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    z-index: 30003 !important;

    display:flex !important;
    gap: 8px !important;
    max-width: 46vw !important;
    overflow-x: auto !important;
    padding: 0 !important;
    margin: 0 !important;
    background: transparent !important;
    border: 0 !important;
    box-shadow: none !important;
  }

  /* מסתירים ניווט דסקטופ */
  body.admin-page .admin-nav-right{ display:none !important; }

  /* התפריט נפתח משמאל */
  body.admin-page .admin-mobile-menu{
    position: fixed !important;
    top: 76px !important;
    left: 12px !important;
    right: auto !important;
    z-index: 30010 !important;
  }
}

  </style>
</head>

<body class="admin-page" data-page="admin">

  <script type="module" src="analytics.js"></script>

  <!-- ✅ HEADER -->
  <header class="header-main">
    <div class="container">
      <div class="admin-nav">

        <div class="admin-nav-left">
          <a href="index.html" class="logo-circle" aria-label="דף הבית">
            <img src="https://i.ibb.co/tp4K737Y/Cropped-circle-image-1.png" class="logo-img" alt="סמל יערת העמק">
          </a>
        </div>

        <button class="admin-mobile-toggle" id="adminMobileToggle" aria-label="תפריט" aria-expanded="false">
          <span></span><span></span><span></span>
        </button>

        <div class="admin-mobile-menu" id="adminMobileMenu">
          <a href="admin.html" class="admin-btn active">Admin</a>
          <a href="#news" class="admin-btn">חדשות</a>
          <a href="#grades" class="admin-btn">השכבות</a>
          <a href="#exams" class="admin-btn">מבחנים</a>
          <a href="#board" class="admin-btn">מודעות</a>
          <a href="adminapps.html" class="admin-btn">כלי עריכה</a>
          <a href="#contact" class="admin-btn">יצירת קשר</a>
        </div>

        <div class="admin-nav-right">
          <a href="admin.html" class="admin-btn active">Admin</a>
          <a href="#news" class="admin-btn">חדשות</a>
          <a href="#grades" class="admin-btn">השכבות</a>
          <a href="#exams" class="admin-btn">מבחנים</a>
          <a href="#board" class="admin-btn">מודעות</a>
          <a href="adminapps.html" class="admin-btn">כלי עריכה</a>
          <a href="#contact" class="admin-btn">יצירת קשר</a>
        </div>

      </div>

      <!-- ✅ כפתורי שכבות בתוך ההדר (כדי שיעבוד ימין למעלה במובייל) -->
      <div class="admin-grade-switcher">
        <button class="grade-filter-btn active" data-grade="all">כל השכבות</button>
        <button class="grade-filter-btn" data-grade="z">שכבת ז'</button>
        <button class="grade-filter-btn" data-grade="h">שכבת ח'</button>
        <button class="grade-filter-btn" data-grade="t">שכבת ט'</button>
      </div>

    </div>
  </header>

  <section>
    <div class="container">

      <p id="auth-status" class="section-subtitle">בודק התחברות...</p>

      <!-- LOGIN -->
      <div id="login-section">
        <div class="section-header">
          <h2 class="section-title">התחברות אדמין</h2>
          <p class="section-subtitle">כניסה למנהלי המערכת בלבד</p>
        </div>

<form id="login-form" autocomplete="off" novalidate>
          <label>אימייל</label>
          <input type="email" name="email" required />

          <label>סיסמה</label>
          <input type="password" name="password" required />

          <button type="submit" style="width:100%;margin-top:10px;">כניסה</button>
        </form>

        <div class="login-links">
          <a class="login-link" href="reset-password.html">שכחתי סיסמה?</a>
          <span class="dot" aria-hidden="true">•</span>
          <a class="login-link" href="register.html">בקשת הרשמה</a>
        </div>
      </div>

      <!-- ADMIN PANEL -->
      <div id="admin-section" class="admin-layout" style="display:none;">
        <button id="logout-btn" class="btn-outline">התנתקות</button>

        <div class="section-header" id="contact">
          <h2 class="section-title">ניהול חדשות, מבחנים, מודעות ותוכן האתר</h2>
          <p class="section-subtitle">כל שינוי נשמר אוטומטית ונראה באתר התלמידים.</p>
        </div>

        <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:20px;">
          <a href="adminapps.html" target="_blank" class="btn-outline" style="display:inline-block;padding:8px 16px;border-radius:999px;">
            כלי עריכה נוספים 🛠️ קוד כניסה - 1992
          </a>
        </div>

        <!-- NEWS -->
        <div id="news"></div>
        <h3 class="section-title" style="font-size:1.2rem;margin-bottom:10px;">חדשות לפי כיתות</h3>
        <p class="section-subtitle">ניתן להוסיף עד שתי תמונות לידיעה (קישורים או קבצים) + צבע טקסט (אופציונלי).</p>

        <div class="admin-columns" id="grades">
          <!-- NEWS Z -->
          <section class="admin-grade-section" data-grade="z">
            <div class="card">
              <h3>שכבת ז'</h3>
              <div id="admin-news-z" class="admin-list"></div>

              <form id="news-form-z">
                <label>כיתה</label>
                <select name="classId" required>
                  <option value="">בחר כיתה</option>
                  <option value="z1">ז1</option>
                  <option value="z2">ז2</option>
                  <option value="z3">ז3</option>
                  <option value="z4">ז4</option>
                  <option value="z5">ז5</option>
                </select>

                <label>כותרת</label>
                <input name="title" />

                <label>מידע קצר (תאריך/אירוע)</label>
                <input name="meta" />

                <label>קישור לתמונה 1 (אופציונלי)</label>
                <input name="imageUrl" placeholder="https://..." />

                <label>תמונה 1 מקובץ (אופציונלי)</label>
                <input type="file" name="imageFile" accept="image/*" />

                <label>קישור לתמונה 2 (אופציונלי)</label>
                <input name="imageUrl2" placeholder="https://..." />

                <label>תמונה 2 מקובץ (אופציונלי)</label>
                <input type="file" name="imageFile2" accept="image/*" />

                <label>צבע הטקסט (אופציונלי)</label>
                <input type="color" name="color" value="#ffffff" />

                <label>תוכן הידיעה</label>
                <textarea name="body"></textarea>

                <button type="submit">הוסף חדשות לז'</button>
              </form>
            </div>
          </section>

          <!-- NEWS H -->
          <section class="admin-grade-section" data-grade="h">
            <div class="card">
              <h3>שכבת ח'</h3>
              <div id="admin-news-h" class="admin-list"></div>

              <form id="news-form-h">
                <label>כיתה</label>
                <select name="classId" required>
                  <option value="">בחר כיתה</option>
                  <option value="h1">ח1/7</option>
                  <option value="h4">ח4/8</option>
                  <option value="h5">ח5/9</option>
                  <option value="h6">ח6/10</option>
                </select>

                <label>כותרת</label>
                <input name="title" />

                <label>מידע קצר (תאריך/אירוע)</label>
                <input name="meta" />

                <label>קישור לתמונה 1 (אופציונלי)</label>
                <input name="imageUrl" placeholder="https://..." />

                <label>תמונה 1 מקובץ (אופציונלי)</label>
                <input type="file" name="imageFile" accept="image/*" />

                <label>קישור לתמונה 2 (אופציונלי)</label>
                <input name="imageUrl2" placeholder="https://..." />

                <label>תמונה 2 מקובץ (אופציונלי)</label>
                <input type="file" name="imageFile2" accept="image/*" />

                <label>צבע הטקסט (אופציונלי)</label>
                <input type="color" name="color" value="#ffffff" />

                <label>תוכן הידיעה</label>
                <textarea name="body"></textarea>

                <button type="submit">הוסף חדשות לח'</button>
              </form>
            </div>
          </section>

          <!-- NEWS T -->
          <section class="admin-grade-section" data-grade="t">
            <div class="card">
              <h3>שכבת ט'</h3>
              <div id="admin-news-t" class="admin-list"></div>

              <form id="news-form-t">
                <label>כיתה</label>
                <select name="classId" required>
                  <option value="">בחר כיתה</option>
                  <option value="t1">ט1</option>
                  <option value="t2">ט2</option>
                  <option value="t3">ט3</option>
                  <option value="t4">ט4</option>
                  <option value="t5">ט5</option>
                </select>

                <label>כותרת</label>
                <input name="title" />

                <label>מידע קצר (תאריך/אירוע)</label>
                <input name="meta" />

                <label>קישור לתמונה 1 (אופציונלי)</label>
                <input name="imageUrl" placeholder="https://..." />

                <label>תמונה 1 מקובץ (אופציונלי)</label>
                <input type="file" name="imageFile" accept="image/*" />

                <label>קישור לתמונה 2 (אופציונלי)</label>
                <input name="imageUrl2" placeholder="https://..." />

                <label>תמונה 2 מקובץ (אופציונלי)</label>
                <input type="file" name="imageFile2" accept="image/*" />

                <label>צבע הטקסט (אופציונלי)</label>
                <input type="color" name="color" value="#ffffff" />

                <label>תוכן הידיעה</label>
                <textarea name="body"></textarea>

                <button type="submit">הוסף חדשות לט'</button>
              </form>
            </div>
          </section>
        </div>

        <br><br>

        <!-- EXAMS -->
        <div id="exams"></div>
        <h3 class="section-title" style="font-size:1.2rem;margin-bottom:10px;">לוח מבחנים - נא לא למחוק מבחנים קיימים.</h3>

        <div class="admin-columns">
          <!-- Z -->
          <section class="admin-grade-section" data-grade="z">
            <div class="card">
              <h3>מבחנים · ז'</h3>
              <div id="admin-exams-z" class="admin-list"></div>

              <form id="exams-form-z" class="admin-form" data-grade="z">
                <label>תאריך המבחן</label>
                <input name="date" type="text" placeholder="למשל: 22/10/24" required />
                <label>שעת המבחן</label>
                <input type="time" name="time" />
                <label>מקצוע</label>
                <input name="subject" />
                <label>כיתה</label>
                <select name="classId" required>
                  <option value="">בחר כיתה</option>
                  <option value="z1">ז1</option><option value="z2">ז2</option><option value="z3">ז3</option><option value="z4">ז4</option><option value="z5">ז5</option>
                </select>
                <label>נושא המבחן</label>
                <textarea name="topic"></textarea>
                <label>קישור לתמונה (אופציונלי)</label>
                <input name="imageUrl" placeholder="https://..." />
                <button type="submit">הוסף מבחן לז'</button>
              </form>
            </div>
          </section>

          <!-- H -->
          <section class="admin-grade-section" data-grade="h">
            <div class="card">
              <h3>מבחנים · ח'</h3>
              <div id="admin-exams-h" class="admin-list"></div>

              <form id="exams-form-h" class="admin-form" data-grade="h">
                <label>תאריך המבחן</label>
                <input name="date" type="text" placeholder="למשל: 22/10/24" required />
                <label>שעת המבחן</label>
                <input name="time" type="time" />
                <label>מקצוע</label>
                <input name="subject" />
                <label>כיתה</label>
                <select name="classId" required>
                  <option value="">בחר כיתה</option>
                  <option value="h1">ח1/7</option><option value="h4">ח4/8</option><option value="h5">ח5/9</option><option value="h6">ח6/10</option>
                </select>
                <label>נושא המבחן</label>
                <textarea name="topic"></textarea>
                <label>קישור לתמונה (אופציונלי)</label>
                <input name="imageUrl" placeholder="https://..." />
                <button type="submit">הוסף מבחן לח'</button>
              </form>
            </div>
          </section>

          <!-- T -->
          <section class="admin-grade-section" data-grade="t">
            <div class="card">
              <h3>מבחנים · ט'</h3>
              <div id="admin-exams-t" class="admin-list"></div>

              <form id="exams-form-t" class="admin-form" data-grade="t">
                <label>תאריך המבחן</label>
                <input name="date" type="text" placeholder="למשל: 22/10/24" required />
                <label>שעת המבחן</label>
                <input name="time" type="time" />
                <label>מקצוע</label>
                <input name="subject" />
                <label>כיתה</label>
                <select name="classId" required>
                  <option value="">בחר כיתה</option>
                  <option value="t1">ט1</option><option value="t2">ט2</option><option value="t3">ט3</option><option value="t4">ט4</option><option value="t5">ט5</option>
                </select>
                <label>נושא המבחן</label>
                <textarea name="topic"></textarea>
                <label>קישור לתמונה (אופציונלי)</label>
                <input name="imageUrl" placeholder="https://..." />
                <button type="submit">הוסף מבחן לט'</button>
              </form>
            </div>
          </section>
        </div>

<br><br>

<!-- TASKS -->
<div id="tasks"></div>
<h3 class="section-title" style="font-size:1.2rem;margin-bottom:10px;">משימות לפי כיתות</h3>
<p class="section-subtitle">הוספת משימה תופיע בדף הכיתה אוטומטית (כמו חדשות/מבחנים).</p>

<div class="admin-columns">
  <!-- TASKS Z -->
  <section class="admin-grade-section" data-grade="z">
    <div class="card">
      <h3>משימות · ז'</h3>
      <div id="admin-tasks-z" class="admin-list"></div>

      <form id="tasks-form-z" class="admin-form" data-grade="z">
        <label>כיתה</label>
        <select name="classId" required>
          <option value="">בחר כיתה</option>
          <option value="z1">ז1</option><option value="z2">ז2</option><option value="z3">ז3</option><option value="z4">ז4</option><option value="z5">ז5</option>
        </select>

        <label>מקצוע (אופציונלי)</label>
        <input name="subject" placeholder="מתמטיקה / אנגלית..." />

        <label>כותרת משימה</label>
        <input name="title" placeholder="לדוגמה: שיעורי בית" required />

        <label>תיאור המשימה</label>
        <textarea name="text" placeholder="מה צריך לעשות?" required></textarea>

        <label>דדליין (תאריך ושעה)</label>
        <input name="dueAt" type="datetime-local" required />
<label>קובץ מצורף (אופציונלי)</label>
<input type="file" name="file" accept=".pdf,.doc,.docx,.ppt,.pptx,.xlsx,.png,.jpg,.jpeg" />

        <button type="submit">הוסף משימה לז'</button>
      </form>
    </div>
  </section>

  <!-- TASKS H -->
  <section class="admin-grade-section" data-grade="h">
    <div class="card">
      <h3>משימות · ח'</h3>
      <div id="admin-tasks-h" class="admin-list"></div>

      <form id="tasks-form-h" class="admin-form" data-grade="h">
        <label>כיתה</label>
        <select name="classId" required>
          <option value="">בחר כיתה</option>
          <option value="h1">ח1/7</option><option value="h4">ח4/8</option><option value="h5">ח5/9</option><option value="h6">ח6/10</option>
        </select>

        <label>מקצוע (אופציונלי)</label>
        <input name="subject" placeholder="מתמטיקה / אנגלית..." />

        <label>כותרת משימה</label>
        <input name="title" placeholder="לדוגמה: להביא ציוד" required />

        <label>תיאור המשימה</label>
        <textarea name="text" placeholder="מה צריך לעשות?" required></textarea>

        <label>דדליין (תאריך ושעה)</label>
        <input name="dueAt" type="datetime-local" required />
<label>קובץ מצורף (אופציונלי)</label>
<input type="file" name="file" accept=".pdf,.doc,.docx,.ppt,.pptx,.xlsx,.png,.jpg,.jpeg" />

        <button type="submit">הוסף משימה לח'</button>
      </form>
    </div>
  </section>

  <!-- TASKS T -->
  <section class="admin-grade-section" data-grade="t">
    <div class="card">
      <h3>משימות · ט'</h3>
      <div id="admin-tasks-t" class="admin-list"></div>

      <form id="tasks-form-t" class="admin-form" data-grade="t">
        <label>כיתה</label>
        <select name="classId" required>
          <option value="">בחר כיתה</option>
          <option value="t1">ט1</option><option value="t2">ט2</option><option value="t3">ט3</option><option value="t4">ט4</option><option value="t5">ט5</option>
        </select>

        <label>מקצוע (אופציונלי)</label>
        <input name="subject" placeholder="מתמטיקה / אנגלית..." />

        <label>כותרת משימה</label>
        <input name="title" placeholder="לדוגמה: עבודה להגשה" required />

        <label>תיאור המשימה</label>
        <textarea name="text" placeholder="מה צריך לעשות?" required></textarea>

        <label>דדליין (תאריך ושעה)</label>
        <input name="dueAt" type="datetime-local" required />
<label>קובץ מצורף (אופציונלי)</label>
<input type="file" name="file" accept=".pdf,.doc,.docx,.ppt,.pptx,.xlsx,.png,.jpg,.jpeg" />

        <button type="submit">הוסף משימה לט'</button>
      </form>
    </div>
  </section>
</div>

        <div class="card" style="margin-top:16px;">
          <h3 style="margin:0 0 10px;">הודעה דחופה</h3>

          <label style="display:flex; gap:10px; align-items:center; margin-bottom:10px;">
            <input type="checkbox" id="urgentActive">
            <span>פעילה</span>
          </label>

          <label style="display:block; margin-bottom:8px; font-weight:800;">סוג</label>
          <select id="urgentType" style="width:100%; padding:10px; border-radius:12px; margin-bottom:10px;">
            <option value="info">רגילה (כחול)</option>
            <option value="warn">אזהרה (צהוב)</option>
            <option value="danger">דחוף (אדום)</option>
          </select>

          <label style="display:block; margin-bottom:8px; font-weight:800;">טקסט</label>
          <textarea id="urgentText" rows="3" style="width:100%; padding:10px; border-radius:12px;"></textarea>

          <label>צבע הודעה</label>
          <input id="urgentColor" type="color" value="#fbbf24">

          <div style="display:flex; gap:10px; margin-top:10px;">
            <button id="urgentSave" class="btn">שמירה</button>
            <button id="urgentClear" class="btn" style="opacity:.85;">מחיקה</button>
          </div>

          <div id="urgentStatus" style="margin-top:10px; opacity:.8;"></div>
        </div>

        <!-- BOARD -->
        <div id="board"></div>
        <h3 class="section-title" style="font-size:1.2rem;margin-bottom:10px;">
          לוח מודעות נא לא למחוק מודעות אחרות,זה מוחק את דף הכתבה
        </h3>

        <div class="admin-columns">
          <div class="card">
            <h3>מודעות כלליות</h3>
            <div id="admin-board" class="admin-list"></div>

            <form id="board-form">
              <label>כותרת</label><input name="title" />
              <label>מידע קצר (מי קהל היעד, תאריך וכו')</label><input name="meta" />
              <label>צבע הטקסט (אופציונלי)</label><input type="color" name="color" value="#ffffff" />

              <label>קישור לתמונה 1 (אופציונלי)</label><input name="imageUrl" placeholder="https://..." />
              <label>העלה קובץ תמונה 1 (אופציונלי)</label><input type="file" name="imageFile" accept="image/*" />

              <label>קישור לתמונה 2 (אופציונלי)</label><input name="imageUrl2" placeholder="https://..." />
              <label>העלה קובץ תמונה 2 (אופציונלי)</label><input type="file" name="imageFile2" accept="image/*" />

              <label>קישור לתמונה 3 (אופציונלי)</label><input name="imageUrl3" placeholder="https://..." />
              <label>העלה קובץ תמונה 3 (אופציונלי)</label><input type="file" name="imageFile3" accept="image/*" />

              <label>תוכן המודעה</label><textarea name="body"></textarea>
              <button type="submit">הוסף מודעה</button>
            </form>
          </div>
        </div>

        <br><br>

        <!-- SITE CONTENT -->
        <div id="sitecontent"></div>
        <h3 class="section-title" style="font-size:1.2rem;margin-bottom:10px;">ניהול תוכן האתר</h3>
        <p class="section-subtitle">כל השדות כאן נשמרים במסמך Firestore אחד (siteContent/main) ומוזנים לכל חלקי האתר.</p>

        <div class="admin-columns">
          <div class="card">
            <h3>טקסטים כלליים</h3>

            <form id="site-content-form" class="admin-form">
              <h4>דף בית – אזור הירו (המשפטים הגדולים למעלה)</h4>
              <label>כותרת ראשית בהירו</label>
              <input name="homeHeroTitle" placeholder="ברוכים הבאים ליערת העמק" />
              <label>תת־כותרת בהירו</label>
              <input name="homeHeroSubtitle" placeholder="סביבת למידה בטוחה, תומכת ומובילה..." />

              <h4 style="margin-top:16px;">תיבת "מידע מהיר" בהירו</h4>
              <label>כותרת התיבה</label>
              <input name="heroSideTitle" placeholder="מידע מהיר" />
              <label>שורות 'מידע מהיר' (כל שורה – שורה בנפרד ברשימה)</label>
              <textarea name="heroSideList" rows="3"
                placeholder="📍 מגדל העמק&#10;🧑‍🎓 שכבות ז'–ט'&#10;👩‍🏫 צוות חינוכי מסור&#10;🤝 שיתופי פעולה קהילתיים"></textarea>

              <h4 style="margin-top:16px;">אודות בית הספר</h4>
              <label>כותרת אודות</label>
              <input name="aboutTitle" placeholder="אודות בית הספר יערת העמק" />
              <label>טקסט אודות</label>
              <textarea name="aboutBody" rows="4" placeholder="כמה משפטים על בית הספר, הערכים, האווירה..."></textarea>

              <h4 style="margin-top:16px;">מדור "חשוב לדעת"</h4>
              <label>כותרת המדור</label>
              <input name="importantTitle" placeholder="חשוב לדעת" />
              <label>תת־כותרת המדור</label>
              <input name="importantSubtitle" placeholder="כמה דברים שימושיים לתלמידים – לפני שממשיכים לגלול." />

              <h5 style="margin-top:10px;">כרטיס 1</h5>
              <label>כותרת כרטיס 1</label>
              <input name="importantCard1Title" placeholder="לדוגמה: 💻 סביבת למידה דיגיטלית" />
              <label>טקסט כרטיס 1</label>
              <textarea name="importantCard1Body" rows="2"></textarea>

              <h5 style="margin-top:10px;">כרטיס 2</h5>
              <label>כותרת כרטיס 2</label>
              <input name="importantCard2Title" placeholder="לדוגמה: 🤝 עם מי מדברים?" />
              <label>טקסט כרטיס 2</label>
              <textarea name="importantCard2Body" rows="2"></textarea>

              <h5 style="margin-top:10px;">כרטיס 3</h5>
              <label>כותרת כרטיס 3</label>
              <input name="importantCard3Title" placeholder="לדוגמה: 📌 טיפ נוסף" />
              <label>טקסט כרטיס 3</label>
              <textarea name="importantCard3Body" rows="2"></textarea>

              <h4 style="margin-top:16px;">כותרות למדורי דף הבית</h4>
              <label>כותרת מדור חדשות</label>
              <input name="homeNewsTitle" placeholder="חדשות אחרונות" />
              <label>תת־כותרת מדור חדשות</label>
              <input name="homeNewsSubtitle" placeholder="שלושת העדכונים האחרונים מכל שכבה – ישר מול העיניים של התלמידים." />
              <label>כותרת מדור לוח מודעות</label>
              <input name="boardTitle" placeholder="לוח מודעות" />
              <label>תת־כותרת מדור לוח מודעות</label>
              <input name="boardSubtitle" placeholder="הודעות חשובות, פעילויות ואירועים לבית הספר." />
              <label>כותרת מדור מבחנים</label>
              <input name="homeExamsTitle" placeholder="מבחנים קרובים" />
              <label>תת־כותרת מדור מבחנים</label>
              <input name="homeExamsSubtitle" placeholder="תאריכים, מקצועות ונושאים – כדי שאף אחד לא יפספס." />

              <h4 style="margin-top:16px;">מדור "היכרות עם השכבות"</h4>
              <label>כותרת המדור</label>
              <input name="gradesSectionTitle" placeholder="היכרות עם השכבות" />
              <label>תת־כותרת המדור</label>
              <input name="gradesSectionSubtitle" placeholder="בחר שכבה כדי לראות חדשות, מבחנים ועדכונים שמתאימים אליך." />

              <h5 style="margin-top:10px;">תיאור שכבות</h5>
              <label>תיאור שכבת ז'</label>
              <textarea name="zDescription" rows="2" placeholder="משפט על שכבת ז'..."></textarea>
              <label>תיאור שכבת ח'</label>
              <textarea name="hDescription" rows="2" placeholder="משפט על שכבת ח'..."></textarea>
              <label>תיאור שכבת ט'</label>
              <textarea name="tDescription" rows="2" placeholder="משפט על שכבת ט'..."></textarea>

              <h4 style="margin-top:16px;">תיבת בקשות</h4>
              <label>כותרת המדור</label>
              <input name="requestsTitle" placeholder="תיבת בקשות" />
              <label>תת־כותרת</label>
              <input name="requestsSubtitle" placeholder="רוצים לבקש משהו? יש רעיון?" />
              <label>טקסט מעל הכפתור</label>
              <textarea name="requestsBody" rows="2" placeholder="למילוי טופס הבקשות – לחצו כאן:"></textarea>

              <h4 style="margin-top:16px;">יצירת קשר</h4>
              <label>כותרת המדור</label>
              <input name="contactSectionTitle" placeholder="יצירת קשר" />
              <label>תת־כותרת המדור</label>
              <input name="contactSectionSubtitle" placeholder="ניתן לפנות אלינו בכל שאלה, בקשה או התייעצות." />
              <label>טלפון</label>
              <input name="contactPhone" placeholder="04-XXXXXXX" />
              <label>אימייל</label>
              <input name="contactEmail" placeholder="school@example.com" />
              <label>כתובת</label>
              <input name="contactAddress" placeholder="רחוב..., מגדל העמק" />

              <h4 style="margin-top:16px;">פוטר</h4>
              <label>טקסט תחתון (פוטר)</label>
              <input name="footerText" placeholder="© כל הזכויות שמורות לבית ספר יערת העמק" />

              <button type="submit" style="margin-top:16px;">שמור תוכן אתר</button>
            </form>
          </div>
        </div>

      </div><!-- /#admin-section -->

    </div><!-- /.container -->
  </section>

  <!-- ✅ THEME + MOBILE NAV (ADMIN ONLY) -->
  <script>
document.addEventListener("DOMContentLoaded", () => {
  const gradeButtons = document.querySelectorAll(".grade-filter-btn");
  const gradeSections = document.querySelectorAll(".admin-grade-section[data-grade]");
  const columns = document.querySelector(".admin-columns");

  if (!gradeButtons.length || !gradeSections.length) {
    console.warn("Grade filter: elements not found");
    return;
  }

  function updateOneVisibleClass() {
    if (!columns) return;
    const visibleCount = Array.from(gradeSections).filter(
      (sec) => sec.style.display !== "none"
    ).length;
    columns.classList.toggle("one-visible", visibleCount === 1);
  }

  gradeButtons.forEach((btn) => {
    btn.addEventListener("click", () => {
      const selected = btn.dataset.grade || "all";

      gradeButtons.forEach((b) => b.classList.remove("active"));
      btn.classList.add("active");

      gradeSections.forEach((sec) => {
        const g = sec.dataset.grade;
        sec.style.display = selected === "all" || g === selected ? "" : "none";
      });

      updateOneVisibleClass();
    });
  });

  updateOneVisibleClass();
});

// ===== MOBILE MENU TOGGLE (admin) =====
document.addEventListener("DOMContentLoaded", () => {
  const toggle = document.getElementById("adminMobileToggle");
  const menu = document.getElementById("adminMobileMenu");
  if (!toggle || !menu) return;

  const closeMenu = () => {
    menu.classList.remove("open");
    toggle.setAttribute("aria-expanded", "false");
  };

  toggle.addEventListener("click", (e) => {
    e.preventDefault();
    e.stopPropagation();
    menu.classList.toggle("open");
    toggle.setAttribute(
      "aria-expanded",
      menu.classList.contains("open") ? "true" : "false"
    );
  });

  document.addEventListener("click", (e) => {
    if (!menu.classList.contains("open")) return;
    if (menu.contains(e.target) || toggle.contains(e.target)) return;
    closeMenu();
  });

  menu.querySelectorAll("a").forEach((a) => {
    a.addEventListener("click", () => closeMenu());
  });

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") closeMenu();
  });
});

    (function () {
      const key = "admin_theme";
      const themeBtn = document.getElementById("admin-theme-toggle");
      const navToggle = document.getElementById("navToggle");
      const navMobile = document.getElementById("nav-mobile");

      function setIcon(theme){
        if (!themeBtn) return;
        themeBtn.textContent = (theme === "dark") ? "🌙" : "☀️";
      }

      function apply(theme){
        document.documentElement.setAttribute("data-theme", theme);
        try { localStorage.setItem(key, theme); } catch {}
        setIcon(theme);
      }

      const current = document.documentElement.getAttribute("data-theme") || "dark";
      apply(current);

      if (themeBtn){
        themeBtn.addEventListener("click", function(){
          const now = document.documentElement.getAttribute("data-theme") || "dark";
          apply(now === "dark" ? "light" : "dark");
        });
      }

      if (navToggle && navMobile){
        navToggle.addEventListener("click", () => navMobile.classList.toggle("open"));
        navMobile.querySelectorAll("a").forEach(a=>{
          a.addEventListener("click", ()=> navMobile.classList.remove("open"));
        });
        document.addEventListener("click", (e)=>{
          if (!navMobile.classList.contains("open")) return;
          const inside = navMobile.contains(e.target) || navToggle.contains(e.target);
          if (!inside) navMobile.classList.remove("open");
        });
      }
    })();
  </script>

  <script type="module" src="admin.js?v=7"></script>
  <script type="module" src="admin-tasks.js?v=1"></script>
  <script type="module" src="./admin-urgent.js"></script>
  <script src="accessibility.js"></script>
</body>
</html>