<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <!-- BASIC -->
  <meta charset="UTF-8" />
  <meta http-equiv="Content-Language" content="he" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- TITLE -->
  <title>×—×˜×™×‘×ª ×”× ×¢×•×¨×™× ×™×¢×¨×ª ×”×¢××§ â€“ ×”××ª×¨ ×”×¨×©××™</title>

  <!-- SEO -->
  <meta name="description" content="×”××ª×¨ ×”×¨×©××™ ×©×œ ×—×˜×™×‘×ª ×”× ×¢×•×¨×™× ×™×¢×¨×ª ×”×¢××§ ×‘××’×“×œ ×”×¢××§. ×—×“×©×•×ª, ×œ×•×— ××‘×—× ×™×, ×œ×•×— ××•×“×¢×•×ª, ××™×“×¢ ×œ×©×›×‘×•×ª ×–'-×˜' ×•×™×¦×™×¨×ª ×§×©×¨ ×¢× ×¦×•×•×ª ×‘×™×ª ×”×¡×¤×¨ â€“ ×”×›×œ ×‘××§×•× ××—×“." />
  <meta name="keywords" content="×™×¢×¨×ª ×”×¢××§, ×—×˜×™×‘×ª ×”× ×¢×•×¨×™× ×™×¢×¨×ª ×”×¢××§, ×—×˜×™×‘×ª ×‘×™× ×™×™×, ××’×“×œ ×”×¢××§, ×©×›×‘×ª ×–, ×©×›×‘×ª ×—, ×©×›×‘×ª ×˜, ×—×“×©×•×ª ×‘×™×ª ×¡×¤×¨, ××‘×—× ×™×" />
  <meta name="robots" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1" />

  <!-- CANONICAL -->
  <link rel="canonical" href="https://yaarathaemek.online/" />

  <!-- PWA -->
  <link rel="manifest" href="/manifest.json" />
  <meta name="theme-color" content="#2563eb" />
  <meta name="application-name" content="×—×˜×™×‘×ª ×”× ×¢×•×¨×™× ×™×¢×¨×ª ×”×¢××§" />
  <meta name="apple-mobile-web-app-title" content="×—×˜×™×‘×ª ×”× ×¢×•×¨×™× ×™×¢×¨×ª ×”×¢××§" />

  <!-- FAVICONS (×ª××•× ×” ×§×˜× ×” ×‘×’×•×’×œ ×œ×¨×•×‘ ××’×™×¢×” ××¤×”) -->
  <link rel="icon" href="/favicon.ico" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="192x192" href="/favicon-192x192.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />

  <!-- GOOGLE VERIFICATION -->
  <meta name="google-site-verification" content="014e0d8fdc8f329c" />

  <!-- OPEN GRAPH (×ª××•× ×” ×œ×©×™×ª×•×£/×ª×¦×•×’×”) -->
  <meta property="og:title" content="×—×˜×™×‘×ª ×”× ×¢×•×¨×™× ×™×¢×¨×ª ×”×¢××§ â€“ ×”××ª×¨ ×”×¨×©××™" />
  <meta property="og:description" content="×—×“×©×•×ª, ××‘×—× ×™×, ×œ×•×— ××•×“×¢×•×ª ×•××™×“×¢ ×œ×ª×œ××™×“×™× ×•×œ×”×•×¨×™× â€“ ×‘××ª×¨ ×”×¨×©××™ ×©×œ ×—×˜×™×‘×ª ×”× ×¢×•×¨×™× ×™×¢×¨×ª ×”×¢××§." />
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="he_IL" />
  <meta property="og:site_name" content="×—×˜×™×‘×ª ×”× ×¢×•×¨×™× ×™×¢×¨×ª ×”×¢××§" />
  <meta property="og:url" content="https://yaarathaemek.online/" />

  <!-- âœ… ×ª××•× ×ª ×©×™×ª×•×£ ×××™×ª×™×ª 1200x630 -->
  <meta property="og:image" content="https://yaarathaemek.online/og-image.png" />
  <meta property="og:image:secure_url" content="https://yaarathaemek.online/og-image.png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="×—×˜×™×‘×ª ×”× ×¢×•×¨×™× ×™×¢×¨×ª ×”×¢××§ â€“ ××ª×¨ ×¨×©××™" />

  <!-- TWITTER -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="×—×˜×™×‘×ª ×”× ×¢×•×¨×™× ×™×¢×¨×ª ×”×¢××§ â€“ ×”××ª×¨ ×”×¨×©××™" />
  <meta name="twitter:description" content="×›×œ ×”××™×“×¢ ×¢×œ ×—×˜×™×‘×ª ×”× ×¢×•×¨×™× ×™×¢×¨×ª ×”×¢××§ ×‘××§×•× ××—×“." />
  <meta name="twitter:image" content="https://yaarathaemek.online/og-image.png" />

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "×—×˜×™×‘×ª ×”× ×¢×•×¨×™× ×™×¢×¨×ª ×”×¢××§",
    "url": "https://yaarathaemek.online/",
    "logo": "https://yaarathaemek.online/logo.png"
  }
  </script>

  <!-- LOCAL -->
  <link rel="icon" href="logo.png" />
  <link rel="stylesheet" href="style.css" />

 
  <style>

    /* ---------- POLL (×¡×§×¨ ×”×©×‘×•×¢) ---------- */
    #home-poll-mini{ padding:32px 0; }

    .home-poll-card{
      max-width:720px; margin:0 auto;
      border-radius:24px;
      padding:18px 18px 14px;
      background: rgba(15,23,42,0.96);
      border:1px solid rgba(148,163,184,0.5);
      box-shadow:0 18px 45px rgba(15,23,42,0.85);
      transition: background-color .25s ease, border-color .25s ease, box-shadow .25s ease, color .25s ease;
    }
    .home-poll-header{ display:flex; justify-content:space-between; align-items:center; gap:10px; flex-wrap:wrap; margin-bottom:10px; }
    .home-poll-badge{
      border-radius:999px; padding:4px 10px;
      font-size:.75rem;
      background:rgba(56,189,248,0.14);
      border:1px solid rgba(56,189,248,0.7);
      color:#bae6fd;
    }
    .home-poll-status-text{ font-size:.8rem; color:#9ca3af; }
    .home-poll-body{ margin-bottom:10px; }
    .home-poll-question{ font-size:1rem; font-weight:600; margin-bottom:8px; color:#e5f0ff; }

    .home-poll-options{ list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:6px; }
    .home-poll-option{
      border-radius:999px;
      padding:6px 10px;
      background:rgba(15,23,42,0.9);
      border:1px solid rgba(51,65,85,0.9);
      font-size:.85rem;
      color:#e5e7eb;
      display:flex; justify-content:space-between; align-items:center; gap:6px;
    }
    .home-poll-option-label{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .home-poll-option-votes{ font-size:.75rem; color:#cbd5f5; white-space:nowrap; }

    .home-poll-footer{ display:flex; justify-content:space-between; align-items:center; gap:10px; flex-wrap:wrap; font-size:.8rem; }
    .home-poll-votes{ color:#9ca3af; }
    .home-poll-link{
      font-size:.8rem; text-decoration:none;
      border-radius:999px; padding:6px 10px;
      border:1px solid rgba(56,189,248,0.7);
      background:rgba(15,23,42,0.9);
      color:#7dd3fc;
    }
    .home-poll-link:hover{ text-decoration:underline; }

    :root[data-theme="light"] .home-poll-card{ background:#fff; border-color:rgba(15,23,42,0.08); box-shadow:0 12px 35px rgba(15,23,42,0.08); }
    :root[data-theme="light"] .home-poll-badge{ background:rgba(37,99,235,0.1); border-color:rgba(37,99,235,0.55); color:#1d4ed8; }
    :root[data-theme="light"] .home-poll-status-text{ color:#4b5563; }
    :root[data-theme="light"] .home-poll-question{ color:#111827; }
    :root[data-theme="light"] .home-poll-option{ background:#f9fafb; border-color:#e5e7eb; color:#111827; }
    :root[data-theme="light"] .home-poll-option-votes{ color:#4b5563; }
    :root[data-theme="light"] .home-poll-votes{ color:#6b7280; }
    :root[data-theme="light"] .home-poll-link{ background:#eff6ff; border-color:#2563eb; color:#1d4ed8; }
    @media (max-width:640px){ .home-poll-card{ padding:16px 14px 12px; } }

    #home-news .home-board-list > *:not(:first-child){ display:none !important; }
    #home-news .home-board-list p{
      display:-webkit-box;
      -webkit-line-clamp:4;
      -webkit-box-orient:vertical;
      overflow:hidden;
    }

    .home-news-mini{ margin-top:8px; }
    .home-news-mini-item{ display:flex; align-items:center; gap:10px; }
    .home-news-mini-thumb-wrap{ flex:0 0 56px; height:56px; border-radius:12px; overflow:hidden; }
    .home-news-mini-thumb-wrap img{ width:100%; height:100%; object-fit:cover; display:block; }
    .home-news-mini-text{ flex:1; min-width:0; }
    .home-news-mini-title{ font-size:.9rem; font-weight:600; margin-bottom:2px; }
    .home-news-mini-body{ font-size:.8rem; color:#4b5563; max-height:2.6em; overflow:hidden; text-overflow:ellipsis; }
    .home-news-mini-empty{ font-size:.8rem; color:#6b7280; }
    .mini-link-inline{ display:inline-block; margin-top:4px; font-size:.78rem; }

    .hero-home-inner{
      position:relative; z-index:1;
      padding-top:64px; padding-bottom:40px;
      display:flex; flex-direction:column; gap:24px;
    }
    .hero-home-header{ max-width:720px; margin:0 auto 8px; text-align:center; }
    .hero-home-cards{ display:grid; grid-template-columns:repeat(3, minmax(0, 1fr)); gap:18px; margin-top:18px; }
    .hero-quick-card ul{ margin:10px 0 0; padding-inline-start:1.1rem; font-size:.9rem; }
    @media (max-width:900px){
      .hero-home-inner{ padding-top:40px; }
      .hero-home-cards{ grid-template-columns:1fr; }
    }

    body[data-page="home"] .hero-home-header h1,
    body[data-page="home"] #hero-main-title{
      color:#fff;
      text-shadow:
        0 2px 16px rgba(0,0,0,.55),
        0 0 26px rgba(56,189,248,.35);
    }
    body[data-page="home"] .hero-home-header p,
    body[data-page="home"] #hero-main-body{
      color: rgba(255,255,255,.92);
      text-shadow: 0 2px 14px rgba(145, 65, 65, 0.45);
    }

    .hero.hero-home .hero-overlay{
      opacity: .38;
    }

    .hero-home-header .hero-glow-line{
      display:block;
      width:min(680px, 92vw);
      height:4px;
      margin:16px auto 0;
      border-radius:999px;
      background: linear-gradient(
        90deg,
        transparent 0%,
        #60a5fa 20%,
        #38bdf8 50%,
        #60a5fa 80%,
        transparent 100%
      );
      background-size:200% 100%;
      box-shadow: 0 0 18px rgba(56,189,248,.35), 0 8px 28px rgba(37,99,235,.25);
      opacity:.95;
      animation: heroGlowMove 5s linear infinite;
    }
    @keyframes heroGlowMove{
      from{ background-position:0% 50%; }
      to{ background-position:200% 50%; }
    }
    @media (max-width:768px){
      .hero-home-header .hero-glow-line{ height:3px; }
    }

    .hero-actions a,
    .hero-actions .btn,
    .hero-actions .btn-outline{
      border-radius:999px;
      padding:10px 18px;
      font-weight:800;
      letter-spacing:.2px;
      background: rgba(255,255,255,0.75);
      color:#0f172a;
      border:1px solid rgba(255,255,255,0.6);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-shadow:0 8px 24px rgba(15,23,42,0.18);
      transition: all .25s ease;
    }
    .hero-actions a:hover{
      background: rgba(37,99,235,0.9);
      color:#fff;
      border-color: transparent;
      box-shadow:0 12px 35px rgba(37,99,235,0.45);
      transform: translateY(-1px);
    }
    html[data-theme="dark"] .hero-actions a,
    html[data-theme="dark"] .hero-actions .btn,
    html[data-theme="dark"] .hero-actions .btn-outline{
      background: rgba(255,255,255,0.18);
      color:#fff;
      border:1px solid rgba(255,255,255,0.35);
      box-shadow:0 10px 30px rgba(0,0,0,0.35);
    }

    .hero-home-cards .grade-card{
      border-radius:18px;
      padding:18px 18px 16px;
      border:1px solid rgba(255,255,255,0.40);
      background: rgba(255,255,255,0.92); /* ×¨×’×™×œ â€“ ×‘×¨×•×¨ */
      box-shadow:0 10px 26px rgba(15,23,42,0.12);
      transition: transform .2s ease, box-shadow .2s ease, background .2s ease, border-color .2s ease;
    }

    .hero-home-cards .grade-card:hover{
      background: rgba(255,255,255,0.55);
      backdrop-filter: blur(12px) saturate(135%);
      -webkit-backdrop-filter: blur(12px) saturate(135%);
      transform: translateY(-4px);
      box-shadow:0 18px 45px rgba(15,23,42,0.18);
      border-color: rgba(37,99,235,0.22);
    }

    .hero-home-cards .grade-card h3{
      margin:0 0 8px;
      font-size:1.05rem;
      font-weight:800;
      letter-spacing:.2px;
      color: rgba(15,23,42,0.92);
    }
    .hero-home-cards .grade-card p,
    .hero-home-cards .grade-card li{
      color: rgba(15,23,42,0.72);
      line-height:1.55;
    }

    .hero-home-cards .grade-card:nth-child(2){
      border-color: rgba(37,99,235,0.20);
      box-shadow:0 14px 34px rgba(37,99,235,0.10);
      position: relative;
    }
    .hero-home-cards .grade-card:nth-child(2)::before{
      content:"";
      position:absolute;
      inset:12px auto 12px 12px;
      width:4px;
      border-radius:999px;
      background: rgba(37,99,235,0.50);
    }

    /* DARK */
    html[data-theme="dark"] .hero-home-cards .grade-card{
      background: rgba(15,23,42,0.88);
      border-color: rgba(148,163,184,0.22);
      box-shadow:0 14px 40px rgba(0,0,0,0.45);
    }
    html[data-theme="dark"] .hero-home-cards .grade-card:hover{
      background: rgba(15,23,42,0.45);
      backdrop-filter: blur(12px) saturate(130%);
      -webkit-backdrop-filter: blur(12px) saturate(130%);
      border-color: rgba(56,189,248,0.28);
    }
    html[data-theme="dark"] .hero-home-cards .grade-card h3{ color: rgba(255,255,255,0.92); }
    html[data-theme="dark"] .hero-home-cards .grade-card p,
    html[data-theme="dark"] .hero-home-cards .grade-card li{ color: rgba(255,255,255,0.74); }
    html[data-theme="dark"] .hero-home-cards .grade-card:nth-child(2)::before{ background: rgba(56,189,248,0.55); }

    @media (max-width:900px){
      .hero-home-cards .grade-card{
        padding:16px 14px 14px;
        border-radius:16px;
      }
      .hero-home-cards .grade-card:hover{
        backdrop-filter: blur(10px) saturate(125%);
        -webkit-backdrop-filter: blur(10px) saturate(125%);
      }
      .hero-home-cards .grade-card:nth-child(2)::before{
        inset:12px auto 12px 10px;
      }
    }

    /* ---------- ALL NEWS BUTTON ---------- */
    .all-news-btn{
      display:inline-flex; align-items:center; gap:8px;
      padding:10px 18px; margin-top:12px;
      font-size:.9rem; font-weight:600;
      text-decoration:none;
      color:#2563eb; background:#eff6ff;
      border:1px solid #bfdbfe; border-radius:999px;
      transition: background .25s ease, color .25s ease, transform .2s ease, box-shadow .25s ease;
    }
    .all-news-btn::before{ content:"ğŸ“°"; font-size:.95rem; }
    .all-news-btn:hover{ background:#2563eb; color:#fff; transform:translateY(-1px); box-shadow:0 8px 20px rgba(37,99,235,0.35); }
    :root[data-theme="dark"] .all-news-btn{ background:rgba(37,99,235,0.15); color:#93c5fd; border-color:rgba(37,99,235,0.4); }
    :root[data-theme="dark"] .all-news-btn:hover{ background:#2563eb; color:#fff; }

    .nav.nav-centered{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; padding:10px 0; position:relative;
    }
    .nav-side{ display:flex; gap:10px; align-items:center; flex:1; }
    .nav-right-links{ justify-content:flex-start; }
    .nav-left-links{ justify-content:flex-end; }

    .logo-circle{
      width:74px; height:74px;
      border-radius:999px; overflow:hidden;
      border:2px solid rgba(59,130,246,0.35);
      background: rgba(255,255,255,0.9);
      box-shadow:0 10px 25px rgba(15,23,42,0.12);
      display:flex; align-items:center; justify-content:center;
    }
    .logo-img{ width:100%; height:100%; object-fit:cover; }
    html[data-theme="dark"] .logo-circle{
      background: rgba(15,23,42,0.55);
      border-color: rgba(56,189,248,0.35);
    }
    @media (max-width:900px){
      .logo-circle{ width:64px; height:64px; }
    }

    .nav-side a{
      padding:8px 14px;
      border-radius:999px;
      background: rgba(255,255,255,0.92);
      border:1px solid rgba(148,163,184,0.55);
      color:#0f172a;
      box-shadow:0 8px 20px rgba(15,23,42,0.08);
      font-size:.92rem;
      font-weight:600;
      letter-spacing:.2px;
      transition: transform .15s ease, box-shadow .15s ease, background .15s ease;
    }
    .nav-side a:hover{
      transform: translateY(-1px);
      box-shadow:0 12px 28px rgba(15,23,42,0.12);
      background:#eff6ff;
    }
    html[data-theme="dark"] .nav-side a{
      background: rgba(15,23,42,0.55);
      color:#e5e7eb;
      border-color: rgba(148,163,184,0.35);
    }
    .nav-side .personal-btn{
      background:#1d4ed8;
      color:#fff;
      border:none;
      font-weight:800;
    }
    .nav-side .btn-outline{ opacity:.85; }

    .theme-toggle-btn{
      all:unset;
      box-sizing:border-box;
      width:44px; height:44px;
      border-radius:50%;
      display:inline-flex; align-items:center; justify-content:center;
      cursor:pointer;
      border:1px solid rgba(148,163,184,0.6);
      background: rgba(255,255,255,0.92);
      box-shadow:0 8px 20px rgba(15,23,42,0.08);
      font-size:1.4rem;
      z-index:50;
    }
    html[data-theme="dark"] .theme-toggle-btn{ background: rgba(15,23,42,0.9); color:#f9fafb; }

    .nav-toggle{ display:none; }
    .nav-mobile{ display:none; }

    @media (max-width:900px){
      .nav-right-links, .nav-left-links{ display:none !important; }
      .nav.nav-centered{ justify-content:center; min-height:70px; }

      .nav-toggle{
        display:flex;
        position:absolute;
        left:12px;
        top:50%;
        transform: translateY(-50%);
        flex-direction:column;
        gap:4px;
        background:none;
        border:none;
        cursor:pointer;
        z-index:9999;
      }
      .nav-toggle span{ width:22px; height:2px; background:#0f172a; }
      html[data-theme="dark"] .nav-toggle span{ background:#e5e7eb; }

      #theme-toggle.theme-toggle-btn{
        position:absolute;
        right:12px;
        top:50%;
        transform: translateY(-50%);
        z-index:9999;
      }

      #nav-mobile.nav-mobile{
        display:none;
        position:absolute;
        top: calc(100% + 10px);
        left: 6px;
        width: min(220px, calc(100% - 24px));
        background: rgba(255,255,255,0.98);
        border:1px solid rgba(148,163,184,0.45);
        border-radius:18px;
        padding:8px;
        box-shadow:0 18px 45px rgba(15,23,42,0.18);
        z-index:9999;
      }
      html[data-theme="dark"] #nav-mobile.nav-mobile{
        background: rgba(15,23,42,0.95);
        border-color: rgba(148,163,184,0.35);
      }
      #nav-mobile.nav-mobile.open{ display:block; }

      #nav-mobile.nav-mobile a{
        display:block;
        padding:9px 10px;
        border-radius:12px;
        margin:6px 0;
        background: rgba(255,255,255,0.9);
        border:1px solid rgba(148,163,184,0.45);
        color:#0f172a;
        font-weight:600;
      }
      html[data-theme="dark"] #nav-mobile.nav-mobile a{
        background: rgba(2,6,23,0.55);
        border-color: rgba(148,163,184,0.25);
        color:#e5e7eb;
      }
    }

    .home-class-card{ width:100%; max-width:680px; margin:0 auto; text-align:center; padding:18px; }
    .home-class-row{ display:flex; gap:10px; flex-wrap:wrap; justify-content:center; align-items:center; }
    .home-class-row .select{ min-width:160px; }

    #urgent-wrap{ width:100%; }
    .urgent-bar{
      width:min(1200px, calc(100% - 28px));
      margin:18px auto;
      padding:10px 14px;
      border-radius:16px;
      border:1px solid rgba(148,163,184,.35);
      background: rgba(251,191,36,.14);
      overflow:hidden;
    }
    .urgent-inner{ display:flex; align-items:center; gap:12px; }
    .urgent-badge{
      flex-shrink:0;
      font-weight:900;
      padding:6px 12px;
      border-radius:999px;
      background: rgba(15,23,42,.15);
      white-space:nowrap;
    }
    .urgent-marquee{ overflow:hidden; flex:1; }
    .urgent-marquee-text{
      display:inline-block;
      direction:rtl;
      unicode-bidi: plaintext;
      font-weight:900;
      white-space:nowrap;
      will-change: transform;
      animation: urgentMarquee var(--urgent-speed, 14s) linear infinite;
      background: linear-gradient(90deg, #2563eb, #0f172a, #f59e0b);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
    }
    @keyframes urgentMarquee{
      from{ transform: translateX(0); }
      to{ transform: translateX(-100%); }
    }
    @media (max-width:768px){
      .urgent-marquee-text{ animation-duration:22s; padding-right:24px; }
    }


    /* ADMIN â€“ ×›×—×•×œ ×‘×¨×•×¨ */
    html[data-theme="dark"] .nav-side a.btn-outline,
    html[data-theme="dark"] .nav-side a[href*="admin"]{
      background: rgba(37, 99, 235, 0.85);
      color: #ffffff;
      border: 1px solid rgba(147,197,253,0.6);
      box-shadow:
        0 8px 26px rgba(37,99,235,0.45),
        0 0 0 1px rgba(255,255,255,0.08) inset;
    }

    html[data-theme="dark"] .nav-side a[href*="admin"]:hover{
      background: #2563eb;
      box-shadow:
        0 14px 40px rgba(37,99,235,0.65),
        0 0 24px rgba(56,189,248,0.45);
      transform: translateY(-1px);
    }

    html[data-theme="dark"] .nav-side .personal-btn{
      background: linear-gradient(135deg,#38bdf8,#2563eb) !important;
      color: #ffffff !important;
      border: none !important;
      box-shadow:
        0 14px 42px rgba(37,99,235,0.55),
        0 0 26px rgba(56,189,248,0.45);
      font-weight: 900;
      letter-spacing: .3px;
    }
    html[data-theme="dark"] .nav-side .personal-btn:hover{
      filter: brightness(1.08);
      transform: translateY(-2px);
      box-shadow:
        0 18px 55px rgba(37,99,235,0.75),
        0 0 36px rgba(56,189,248,0.65);
    }

    /* ADMIN â€“ Light Mode */
    html[data-theme="light"] .nav-side a.btn-outline,
    html[data-theme="light"] .nav-side a[href*="admin"]{
      background: linear-gradient(135deg,#e0ecff,#c7ddff);
      color: #1d4ed8;
      border: 1px solid #93c5fd;
      box-shadow:
        0 6px 18px rgba(37,99,235,0.18),
        0 0 0 1px rgba(255,255,255,0.8) inset;
      font-weight: 700;
    }
    html[data-theme="light"] .nav-side a[href*="admin"]:hover{
      background: #2563eb;
      color: #ffffff;
      box-shadow: 0 12px 34px rgba(37,99,235,0.35);
      transform: translateY(-1px);
    }

    html[data-theme="light"] .nav-side .personal-btn{
      background: linear-gradient(135deg,#2563eb,#38bdf8) !important;
      color: #ffffff !important;
      border: none !important;
      box-shadow:
        0 10px 30px rgba(37,99,235,0.35),
        0 0 0 1px rgba(255,255,255,0.35) inset;
      font-weight: 900;
      letter-spacing: .25px;
    }
    html[data-theme="light"] .nav-side .personal-btn:hover{
      filter: brightness(1.06);
      transform: translateY(-2px);
      box-shadow: 0 16px 44px rgba(37,99,235,0.45);
    }


/* 1) ×œ×”×¤×•×š ××ª ×”××¢×‘×¨ ×œ"×—×œ×§" */
.hero-home-cards .grade-card{
  will-change: transform, background-color, box-shadow, border-color;
  transition:
    transform .28s ease,
    background-color .28s ease,
    box-shadow .28s ease,
    border-color .28s ease;
}

.hero-home-cards .grade-card:hover{
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;

  background: rgba(255,255,255,0.78) !important; /* ×—×œ×§ ×•×œ× ×§×™×¦×•× ×™ */
  transform: translateY(-4px) !important;
  box-shadow: 0 18px 45px rgba(15,23,42,0.18) !important;
  border-color: rgba(37,99,235,0.22) !important;
}

/* 3) ×‘×“××¨×§ â€“ ××•×ª×• ×¨×¢×™×•×Ÿ */
html[data-theme="dark"] .hero-home-cards .grade-card:hover{
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;

  background: rgba(15,23,42,0.70) !important;
  transform: translateY(-4px) !important;
  box-shadow: 0 18px 45px rgba(0,0,0,0.45) !important;
  border-color: rgba(56,189,248,0.25) !important;
}

@media (hover: none){
  .hero-home-cards .grade-card:active,
  .hero-home-cards .grade-card:focus-within{
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    background: rgba(255,255,255,0.78) !important;
  }
  html[data-theme="dark"] .hero-home-cards .grade-card:active,
  html[data-theme="dark"] .hero-home-cards .grade-card:focus-within{
    background: rgba(15,23,42,0.70) !important;
  }
}

/* ×‘×¨×™×¨×ª ××—×“×œ: ×©×™×”×™×” ××¢×‘×¨ ×¢×“×™×Ÿ ×¨×§ ×‘×¦×‘×¢×™× (×œ× ×¤×™×œ×˜×¨×™×/blur) */
html, body, .header-main, .section-light, .section-dark-strong, .grade-card,
.nav-side a, .theme-toggle-btn, .btn, .btn-outline {
  transition: background-color .22s ease, color .22s ease, border-color .22s ease, box-shadow .22s ease;
}

/* âœ… ×‘×–××Ÿ ×”×—×œ×¤×ª ×“××¨×§/×œ×™×™×˜: ××‘×˜×œ ×”×›×œ ×›×“×™ ×©×œ× ×ª×¨××” "×‘×™× ×™×™×" ××›×•×¢×¨ */
html.theme-changing *,
html.theme-changing *::before,
html.theme-changing *::after {
  transition: none !important;
  animation: none !important;
}

/* ×× ×™×© ×œ×š blur / filters ××™×¤×©×”×• â€“ ×–×” ××” ×©×¢×•×©×” ××ª ×”-flash */
html.theme-changing .hero-overlay,
html.theme-changing .hero-home-cards .grade-card {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  filter: none !important;
}

/* ×—×©×•×‘: ××œ ×ª×¢×©×” ×›×¨×˜×™×¡×™× ×—×¦×™ ×©×§×•×¤×™× ×‘×–××Ÿ theme change */
html.theme-changing .hero-home-cards .grade-card{
  background-color: #ffffff !important;
}
html[data-theme="dark"].theme-changing .hero-home-cards .grade-card{
  background-color: #0f172a !important;
}
.teacher-portal-btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  padding:12px 14px;
  border-radius:14px;
  font-weight:900;
  font-size:14px;
  letter-spacing:.2px;
  text-decoration:none;

  color:#eafff4;
  background:linear-gradient(135deg, rgba(57,217,138,.95), rgba(34,197,94,.70));
  border:1px solid rgba(57,217,138,.35);

  box-shadow:
    0 10px 26px rgba(34,197,94,.22),
    inset 0 1px 0 rgba(255,255,255,.12);

  transition:transform .15s ease, box-shadow .15s ease, filter .15s ease;
}

.teacher-portal-btn:hover{
  transform:translateY(-1px);
  filter:brightness(1.05);
  box-shadow:
    0 14px 34px rgba(34,197,94,.28),
    inset 0 1px 0 rgba(255,255,255,.14);
}

.teacher-portal-btn:active{
  transform:translateY(0);
  filter:brightness(.98);
}

.teacher-portal-btn:focus-visible{
  outline:none;
  box-shadow:
    0 0 0 3px rgba(57,217,138,.25),
    0 14px 34px rgba(34,197,94,.28);
}
.nav-spacer{
  pointer-events: none;
  opacity: 0;
}
#hero-main-title {
  color: #460404;
  text-shadow:
    0 0 6px rgba(96,165,250,0.9),
    0 0 16px rgba(96,165,250,0.7),
    0 0 32px rgba(96,165,250,0.5);
}

#hero-main-body {
  color: #460404;
  text-shadow:
    3 0 8px rgba(82, 62, 62, 0.6);
}
#hero-main-title {
  letter-spacing: 0.01em;
}
.hero-overlay {
  position: absolute;
  inset: 0;
  background: linear-gradient(
    to bottom,
    rgba(146, 126, 126, 0.45),
    rgba(211, 186, 186, 0.6)
  );
  z-index: 1;
}
[data-theme="dark"] .hero-overlay {
  background: linear-gradient(
    to bottom,
    rgba(255, 0, 0, 0.65),
    rgba(0,0,0,0.75)
  );
}
[data-theme="dark"] #hero-main-body {
  color: #ffffff;
  text-shadow:
    0 2px 4px rgba(3, 2, 2, 0.9),
    0 0 14px rgba(15, 15, 24, 0.6),
    0 0 28px rgba(36, 20, 20, 0.4);
}

/* =========================
   HOME CLASS PICKER â€“ NEW LOOK
   (×œ× ××©× ×” IDs, ×œ× ×©×•×‘×¨ JS)
========================= */
.home-class-wrap{
  width:100%;
  max-width:900px;
  margin:0 auto;
}

.home-class-panel{
  border-radius:24px;
  padding:18px 18px 16px;
  border:1px solid rgba(148,163,184,0.55);
  background: rgba(255,255,255,0.92);
  box-shadow: 0 18px 45px rgba(15,23,42,0.10);
  position:relative;
  overflow:hidden;
}

.home-class-panel::before{
  content:"";
  position:absolute;
  inset:0;
  background:
    radial-gradient(900px 240px at 80% -20%, rgba(37,99,235,.18), transparent 60%),
    radial-gradient(700px 220px at 10% 120%, rgba(56,189,248,.14), transparent 55%);
  pointer-events:none;
}

.home-class-head{
  display:flex;
  align-items:center;
  gap:12px;
  margin-bottom:12px;
  position:relative;
  z-index:1;
}

.home-class-icon{
  width:46px;
  height:46px;
  border-radius:16px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:1.35rem;
  background: rgba(37,99,235,0.10);
  border:1px solid rgba(37,99,235,0.22);
}

.home-class-title{
  font-weight:900;
  letter-spacing:.2px;
}

.home-class-subtitle{
  font-size:.9rem;
  color: rgba(15,23,42,0.70);
}

.home-class-form{
  display:grid;
  grid-template-columns: 110px 1fr 110px 1fr auto;
  gap:10px;
  align-items:center;
  position:relative;
  z-index:1;
}

.home-class-label{
  font-size:.85rem;
  font-weight:800;
  color: rgba(15,23,42,0.78);
}

.home-class-select{
  border-radius:14px;
  padding:10px 12px;
  border:1px solid rgba(148,163,184,0.55);
  background: rgba(255,255,255,0.9);
  box-shadow: 0 10px 22px rgba(15,23,42,0.06);
}

.home-class-go{
  border-radius:16px;
  padding:10px 16px;
  font-weight:900;
  box-shadow: 0 14px 34px rgba(37,99,235,0.20);
}



/* responsive */
@media (max-width:900px){
  .home-class-form{
    grid-template-columns: 1fr 1fr;
  }
  .home-class-label{ display:none; }
  .home-class-go{ grid-column: 1 / -1; }
}

/* dark mode */
html[data-theme="dark"] .home-class-panel{
  background: rgba(15,23,42,0.88);
  border-color: rgba(148,163,184,0.22);
  box-shadow: 0 18px 55px rgba(0,0,0,0.45);
}
html[data-theme="dark"] .home-class-icon{
  background: rgba(56,189,248,0.10);
  border-color: rgba(56,189,248,0.22);
}
html[data-theme="dark"] .home-class-subtitle{
  color: rgba(255,255,255,0.72);
}
html[data-theme="dark"] .home-class-label{
  color: rgba(255,255,255,0.78);
}
html[data-theme="dark"] .home-class-select{
  background: rgba(2,6,23,0.55);
  border-color: rgba(148,163,184,0.25);
  box-shadow: 0 10px 22px rgba(0,0,0,0.28);
  color:#e5e7eb;
}
html[data-theme="dark"] .home-class-hints .pill{
  background: rgba(255,255,255,0.06);
  border-color: rgba(148,163,184,0.22);
  color: rgba(255,255,255,0.72);
}
.site-footer{
  border-top: 1px solid rgba(148,163,184,.35);
  background: rgba(255,255,255,.92);
  padding: 14px 0;
}

html[data-theme="dark"] .site-footer{
  background: rgba(2,6,23,.55);
  border-top-color: rgba(148,163,184,.18);
}

.footer-inner{
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 16px;

  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 14px;
}

.footer-copy{
  font-weight: 800;
  font-size: .92rem;
  opacity: .9;
  white-space: nowrap;
}

html[data-theme="dark"] .footer-copy{ color: #e5e7eb; opacity: .85; }

.footer-links{
  display: flex;
  gap: 18px;
  flex-wrap: wrap;
  justify-content: center;
  align-items: center;
}

.footer-links a{
  text-decoration: none;
  font-weight: 800;
  font-size: .92rem;
  color: #0f172a;
  opacity: .85;
}

.footer-links a:hover{ opacity: 1; text-decoration: underline; }

html[data-theme="dark"] .footer-links a{
  color: #e5e7eb;
  opacity: .8;
}

.footer-right{
  display: flex;
  align-items: center;
  gap: 14px;
}

.footer-social{
  display: flex;
  gap: 10px;
  align-items: center;
}

.soc{
  width: 32px;
  height: 32px;
  border-radius: 999px;
  display: inline-flex;
  align-items: center;
  justify-content: center;

  font-weight: 900;
  color: #fff;
  text-decoration: none;
  box-shadow: 0 10px 20px rgba(15,23,42,.12);
  transform: translateY(0);
  transition: transform .15s ease, box-shadow .15s ease;
}

.soc:hover{
  transform: translateY(-1px);
  box-shadow: 0 14px 30px rgba(15,23,42,.16);
}

/* ×¦×‘×¢×™× */
.soc.yt{ background:#ef4444; }
.soc.fb{ background:#2563eb; }
.soc.tt{ background:#06b6d4; }
.soc.ig{ background:#7c3aed; }

.footer-logo img{
  width: 90px;
  height: auto;
  display: block;
}

/* ×¨×¡×¤×•× ×¡×™×‘×™ ×œ××•×‘×™×™×œ */
@media (max-width: 860px){
  .footer-inner{
    flex-direction: column;
    align-items: center;
    text-align: center;
  }
  .footer-copy{ order: 3; }
  .footer-links{ order: 2; }
  .footer-right{ order: 1; }
}
.site-footer{
  border-top: 1px solid rgba(148,163,184,.35);
  background: rgba(255,255,255,.92);
  padding: 14px 0;
}

html[data-theme="dark"] .site-footer{
  background: rgba(2,6,23,.55);
  border-top-color: rgba(148,163,184,.18);
}

.footer-inner{
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 16px;

  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
}

.footer-right{
  display: flex;
  align-items: center;
  gap: 14px;
  flex: 1;
  justify-content: flex-start; /* ×‘-RTL ×–×” ×¦×“ ×™××™×Ÿ ×•×™×–×•××œ×™×ª */
}

.footer-logo img{
  width: 110px;
  height: auto;
  display: block;
}

.footer-social{
  display: flex;
  gap: 10px;
  align-items: center;
}

.soc-img{
  width: 34px;
  height: 34px;
  border-radius: 999px;
  overflow: hidden;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border: 1px solid rgba(148,163,184,.35);
  background: rgba(255,255,255,.9);
  box-shadow: 0 10px 20px rgba(15,23,42,.12);
  transition: transform .15s ease, box-shadow .15s ease;
}

.soc-img img{
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

.soc-img:hover{
  transform: translateY(-1px);
  box-shadow: 0 14px 30px rgba(15,23,42,.16);
}

html[data-theme="dark"] .soc-img{
  background: rgba(15,23,42,.7);
  border-color: rgba(148,163,184,.18);
}

.footer-links{
  display: flex;
  gap: 18px;
  flex-wrap: wrap;
  justify-content: center;
  align-items: center;
  flex: 2;
}

.footer-links a{
  text-decoration: none;
  font-weight: 800;
  font-size: .92rem;
  color: #0f172a;
  opacity: .85;
}

.footer-links a:hover{ opacity: 1; text-decoration: underline; }

html[data-theme="dark"] .footer-links a{
  color: #e5e7eb;
  opacity: .8;
}

.footer-left{
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 6px;
  flex: 1;
  text-align: left;
}

.footer-copy{
  font-weight: 800;
  font-size: .92rem;
  opacity: .9;
  white-space: nowrap;
}

html[data-theme="dark"] .footer-copy{ color: #e5e7eb; opacity: .85; }

.footer-devlink{
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: fit-content;
  padding: 6px 12px;
  border-radius: 999px;
  text-decoration: none;
  font-weight: 900;
  font-size: .9rem;
  color: #0f172a;
  background: rgba(255,255,255,.92);
  border: 1px solid rgba(148,163,184,.55);
  box-shadow: 0 10px 22px rgba(15,23,42,.10);
  transition: transform .15s ease, box-shadow .15s ease, background .15s ease;
}

.footer-devlink:hover{
  transform: translateY(-1px);
  background: #eff6ff;
  box-shadow: 0 14px 30px rgba(15,23,42,.14);
}

html[data-theme="dark"] .footer-devlink{
  color: #e5e7eb;
  background: rgba(15,23,42,.55);
  border-color: rgba(148,163,184,.22);
}

/* ××•×‘×™×™×œ */
@media (max-width: 860px){
  .footer-inner{
    flex-direction: column;
    align-items: center;
    text-align: center;
  }
  .footer-right{ justify-content: center; }
  .footer-left{ align-items: center; }
  .footer-copy{ white-space: normal; }
}
.site-footer{
  border-top: 1px solid rgba(148,163,184,.25);
  background: rgba(255,255,255,.92);
  padding: 18px 0;
}

html[data-theme="dark"] .site-footer{
  background: rgba(2,6,23,.55);
  border-top-color: rgba(148,163,184,.18);
}

.footer-inner{
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 18px;

  display: grid;
  grid-template-columns: 1fr auto 1fr; /* right | center | left */
  align-items: center;
  gap: 18px;
}

/* ===== RIGHT ===== */
.footer-right{
  display:flex;
  align-items:center;
  gap: 14px;
  justify-content:flex-start; /* RTL => ×¦×“ ×™××™×Ÿ ×•×™×–×•××œ×™×ª */
}

.footer-logo{
  height: 42px;
  width: auto;
  display:block;
  filter: drop-shadow(0 8px 18px rgba(15,23,42,.12));
}

.footer-social{display:flex;gap:10px;align-items:center}

.soc{
  width: 34px; height: 34px;
  border-radius: 999px;
  overflow:hidden;
  display:inline-flex;
  border:1px solid rgba(148,163,184,.35);
  background: rgba(255,255,255,.9);
  box-shadow: 0 10px 22px rgba(15,23,42,.10);
  transition: transform .15s ease, box-shadow .15s ease;
}
.soc img{width:100%;height:100%;object-fit:cover;display:block}
.soc:hover{transform:translateY(-1px);box-shadow:0 14px 30px rgba(15,23,42,.16)}

html[data-theme="dark"] .soc{
  background: rgba(15,23,42,.7);
  border-color: rgba(148,163,184,.18);
}

/* ===== CENTER ===== */
.footer-links{
  display:flex;
  gap: 18px;
  justify-content:center;
  flex-wrap:wrap;
}

.footer-links a{
  text-decoration:none;
  font-weight: 900;
  font-size: .92rem;
  color:#0f172a;
  opacity:.78;
  padding: 6px 10px;
  border-radius: 999px;
  transition: background .15s ease, opacity .15s ease;
}
.footer-links a:hover{
  opacity: 1;
  background: rgba(37,99,235,.08);
}

html[data-theme="dark"] .footer-links a{
  color:#e5e7eb;
  opacity:.8;
}
html[data-theme="dark"] .footer-links a:hover{
  background: rgba(56,189,248,.10);
}

/* ===== LEFT ===== */
.footer-left{
  display:flex;
  flex-direction:column;
  align-items:flex-end;
  gap: 6px;
}

.footer-copy{
  font-weight: 800;
  font-size: .92rem;
  opacity: .9;
  white-space: nowrap;
}

html[data-theme="dark"] .footer-copy{color:#e5e7eb;opacity:.85}

.footer-dev{
  text-decoration:none;
  font-weight: 900;
  font-size: .9rem;
  color:#0f172a;
  opacity:.85;
}
.footer-dev span{
  font-weight: 1000;
  text-decoration: underline;
  text-underline-offset: 4px;
}
.footer-dev:hover{opacity:1}

html[data-theme="dark"] .footer-dev{color:#e5e7eb}

/* ===== MOBILE ===== */
@media (max-width: 880px){
  .footer-inner{
    grid-template-columns: 1fr;
    text-align:center;
    justify-items:center;
  }
  .footer-right{justify-content:center}
  .footer-left{align-items:center}
  .footer-copy{white-space: normal}
}
/* ===== SITE FOOTER ===== */
.site-footer{
  border-top: 1px solid rgba(148,163,184,.25);
  background: #ffffff;
  padding: 22px 0;
}

html[data-theme="dark"] .site-footer{
  background: rgba(2,6,23,.65);
  border-top-color: rgba(148,163,184,.18);
}

/* inner layout */
.footer-inner{
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 18px;

  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
}

/* shared side */
.footer-side{
  display: flex;
  align-items: center;
  gap: 16px;
}

/* RIGHT â€“ logo + socials */
.footer-right{
  justify-content: flex-end;
}

.footer-brand{
  display: inline-flex;
  align-items: center;
}

.footer-logo{
  height: 46px;
  width: auto;
  display: block;
}

/* socials */
.footer-social{
  display: flex;
  gap: 10px;
}

.footer-social .soc{
  width: 67px;
  height: 67px;
  border-radius: 50%;
  display: inline-flex;
  align-items: center;
  justify-content: center;

  background: rgba(15,23,42,.05);
  border: 1px solid rgba(148,163,184,.35);
  transition: transform .15s ease, box-shadow .15s ease, background .15s ease;
}

.footer-social .soc img{
  width: 67px;
  height: 67px;
  object-fit: contain;
}

.footer-social .soc:hover{
  transform: translateY(-2px);
  box-shadow: 0 8px 18px rgba(15,23,42,.18);
  background: rgba(59,130,246,.12);
}

html[data-theme="dark"] .footer-social .soc{
  background: rgba(15,23,42,.6);
  border-color: rgba(148,163,184,.22);
}

/* LEFT â€“ copyright + dev */
.footer-left{
  flex-direction: column;
  align-items: flex-start;
  gap: 6px;
}

.footer-copy{
  font-size: .95rem;
  font-weight: 700;
  opacity: .9;
}

.footer-dev{
  font-size: .9rem;
  text-decoration: none;
  color: #0f172a;
  font-weight: 800;
  opacity: .85;
}

.footer-dev span{
  font-weight: 900;
}

.footer-dev:hover{
  opacity: 1;
  text-decoration: underline;
}

html[data-theme="dark"] .footer-copy,
html[data-theme="dark"] .footer-dev{
  color: #e5e7eb;
}

/* ===== MOBILE ===== */
@media (max-width: 720px){
  .footer-inner{
    flex-direction: column;
    text-align: center;
  }

  .footer-left{
    align-items: center;
  }

  .footer-right{
    justify-content: center;
  }
}
/* ===== FOOTER LAYOUT ===== */
.site-footer{
  border-top: 1px solid rgba(148,163,184,.25);
  background: #fff;
  padding: 18px 0;
}

html[data-theme="dark"] .site-footer{
  background: rgba(2,6,23,.65);
  border-top-color: rgba(148,163,184,.18);
}

.footer-inner{
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 18px;

  display: grid;
  grid-template-columns: 1fr auto 1fr; /* ×™××™×Ÿ | ×××¦×¢ | ×©×××œ */
  align-items: center;
}

/* ===== RIGHT: socials ===== */
.footer-right{
  display: flex;
  gap: 10px;
  justify-content: flex-start;
}

.footer-right .soc{
  width: 36px;
  height: 36px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;

  background: rgba(15,23,42,.05);
  border: 1px solid rgba(148,163,184,.35);
  transition: transform .15s ease, box-shadow .15s ease;
}

.footer-right .soc img{
  width: 18px;
  height: 18px;
}

.footer-right .soc:hover{
  transform: translateY(-2px);
  box-shadow: 0 8px 18px rgba(15,23,42,.18);
}

/* ===== CENTER: copyright ===== */
.footer-center{
  text-align: center;
  font-size: .95rem;
  font-weight: 700;
  opacity: .9;
}

/* ===== LEFT: developed by ===== */
.footer-left{
  display: flex;
  justify-content: flex-end;
}

.footer-dev{
  display: flex;
  align-items: center;
  gap: 10px;
  text-decoration: none;
  font-weight: 800;
  color: #0f172a;
}

.footer-dev img{
  width: 34px;
  height: 34px;
  border-radius: 50%;
  object-fit: cover;
}

.footer-dev:hover{
  text-decoration: underline;
}

html[data-theme="dark"] .footer-center,
html[data-theme="dark"] .footer-dev{
  color: #e5e7eb;
}

/* ===== MOBILE ===== */
@media (max-width: 720px){
  .footer-inner{
    grid-template-columns: 1fr;
    gap: 12px;
    text-align: center;
  }

  .footer-right,
  .footer-left{
    justify-content: center;
  }
}
.site-footer{
  background: #fff;
  border-top: 1px solid rgba(15,23,42,.08);
}

.footer-inner{
  max-width: 1200px;
  margin: 0 auto;
  padding: 12px 18px;

  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  align-items: center;
}

/* ×™××™×Ÿ â€“ ×¨×©×ª×•×ª */
.footer-right{
  display: flex;
  gap: 12px;
  justify-content: flex-end;
}

.footer-social .soc img{
  width: 34px;
  height: 34px;
  border-radius: 50%;
  border: 1px solid rgba(148,163,184,.35);
  padding: 4px;
  background: #fff;
  transition: transform .15s ease, box-shadow .15s ease;
}

.footer-social .soc img:hover{
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(15,23,42,.18);
}

/* ×××¦×¢ â€“ ×–×›×•×™×•×ª */
.footer-copy{
  text-align: center;
  font-weight: 700;
  color: #1e293b;
  font-size: .95rem;
}

/* ×©×××œ â€“ Developed by */
.footer-left{
  display: flex;
  justify-content: flex-start;
}

.footer-dev{
  font-weight: 700;
  text-decoration: none;
  color: #0f172a;
}

.footer-dev span{
  font-weight: 900;
}

/* ××•×‘×™×™×œ */
@media (max-width: 700px){
  .footer-inner{
    grid-template-columns: 1fr;
    gap: 10px;
    text-align: center;
  }

  .footer-right,
  .footer-left{
    justify-content: center;
  }
}
.site-footer{
  width: 100%;
  background: #fff;
  border-top: 1px solid rgba(15,23,42,.08);
}

.footer-inner{
  width: 100%;
  max-width: none;          /* âœ… ××‘×˜×œ ×”×’×‘×œ×” */
  margin: 0;                /* âœ… ×œ× ×××•×¨×›×– ×‘×ª×•×š ×§×•×¤×¡×” */
  padding: 18px 34px;       /* âœ… ××•×•×™×¨ */
  
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  align-items: center;
}
.footer-right{ justify-content: flex-end; }
.footer-left{ justify-content: flex-start; }
.footer-copy{ text-align: center; }
.footer-social{
  display:flex;
  gap: 14px;
  align-items:center;
}

.footer-social .soc img{
  width: 40px;
  height: 40px;
  border-radius: 999px;
}
.site-footer{
  width:100%;
  background:#ffffff;
  border-top:2px solid rgba(15,23,42,.12); /* ×¢×•×’×Ÿ */
}

.footer-inner{
  width:100%;
  max-width:none;
  margin:0;
  padding:20px 36px;          /* ×¤×—×•×ª ××•×•×™×¨ ××œ××¢×œ×” */
  
  display:grid;
  grid-template-columns:1fr 1fr 1fr;
  align-items:center;
}

/* ===== ××¨×›×– â€“ ×–×›×•×™×•×ª ===== */
.footer-copy{
  text-align:center;
  font-size:1.02rem;          /* â¬…ï¸ ×’×“×•×œ ×™×•×ª×¨ */
  font-weight:800;            /* â¬…ï¸ ××•×“×’×© */
  color:#0f172a;
}

/* ===== ×©×××œ â€“ Developed by ===== */
.footer-left{
  display:flex;
  align-items:center;
  gap:10px;
}

.footer-dev{
  font-size:.95rem;
  font-weight:800;
  color:#1e293b;
  text-decoration:underline;
}

.footer-dev span{
  font-weight:900;
}

/* ===== ×™××™×Ÿ â€“ ×¨×©×ª×•×ª ===== */
.footer-right{
  display:flex;
  justify-content:flex-end;
}

.footer-social{
  display:flex;
  gap:12px;
}

.footer-social img{
  width:67px;                 /* â¬…ï¸ ×§×¦×ª ×™×•×ª×¨ ×’×“×•×œ */
  height:67px;
  border-radius:70%;
  background:#fff;
  box-shadow:0 4px 12px rgba(15,23,42,.12); /* ×œ× ××¨×—×£ â€“ â€œ×™×•×©×‘â€ */
}
.footer-social{
  display:flex;
  gap:16px;               /* ×™×•×ª×¨ ×¨×•×•×— ×‘×™× ×™×”×Ÿ */
}

.footer-social img{
  width:67px;             /* â¬…ï¸ ×–×” ×”×¢×™×§×¨ */
  height:67px;
  border-radius:50%;
  background:#fff;
  padding:6px;            /* × ×•×ª×Ÿ â€œ×’×•×£â€ */
  box-shadow:0 6px 18px rgba(15,23,42,.18);
  transition:transform .2s ease, box-shadow .2s ease;
}

.footer-social img:hover{
  transform:translateY(-2px) scale(1.05);
  box-shadow:0 10px 26px rgba(15,23,42,.25);
}
.footer-social img{
  width:67px;
  height:67px;
}
.footer-social{
  display:flex;
  gap:22px;
  align-items:center;
}

.footer-social img{
  width:72px;          /* â¬…ï¸ ×’×“×•×œ. × ×§×•×“×”. */
  height:72px;
  border-radius:50%;

  background:#fff;
  padding:10px;

  box-shadow:
    0 8px 22px rgba(15,23,42,.22),
    inset 0 0 0 1px rgba(15,23,42,.08);

  transition:
    transform .18s ease,
    box-shadow .18s ease;
}

.footer-social img:hover{
  transform:translateY(-3px) scale(1.08);
  box-shadow:
    0 14px 36px rgba(15,23,42,.35);
}
/* âœ… Social buttons â€“ clean + not huge */
.site-footer .footer-right{
  display:flex !important;
  justify-content:flex-end !important;
  align-items:center !important;
  gap:14px !important;
}

.site-footer .footer-right .soc{
  width:52px !important;
  height:52px !important;
  border-radius:999px !important;
  overflow:hidden !important;

  display:inline-flex !important;
  align-items:center !important;
  justify-content:center !important;

  background:#fff !important;
  border:1px solid rgba(15,23,42,.12) !important;
  box-shadow:0 6px 16px rgba(15,23,42,.10) !important;

  transition:transform .18s ease, box-shadow .18s ease !important;
}

.site-footer .footer-right .soc:hover{
  transform:translateY(-2px) !important;
  box-shadow:0 10px 24px rgba(15,23,42,.16) !important;
}

/* ×”×ª××•× ×” ×‘×¤× ×™×: ×œ× ×œ×”×ª×¤×•×¦×¥, ×œ×©×‘×ª ×™×¤×” */
.site-footer .footer-right .soc img{
  width:70% !important;
  height:70% !important;
  object-fit:contain !important;
  display:block !important;
}

/* ×“××¨×§ */
html[data-theme="dark"] .site-footer .footer-right .soc{
  background: rgba(15,23,42,.55) !important;
  border-color: rgba(148,163,184,.22) !important;
  box-shadow:0 8px 20px rgba(0,0,0,.35) !important;
}
/* ===== HERO MINI CARDS UPGRADE ===== */
.hero-mini-card{
  display:flex;
  flex-direction:column;
  gap:10px;
}

.hero-mini-text{
  margin:0;
  font-size:.92rem;
  line-height:1.6;
}

/* label "×¢×“×›×•×Ÿ ××—×¨×•×Ÿ" */
.hero-latest-label{
  display:inline-flex;
  align-items:center;
  width:fit-content;
  padding:6px 12px;
  border-radius:999px;
  font-weight:1000;
  font-size:.92rem;
  color:#0b1220;
  background: rgba(15,23,42,.08);
  border:1px solid rgba(15,23,42,.10);
}

html[data-theme="dark"] .hero-latest-label{
  color:#ffffff;
  background: rgba(255,255,255,.08);
  border-color: rgba(148,163,184,.18);
}

.hero-latest-snippet{
  margin:0;
  font-size:.92rem;
  line-height:1.6;
  opacity:.92;
  display:-webkit-box;
  -webkit-line-clamp:2;      /* â¬…ï¸ ×¨×§ 2 ×©×•×¨×•×ª */
  -webkit-box-orient:vertical;
  overflow:hidden;
}

.hero-latest-btn,
.hero-council-btn{
  margin-top:auto;
  display:inline-flex;
  justify-content:center;
  align-items:center;
  text-decoration:none;
  border-radius:999px;
  padding:10px 14px;
  font-weight:1000;
  font-size:.92rem;
  border:1px solid rgba(37,99,235,.25);
  background: rgba(37,99,235,.08);
  color:#1d4ed8;
  transition: transform .15s ease, box-shadow .15s ease, background .15s ease;
}

.hero-latest-btn:hover,
.hero-council-btn:hover{
  transform: translateY(-1px);
  box-shadow: 0 14px 30px rgba(37,99,235,.18);
  background: rgba(37,99,235,.14);
}

html[data-theme="dark"] .hero-latest-btn,
html[data-theme="dark"] .hero-council-btn{
  color:#e5f0ff;
  border-color: rgba(56,189,248,.22);
  background: rgba(56,189,248,.10);
}

html[data-theme="dark"] .hero-latest-btn:hover,
html[data-theme="dark"] .hero-council-btn:hover{
  box-shadow: 0 18px 40px rgba(0,0,0,.35);
  background: rgba(56,189,248,.16);
}
.hero-latest-title{
  margin-top:2px;
  font-weight: 1000;
  font-size: 1rem;
  color: #0b1220;
}

html[data-theme="dark"] .hero-latest-title{
  color:#fff;
}

  </style>
</head>


<body data-page="index">

  <div id="update-banner" style="
    display:none;
    position:fixed;
    bottom:20px;
    right:20px;
    background:#2563eb;
    color:white;
    padding:12px 20px;
    border-radius:12px;
    font-size:0.9rem;
    cursor:pointer;
    box-shadow:0 4px 20px rgba(0,0,0,0.25);
    z-index:999999;
  ">
    ×™×© ×¢×“×›×•×Ÿ ×—×“×© ×œ××ª×¨ Â· ×œ×—×¥ ×œ×¨×¢× ×•×Ÿ
  </div>

  <script type="module" src="analytics.js"></script>

  <header class="header-main">
  <div class="container">
    <nav class="nav nav-centered" aria-label="× ×™×•×•×˜ ×¨××©×™">

      <div class="nav-side nav-right-links">
        <a href="index.html#home-news">×—×“×©×•×ª</a>
        <a href="index.html#grades">×”×©×›×‘×•×ª</a>
        <a href="polls.html">×¡×§×¨×™×</a>
        <a href="about.html">××•×“×•×ª</a>
      </div>

      <div class="nav-center">
        <a href="index.html" class="logo-circle" aria-label="×“×£ ×”×‘×™×ª">
          <img
            src="https://i.ibb.co/tp4K737Y/Cropped-circle-image-1.png"
            alt="×¡××œ ×™×¢×¨×ª ×”×¢××§"
            class="logo-img"
          />
        </a>
      </div>

<div class="nav-side nav-left-links">
  <a href="redirect-edu.html" class="personal-btn">×œ××¨×—×‘ ×”××™×©×™</a>
  <a href="admin.html" class="btn-outline">Admin</a>
  <a href="teachers.html" class="teacher-portal-btn">
   ×¤×•×¨×˜×œ ××•×¨×™×
</a>

</div>


      <button id="theme-toggle" class="theme-toggle-btn" type="button" aria-label="××¦×‘ ×›×”×”/×‘×”×™×¨">
        ğŸŒ™
      </button>

      <button
        class="nav-toggle"
        id="nav-toggle"
        type="button"
        aria-label="×¤×ª×— ×ª×¤×¨×™×˜"
        aria-expanded="false"
        aria-controls="nav-mobile"
      >
        <span></span><span></span><span></span>
      </button>

      <div class="nav-mobile" id="nav-mobile" aria-hidden="true">
        <a href="index.html#home-news">×—×“×©×•×ª</a>
        <a href="index.html#home-exams">××‘×—× ×™×</a>
<a href="index.html#home-class-picker">×”×©×›×‘×•×ª</a>
        <a href="polls.html">×¡×§×¨×™×</a>
        <a href="about.html">××•×“×•×ª</a>
        <a href="index.html#contact">×™×¦×™×¨×ª ×§×©×¨</a>
        <a href="redirect-edu.html" class="personal-btn">×œ××¨×—×‘ ×”××™×©×™</a>
          <a href="teachers.html" class="teacher-portal-btn">
   ×¤×•×¨×˜×œ ××•×¨×™×
        <a href="admin.html" class="btn-outline">Admin</a>
        
      </div>

    </nav>
  </div>
</header>



  <section class="hero hero-home">
    <div class="hero-slides">
      <div class="hero-slide"></div>
      <div class="hero-slide"></div>
      <div class="hero-slide"></div>
      <div class="hero-slide"></div>
      <div class="hero-slide"></div>
      <div class="hero-slide"></div>

    </div>

    <div class="hero-overlay"></div>

    <div class="container hero-home-inner">
      <div class="hero-home-header">
        <h1 id="hero-main-title">×™×—×“ ×¦×•××—×™× ×‘×™×¢×¨×ª ×”×¢××§</h1>
        <p id="hero-main-body">
          ×¡×‘×™×‘×” ×—×™× ×•×›×™×ª ×‘×˜×•×—×”, ×ª×•××›×ª ×•××•×‘×™×œ×”. ×›×œ ×ª×œ××™×“ ×•×ª×œ××™×“×” â€“ ×¢×•×œ× ×•××œ×•××•.
        </p>

        <div class="hero-actions">
        </div>
      </div>
<div class="hero-home-cards">

  <!-- 1) ×©×¢×•×ª ×¤×¢×™×œ×•×ª -->
<div class="grade-card glass-card hero-mini-card">
  <h3>××” ×§×•×¨×” ×”×™×•×?</h3>
  <p class="hero-mini-text" id="todayPlanText">
    ×˜×•×¢×Ÿâ€¦
  </p>
</div>


  <!-- 2) ×¢×“×›×•×Ÿ ×”× ×”×œ×” + ×¢×“×›×•×Ÿ ××—×¨×•×Ÿ + ×˜×™×–×¨ + ×›×¤×ª×•×¨ -->
  <div class="grade-card hero-mini-card hero-latest-card" id="hero-latest">
    <h3>×¢×“×›×•×Ÿ ××”× ×”×œ×ª ×‘×™×ª ×”×¡×¤×¨</h3>

<div class="hero-latest-title">×¢×“×›×•×Ÿ ××—×¨×•×Ÿ</div>

    <p class="hero-latest-snippet" id="hero-latest-snippet">
      ×˜×•×¢×Ÿ ××ª ×”×¢×“×›×•×Ÿ ×”××—×¨×•×Ÿ...
    </p>

    <a class="hero-latest-btn" id="hero-latest-btn" href="news.html">
      ×œ×›×ª×‘×” ×”××œ××” â†’
    </a>
  </div>

  <!-- 3) ××•×¢×¦×ª ×ª×œ××™×“×™× (××•×¤×¦×™×” ×‘') -->
  <div class="grade-card hero-mini-card hero-council-card">
    <h3>××•×¢×¦×ª ×ª×œ××™×“×™×</h3>
    <p class="hero-mini-text">
      ×™×•×–××•×ª, ×¤×¢×™×œ×•×™×•×ª ×•×”×¦×¢×•×ª ×©××•×‘×œ×•×ª ×¢×œ ×™×“×™ ×ª×œ××™×“×™ ×‘×™×ª ×”×¡×¤×¨,
      ×‘×©×™×ª×•×£ ×¢× ×”×”× ×”×œ×” ×•×”×¦×•×•×ª ×”×—×™× ×•×›×™.
    </p>
    <a class="hero-council-btn" href="council.html">×œ×¤×¢×™×œ×•×ª ××•×¢×¦×ª ×ª×œ××™×“×™× â†’</a>
  </div>

</div>

  </section>

  <section id="about" class="section-light reveal-on-scroll">
    <div class="container">
      <div class="section-header">
        <h2 id="about-title" class="section-title">××•×“×•×ª ×‘×™×ª ×”×¡×¤×¨</h2>
        <p id="about-body" class="section-subtitle">
          ×™×¢×¨×ª ×”×¢××§ ×”×™× ×—×˜×™×‘×ª-×‘×™× ×™×™× ×××œ×›×ª×™×ª ×‘××’×“×œ ×”×¢××§, ×”××•×‘×™×œ×” ×—×™× ×•×š ×¢×¨×›×™, ×™×•×–××” ×•×—×“×©× ×•×ª...
        </p>
        <div class="about-btn-wrap">
          <a href="about.html" class="about-btn">××•×“×•×ª ×‘×™×ª ×”×¡×¤×¨ Â»</a>
        </div>
      </div>

      <div class="home-grid">
        <div class="grade-card">
          <h3>×¢×¨×›×™× ×—×™× ×•×›×™×™×</h3>
          <p style="font-size:0.9rem; margin-top:4px;">
            ×›×‘×•×“, ××—×¨×™×•×ª, ×”×§×©×‘×”, ×©×™×™×›×•×ª ×•×¨××™×™×ª ×”×ª×œ××™×“ ×‘××¨×›×–.
          </p>
        </div>
        <div class="grade-card">
          <h3>×—×™×™ ×‘×™×ª ×¡×¤×¨</h3>
          <p style="font-size:0.9rem; margin-top:4px;">
            ×˜×™×•×œ×™×, ×¤×¨×•×™×§×˜×™× ×—×‘×¨×ª×™×™×, ×™×•×–××•×ª ×©×œ ××•×¢×¦×ª ×ª×œ××™×“×™× ×•×¢×•×“.
          </p>
        </div>
      </div>
    </div>
  </section>
  <div id="urgent-wrap" class="urgent-wrap" style="display:none;"></div>
<!-- Firebase (Compat) -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>



<script src="live-updates-widget.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", () => initLiveUpdatesWidget());
</script>

<script src="live-updates-widget.js"></script>
<script>
  initLiveUpdatesWidget();
</script>


   <section id="home-class-picker" class="section-light reveal-on-scroll">
  <div class="container">

    <div class="home-class-wrap">
      <div class="home-class-panel">
        <div class="home-class-head">
          <div class="home-class-icon" aria-hidden="true">ğŸ«</div>
          <div class="home-class-titles">
            <h3 class="home-class-title" style="margin:0;">×‘×—×™×¨×ª ×›×™×ª×”</h3>
            <p class="home-class-subtitle" style="margin:6px 0 0;">
              ×‘×—×¨ ×©×›×‘×” ×•××– ×›×™×ª×” â€” ×•× ×¢×‘×™×¨ ××•×ª×š ×œ×“×£ ×”×›×™×ª×”.
            </p>
          </div>
        </div>

        <div class="home-class-form">
          <label class="home-class-label" for="home-grade">×©×›×‘×”</label>
          <select id="home-grade" class="select home-class-select">
            <option value="">×‘×—×¨ ×©×›×‘×”</option>
            <option value="z">×–×³</option>
            <option value="h">×—×³</option>
            <option value="t">×˜×³</option>
          </select>

          <label class="home-class-label" for="home-class">×›×™×ª×”</label>
          <select id="home-class" class="select home-class-select" disabled>
            <option value="">×‘×—×¨ ×›×™×ª×”</option>
          </select>

          <button id="home-open-class" class="btn home-class-go" type="button" disabled>
            ×¤×ª×— ×“×£ ×›×™×ª×”
          </button>
        </div>

 
      </div>
    </div>

  </div>
</section>
  <section id="home-news" class="section-light reveal-on-scroll">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title" id="home-news-title">×—×“×©×•×ª ××—×¨×•× ×•×ª</h2>
        <p class="section-subtitle" id="home-news-subtitle">
          ×”×›×ª×‘×” ×”××—×¨×•× ×” ×©×¤×•×¨×¡××” ×‘×œ×•×— ×”××•×“×¢×•×ª â€“ ×•×‘×›×¤×ª×•×¨ ×œ××˜×” ×ª×•×›×œ×• ×œ×¢×‘×•×¨ ×œ×›×œ ×”×›×ª×‘×•×ª.
        </p>
      </div>

      <div class="home-grid">
        <div class="grade-card">
          <h3>×”×¢×“×›×•×Ÿ ×”××—×¨×•×Ÿ ××‘×™×ª ×”×¡×¤×¨</h3>
          <div id="home-board" class="home-board-list">
            <p class="empty-msg">××™×Ÿ ×¢×“×™×™×Ÿ ×—×“×©×•×ª ×‘××ª×¨.</p>
          </div>
          <a href="news.html" class="all-news-btn">×œ×¦×¤×™×™×” ×‘×›×œ ×”×—×“×©×•×ª ×•×”××•×“×¢×•×ª Â»</a>
        </div>
      </div>
    </div>
  </section>






</div>

</section>


<script src="home-class-picker.js" defer></script>




<section class="section-light reveal-on-scroll" id="grades-intro" style="padding-top:0; margin-top:-10px;">
  <div class="container">
    <div class="section-header">
      <h3 class="section-title" style="font-size:1.4rem;">ğŸ® ××©×—×§×™× ×‘××ª×¨</h3>
      <p class="section-subtitle">×—××™×©×” ××©×—×§×™× ×§×¦×¨×™× ×•××’× ×™×‘×™× ×œ×”×¢×‘×™×¨ ××ª ×”×–××Ÿ</p>
    </div>

    <!-- ===== MOBILE PICKER (chips) ===== -->
    <div class="game-picker" aria-label="×‘×—×¨ ××©×—×§">
      <button class="gchip" type="button" data-game="reaction">âš¡ ×ª×’×•×‘×”</button>
            <button class="gchip" type="button" data-game="snake">ğŸ¦– Dino</button>
                  <button class="gchip" type="button" data-game="dodge">ğŸ›¡ï¸ Dodge</button>
      <button class="gchip" type="button" data-game="quiz">ğŸ§  ××ª××˜×™×§×”</button>
      <button class="gchip" type="button" data-game="memory">ğŸ§© Memory</button>
    </div>

    <!-- ===== DESKTOP GRID (cards) ===== -->
    <div class="home-grid game-grid" style="margin-top:18px;">
      <div class="grade-card game-card" data-game="reaction">
        <h3>âš¡ ××‘×—×Ÿ ×ª×’×•×‘×”</h3>
        <p style="font-size:0.9rem;">×œ×—×¥ ×‘×¨×’×¢ ×©×–×” × ×”×™×” ×™×¨×•×§.</p>
        <button class="btn game-open-btn" type="button">×©×—×§ ×¢×›×©×™×•</button>
      </div>

      <div class="grade-card game-card" data-game="quiz">
        <h3>ğŸ§  ××ª××˜×™×§×” (×××’×¨ ×¢× ×§)</h3>
        <p style="font-size:0.9rem;">×©××œ×•×ª ×‘×œ×™ ×—×–×¨×•×ª â€” ×¢×œ ×××ª.</p>
        <button class="btn game-open-btn" type="button">×©×—×§ ×¢×›×©×™×•</button>
      </div>

      <div class="grade-card game-card" data-game="memory">
        <h3>ğŸ§© Memory</h3>
        <p style="font-size:0.9rem;">×§×•××‘×• + ×˜×™×™××¨ + ×©×™××™×.</p>
        <button class="btn game-open-btn" type="button">×©×—×§ ×¢×›×©×™×•</button>
      </div>

      <div class="grade-card game-card" data-game="dodge">
        <h3>ğŸ›¡ï¸ Dodge Arena</h3>
        <p style="font-size:0.9rem;">×‘××•×‘×™×™×œ ×™×© ×’â€™×•×™×¡×˜×™×§.</p>
        <button class="btn game-open-btn" type="button">×©×—×§ ×¢×›×©×™×•</button>
      </div>

      <div class="grade-card game-card" data-game="snake">
        <h3>ğŸ¦– Dino</h3>
        <p style="font-size:0.9rem;">×‘××•×‘×™×™×œ ×™×© D-Pad.</p>
        <button class="btn game-open-btn" type="button">×©×—×§ ×¢×›×©×™×•</button>
      </div>
    </div>

    <!-- GAME PANEL -->
    <div id="gameHubPanel" class="gamehub-panel" style="display:none; margin-top:16px;">
      <div class="gamehub-head">
        <div>
          <div class="gamehub-title" id="gameHubTitle">××©×—×§</div>
          <div class="gamehub-sub" id="gameHubSub">â€”</div>
        </div>

        <div class="gamehub-actions">
          <button class="btn-outline" id="gameFullscreenBtn" type="button" style="display:none;">××¡×š ××œ× â›¶</button>
          <button class="btn-outline" id="gameResetBtn" type="button">××™×¤×•×¡</button>
          <button class="btn" id="gameCloseBtn" type="button">×¡×’×•×¨ âœ•</button>
        </div>
      </div>

      <div id="gameHubBody" class="gamehub-body"></div>
    </div>
  </div>

  <style>
    /* ===== Picker UX ===== */
    .game-picker{
      display:none;
      gap:10px;
      overflow:auto;
      padding:4px 2px 10px;
      scroll-snap-type:x mandatory;
      -webkit-overflow-scrolling:touch;
    }
    .gchip{
      scroll-snap-align:start;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.35);
      background: rgba(255,255,255,.85);
      padding:10px 12px;
      font-weight:1000;
      cursor:pointer;
      white-space:nowrap;
      transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
    }
    .gchip:hover{ transform: translateY(-1px); box-shadow:0 12px 26px rgba(15,23,42,0.10); background:#eff6ff; }
    .gchip.active{ background: rgba(37,99,235,.10); border-color: rgba(37,99,235,.35); }
    html[data-theme="dark"] .gchip{
      background: rgba(2,6,23,.55);
      border-color: rgba(148,163,184,.22);
      color:#e5e7eb;
    }
    html[data-theme="dark"] .gchip:hover{ background: rgba(56,189,248,.12); box-shadow:0 18px 40px rgba(0,0,0,.35); }
    html[data-theme="dark"] .gchip.active{ background: rgba(56,189,248,.14); border-color: rgba(56,189,248,.30); }

    /* ===== Game grid/cards ===== */
    .game-card{ display:flex; flex-direction:column; gap:10px; }
    .game-open-btn{ margin-top:auto; border-radius:999px; font-weight:1000; padding:10px 14px; }

    /* ===== Panel ===== */
    .gamehub-panel{
      border-radius:24px;
      border:1px solid rgba(148,163,184,0.45);
      background: rgba(255,255,255,0.92);
      box-shadow:0 18px 45px rgba(15,23,42,0.10);
      overflow:hidden;
    }
    html[data-theme="dark"] .gamehub-panel{
      background: rgba(15,23,42,0.88);
      border-color: rgba(148,163,184,0.22);
      box-shadow:0 18px 55px rgba(0,0,0,0.45);
    }

    .gamehub-head{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:14px 14px;
      border-bottom:1px solid rgba(148,163,184,0.22);
    }
    .gamehub-title{ font-weight:1100; font-size:1.05rem; letter-spacing:.2px; color:#0f172a; }
    .gamehub-sub{ font-size:.9rem; opacity:.85; color:#334155; margin-top:4px; }
    html[data-theme="dark"] .gamehub-title{ color:#fff; }
    html[data-theme="dark"] .gamehub-sub{ color:rgba(255,255,255,0.72); }

    .gamehub-actions{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    .gamehub-body{ padding:16px; }

    /* ===== Shared cards ===== */
    .gh-card{
      max-width:860px; margin:0 auto;
      border-radius:18px;
      border:1px solid rgba(148,163,184,.35);
      background: rgba(15,23,42,.04);
      padding:14px;
    }
    html[data-theme="dark"] .gh-card{
      background: rgba(2,6,23,.35);
      border-color: rgba(148,163,184,.22);
    }
    .gh-row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between; }
    .gh-pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:7px 12px; border-radius:999px;
      font-weight:1000; font-size:.9rem;
      border:1px solid rgba(148,163,184,.35);
      background: rgba(255,255,255,.75);
    }
    html[data-theme="dark"] .gh-pill{ background: rgba(15,23,42,.65); border-color: rgba(148,163,184,.20); color:#e5e7eb; }
    .gh-help{ opacity:.85; font-weight:900; line-height:1.55; }
    html[data-theme="dark"] .gh-help{ color:rgba(255,255,255,.78); }

    /* ===== Reaction ===== */
    .rx-wrap{ display:flex; flex-direction:column; gap:12px; align-items:center; text-align:center; padding:8px 0; }
    .rx-btn{
      width:min(520px, 100%);
      height:120px;
      border-radius:18px;
      border:1px solid rgba(148,163,184,.35);
      font-weight:1100;
      font-size:1.05rem;
      cursor:pointer;
      user-select:none;
    }

    /* ===== Quiz ===== */
    .q-wrap{ max-width:780px; margin:0 auto; display:flex; flex-direction:column; gap:12px; }
    .q-q{ font-weight:1100; font-size:1.05rem; }
    .q-opts{ display:flex; flex-direction:column; gap:8px; }
    .q-opts button{
      text-align:right;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(148,163,184,.35);
      background: rgba(255,255,255,0.92);
      cursor:pointer;
      font-weight:1000;
      transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
    }
    .q-opts button:hover{ transform: translateY(-1px); box-shadow:0 12px 26px rgba(15,23,42,0.10); background:#eff6ff; }
    html[data-theme="dark"] .q-opts button{
      background: rgba(2,6,23,0.45);
      border-color: rgba(148,163,184,.22);
      color:#e5e7eb;
    }
    html[data-theme="dark"] .q-opts button:hover{ background: rgba(56,189,248,0.10); box-shadow:0 18px 40px rgba(0,0,0,.35); }
    .q-meta{ display:flex; justify-content:space-between; gap:10px; opacity:.88; font-weight:1100; flex-wrap:wrap; }
    .q-result{
      border-radius:16px; padding:12px;
      border:1px solid rgba(148,163,184,.25);
      background: rgba(37,99,235,.06);
      font-weight:1100;
    }
    html[data-theme="dark"] .q-result{
      background: rgba(56,189,248,.10);
      border-color: rgba(148,163,184,.18);
      color:#e5f0ff;
    }
    .q-mini{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;
      margin-top:10px;
    }
    .q-mini .btn-outline{
      border-radius:999px;
      padding:9px 12px;
      font-weight:1000;
    }

    /* ===== Memory ===== */
    .mem-wrap{ max-width:860px; margin:0 auto; display:flex; flex-direction:column; gap:12px; }
    .mem-grid{ display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap:10px; }
    @media (max-width:520px){ .mem-grid{ grid-template-columns: repeat(4, minmax(0,1fr)); gap:8px; } }
    .mem-card{
      aspect-ratio: 1/1;
      border-radius:16px;
      border:1px solid rgba(148,163,184,.35);
      background: rgba(255,255,255,.90);
      cursor:pointer;
      display:flex; align-items:center; justify-content:center;
      font-weight:1100;
      font-size:1.25rem;
      user-select:none;
      transition: transform .12s ease, box-shadow .12s ease;
    }
    .mem-card:hover{ transform: translateY(-1px); box-shadow:0 12px 26px rgba(15,23,42,.10); }
    html[data-theme="dark"] .mem-card{
      background: rgba(2,6,23,.50);
      border-color: rgba(148,163,184,.22);
      color:#e5e7eb;
    }
    .mem-card.revealed{ background: rgba(34,197,94,.16); }
    html[data-theme="dark"] .mem-card.revealed{ background: rgba(34,197,94,.18); }
    .mem-card.matched{
      background: rgba(37,99,235,.12);
      border-color: rgba(37,99,235,.35);
      cursor:default;
    }
    html[data-theme="dark"] .mem-card.matched{
      background: rgba(56,189,248,.14);
      border-color: rgba(56,189,248,.30);
    }

    /* ===== Canvas games ===== */
    .canvas-wrap{ max-width:920px; margin:0 auto; display:flex; flex-direction:column; gap:10px; }
    .canvas-box{
      border-radius:18px;
      border:1px solid rgba(148,163,184,.35);
      background: rgba(255,255,255,.86);
      padding:10px;
    }
    html[data-theme="dark"] .canvas-box{
      background: rgba(2,6,23,.45);
      border-color: rgba(148,163,184,.22);
    }
    canvas.game-canvas{
      width:100%;
      height:auto;
      border-radius:14px;
      display:block;
      background: rgba(15,23,42,.06);
      border:1px solid rgba(148,163,184,.25);
      touch-action:none;
    }
    html[data-theme="dark"] canvas.game-canvas{
      background: rgba(2,6,23,.35);
      border-color: rgba(148,163,184,.18);
    }

    /* ===== Mobile controls ===== */
    .mcontrols{ display:none; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap; margin-top:10px; }
    .pad{
      display:grid;
      grid-template-columns: 52px 52px 52px;
      grid-template-rows: 52px 52px 52px;
      gap:8px;
      user-select:none;
      touch-action:none;
    }
    .pad button{
      border-radius:14px;
      border:1px solid rgba(148,163,184,.35);
      background: rgba(255,255,255,.85);
      font-weight:1100;
      cursor:pointer;
    }
    html[data-theme="dark"] .pad button{
      background: rgba(2,6,23,.55);
      border-color: rgba(148,163,184,.22);
      color:#e5e7eb;
    }

    .joy{
      width:160px; height:160px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.35);
      background: rgba(255,255,255,.65);
      position:relative;
      overflow:hidden;
      touch-action:none;
    }
    html[data-theme="dark"] .joy{
      background: rgba(2,6,23,.45);
      border-color: rgba(148,163,184,.22);
    }
    .joy .knob{
      width:70px; height:70px;
      border-radius:999px;
      position:absolute;
      left:50%; top:50%;
      transform: translate(-50%,-50%);
      border:1px solid rgba(148,163,184,.35);
      background: rgba(37,99,235,.14);
    }
    html[data-theme="dark"] .joy .knob{ background: rgba(56,189,248,.16); border-color: rgba(148,163,184,.22); }

    .kbd{
      font-weight:1100;
      padding:4px 8px;
      border-radius:10px;
      border:1px solid rgba(148,163,184,.35);
      background: rgba(255,255,255,.75);
      display:inline-flex; align-items:center; gap:6px;
    }
    html[data-theme="dark"] .kbd{ background: rgba(15,23,42,.65); border-color: rgba(148,163,184,.20); color:#e5e7eb; }

    /* ===== Responsive behavior ===== */
    @media (max-width:780px){
      .game-picker{ display:flex; }
      .game-grid{ display:none !important; }
      .gamehub-body{ padding:12px; }
      .rx-btn{ height:106px; }
      .gamehub-head{ flex-direction:column; align-items:flex-start; }
      .gamehub-actions{ width:100%; justify-content:flex-end; }
      .mcontrols{ display:flex; }
    }
  </style>

  <script>
  (function(){
    const panel = document.getElementById("gameHubPanel");
    const titleEl = document.getElementById("gameHubTitle");
    const subEl   = document.getElementById("gameHubSub");
    const bodyEl  = document.getElementById("gameHubBody");
    const closeBtn= document.getElementById("gameCloseBtn");
    const resetBtn= document.getElementById("gameResetBtn");
    const fsBtn   = document.getElementById("gameFullscreenBtn");

    let currentGame = null;
    let cleanup = null;

    const isMobile = () => matchMedia("(max-width: 780px)").matches;
    const themeIsDark = () => document.documentElement.dataset.theme === "dark";

    function openPanel(){
      panel.style.display = "block";
      if (isMobile()) panel.scrollIntoView({ behavior:"smooth", block:"start" });
    }
    function closePanel(){
      if (cleanup) { try{ cleanup(); }catch(e){} cleanup=null; }
      currentGame = null;
      bodyEl.innerHTML = "";
      panel.style.display = "none";
      fsBtn.style.display = "none";
      fsBtn.onclick = null;
    }

    closeBtn.addEventListener("click", closePanel);
    resetBtn.addEventListener("click", () => { if (currentGame) loadGame(currentGame); });

    // chips
    document.querySelectorAll(".gchip").forEach(ch=>{
      ch.addEventListener("click", ()=>{
        document.querySelectorAll(".gchip").forEach(x=>x.classList.remove("active"));
        ch.classList.add("active");
        loadGame(ch.dataset.game);
      });
    });

    // cards
    document.querySelectorAll(".game-card .game-open-btn").forEach(btn=>{
      btn.addEventListener("click", (e)=>{
        const card = e.target.closest(".game-card");
        const g = card?.dataset?.game;
        if (!g) return;
        loadGame(g);
      });
    });

    function loadGame(gameKey){
      if (cleanup) { try{ cleanup(); }catch(e){} cleanup=null; }
      currentGame = gameKey;
      bodyEl.innerHTML = "";
      fsBtn.style.display = "none";
      fsBtn.onclick = null;

      if (gameKey === "reaction"){
        titleEl.textContent = "âš¡ ××‘×—×Ÿ ×ª×’×•×‘×”";
        subEl.textContent   = "×—×›×” ×©×–×” ×™×”×¤×•×š ×œ×™×¨×•×§ â€” ×•××– ×ª×œ×—×¥ ××”×¨.";
        cleanup = renderReactionGame(bodyEl);
        openPanel(); return;
      }
      if (gameKey === "quiz"){
        titleEl.textContent = "ğŸ§  ××ª××˜×™×§×” â€” ×××’×¨ ×©××œ×•×ª (8 ×‘×›×œ ×¡×©×Ÿ)";
        subEl.textContent   = "×§×¦×¨, ××”×™×¨, ×•××ª×—×œ×£ ×›×œ ×¤×¢×.";
        cleanup = renderMathQuiz(bodyEl);
        openPanel(); return;
      }
      if (gameKey === "memory"){
        titleEl.textContent = "ğŸ§© Memory";
        subEl.textContent   = "×§×•××‘×• + ×˜×™×™××¨ + ×©×™××™×.";
        cleanup = renderMemoryGame(bodyEl);
        openPanel(); return;
      }
      if (gameKey === "dodge"){
        titleEl.textContent = "ğŸ›¡ï¸ Dodge Arena";
        subEl.textContent   = "××—×©×‘: WASD/×—×¦×™× Â· ××•×‘×™×™×œ: ×’â€™×•×™×¡×˜×™×§.";
        cleanup = renderDodgeGame(bodyEl);
        openPanel(); return;
      }
      if (gameKey === "snake"){
        titleEl.textContent = "ğŸ¦– Dino";
        subEl.textContent   = "××—×©×‘: ×—×¦×™×/WASD Â· ××•×‘×™×™×œ: D-Pad.";
        cleanup = renderSnakeGame(bodyEl);
        openPanel(); return;
      }

      titleEl.textContent = "××©×—×§";
      subEl.textContent = "×œ× × ××¦×.";
      bodyEl.innerHTML = "<div class='gh-card'>××©×”×• ×œ× ×”×¡×ª×“×¨.</div>";
      openPanel();
    }

    /* ======================
       Game 1: Reaction
    ====================== */
    function renderReactionGame(root){
      const wrap = document.createElement("div");
      wrap.className = "rx-wrap";
      wrap.innerHTML = `
        <div class="gh-card">
          <div class="gh-row">
            <span class="gh-pill">××˜×¨×”: ×–××Ÿ ×”×›×™ × ××•×š</span>
            <span class="gh-pill">× ×¤×¡×œ ×× ×œ×•×—×¦×™× ××•×§×“×</span>
          </div>
          <div class="gh-help" style="margin-top:10px;">×œ×—×¥ ×¨×§ ×›×©×”×›×¤×ª×•×¨ ×™×¨×•×§.</div>
        </div>

        <button class="rx-btn" id="rxBtn">×œ×—×¥ ×›×“×™ ×œ×”×ª×—×™×œ</button>
        <div id="rxResult" style="font-weight:1100; opacity:.9;"></div>
      `;
      root.appendChild(wrap);

      const btn = wrap.querySelector("#rxBtn");
      const res = wrap.querySelector("#rxResult");

      let state = "idle";
      let timer = null;
      let startTime = 0;

      function setBtn(text, bg, color){
        btn.textContent = text;
        btn.style.background = bg;
        btn.style.color = color;
      }
      function reset(){
        state = "idle";
        res.textContent = "";
        setBtn("×œ×—×¥ ×›×“×™ ×œ×”×ª×—×™×œ",
          themeIsDark() ? "rgba(56,189,248,.10)" : "rgba(37,99,235,.10)",
          themeIsDark() ? "#e5e7eb" : "#0f172a"
        );
        if (timer) { clearTimeout(timer); timer=null; }
      }
      function start(){
        state = "waiting";
        res.textContent = "××—×›×”â€¦";
        setBtn("×ª×—×›×”â€¦",
          themeIsDark() ? "rgba(245,158,11,.20)" : "rgba(245,158,11,.18)",
          themeIsDark() ? "#e5e7eb" : "#0f172a"
        );
        const delay = 850 + Math.random()*2600;
        timer = setTimeout(()=>{
          state = "ready";
          startTime = performance.now();
          res.textContent = "×¢×›×©×™×•!";
          setBtn("×œ×—×¥!!!",
            themeIsDark() ? "rgba(34,197,94,.25)" : "rgba(34,197,94,.22)",
            themeIsDark() ? "#e5e7eb" : "#0f172a"
          );
        }, delay);
      }
      function grade(ms){
        if (ms < 185) return "ğŸ§  ×¤×¡×™×›×™.";
        if (ms < 240) return "âš¡ ××˜×•×¨×£.";
        if (ms < 320) return "ğŸ”¥ ×—×–×§.";
        if (ms < 430) return "ğŸ™‚ ×¡×‘×‘×”.";
        return "ğŸ¢ ×¢×•×“ ××™××•×Ÿ.";
      }

      btn.addEventListener("click", ()=>{
        if (state === "idle"){ start(); return; }
        if (state === "waiting"){
          res.textContent = "× ×¤×¡×œ×ª ğŸ˜… ×œ×—×¦×ª ××•×§×“×.";
          setBtn("××•×¤×¡â€¦ × ×¡×” ×©×•×‘",
            themeIsDark() ? "rgba(239,68,68,.18)" : "rgba(239,68,68,.16)",
            themeIsDark() ? "#e5e7eb" : "#0f172a"
          );
          if (timer) { clearTimeout(timer); timer=null; }
          state = "idle";
          return;
        }
        if (state === "ready"){
          const ms = Math.round(performance.now() - startTime);
          res.textContent = `${ms}ms â€” ${grade(ms)}`;
          setBtn("×©×—×§ ×©×•×‘",
            themeIsDark() ? "rgba(56,189,248,.10)" : "rgba(37,99,235,.10)",
            themeIsDark() ? "#e5e7eb" : "#0f172a"
          );
          state = "idle";
          return;
        }
      });

      reset();
      return function cleanup(){ if (timer) clearTimeout(timer); };
    }

    /* ======================
       Game 2: MATH QUIZ (8 questions max)
    ====================== */
    function renderMathQuiz(root){
      const wrap = document.createElement("div");
      wrap.className = "q-wrap";
      root.appendChild(wrap);

      const SESSION_SIZE = 8;
      const OPTIONS = 4;

      const used = new Set();
      const session = [];

      let idx = 0, score = 0;
      const startT = performance.now();

      while (session.length < SESSION_SIZE){
        session.push(genQuestion(used));
      }

      function render(){
        wrap.innerHTML = "";

        if (idx >= session.length){
          const sec = Math.round((performance.now()-startT)/1000);
          const pct = Math.round((score/session.length)*100);
          wrap.innerHTML = `
            <div class="q-result">×¡×™×™××ª! ×¦×™×•×Ÿ: ${score}/${session.length} (${pct}%) Â· ×–××Ÿ: ${sec}s</div>
            <div class="q-mini" style="margin-top:10px;">
              <button class="btn" type="button" id="newSession">×¡×©×Ÿ ×—×“×© (×¢×•×“ 8)</button>
              <button class="btn-outline" type="button" id="closeQuiz">×¡×’×•×¨</button>
            </div>
          `;
          wrap.querySelector("#newSession").addEventListener("click", ()=> loadGame("quiz"));
          wrap.querySelector("#closeQuiz").addEventListener("click", closePanel);
          return;
        }

        const item = session[idx];

        const meta = document.createElement("div");
        meta.className = "q-meta";
        meta.innerHTML = `
          <div>×©××œ×” ${idx+1}/${session.length}</div>
          <div>× ×™×§×•×“: ${score}</div>
          <div>×¡×•×’: ${item.tag}</div>
        `;
        wrap.appendChild(meta);

        const qEl = document.createElement("div");
        qEl.className = "q-q";
        qEl.textContent = item.q;
        wrap.appendChild(qEl);

        const opts = document.createElement("div");
        opts.className = "q-opts";

        item.options.forEach((txt, i)=>{
          const b = document.createElement("button");
          b.type = "button";
          b.textContent = txt;
          b.addEventListener("click", ()=>{
            if (i === item.correct) score++;
            idx++;
            render();
          });
          opts.appendChild(b);
        });

        wrap.appendChild(opts);

        const mini = document.createElement("div");
        mini.className = "q-mini";
        mini.innerHTML = `
          <span class="gh-help" style="opacity:.8;">×˜×™×¤: ××œ ×ª× ×—×©. ×ª×—×©×‘.</span>
          <button class="btn-outline" type="button" id="skipQ">×“×œ×’</button>
        `;
        wrap.appendChild(mini);

        mini.querySelector("#skipQ").addEventListener("click", ()=>{
          idx++;
          render();
        });
      }

      render();
      return function cleanup(){};

      function genQuestion(usedSet){
        const types = ["arith","percent","linear","seq","frac","geo","powers","roots","avg"];
        const type = types[Math.floor(Math.random()*types.length)];

        let qObj = null;
        for (let tries=0; tries<250; tries++){
          qObj = buildByType(type);
          if (!qObj) continue;

          const key = qObj.key;
          if (!usedSet.has(key)){
            usedSet.add(key);
            qObj.options = makeOptions(qObj.ans, OPTIONS, qObj.rangeHint);
            qObj.correct = qObj.options.indexOf(qObj.ansText);
            if (qObj.correct === -1){
              qObj.options[0] = qObj.ansText;
              shuffle(qObj.options);
              qObj.correct = qObj.options.indexOf(qObj.ansText);
            }
            return { q: qObj.qText, options: qObj.options, correct: qObj.correct, tag: qObj.tag };
          }
        }

        const a = 7, b = 8;
        const arr = shuffle([String(a*b), String(a*b+2), String(a*b-2), String(a*b+8)]);
        return { q: `×›××” ×–×” ${a}Ã—${b}?`, options: arr, correct: arr.indexOf(String(a*b)), tag: "×›×¤×œ" };
      }

      function buildByType(type){
        if (type === "arith"){
          const a = r(12,99), b = r(12,99);
          const op = pick(["+","-","Ã—"]);
          const ans = (op==="+")? a+b : (op==="-"? a-b : a*b);
          const key = `arith:${a}${op}${b}`;
          return mk(`${a} ${op} ${b} = ?`, ans, "×—×™×©×•×‘", key, {min: -200, max: 9801});
        }
        if (type === "percent"){
          const base = r(80, 900);
          const p = pick([5,10,12,15,20,25,30,35,40]);
          const ans = Math.round((base * p)/100);
          const key = `pct:${p}of${base}`;
          return mk(`×›××” ×–×” ${p}% ××ª×•×š ${base}?`, ans, "××—×•×–×™×", key, {min:0,max:900});
        }
        if (type === "linear"){
          const a = pick([2,3,4,5,6,7,8,9]);
          const x = r(2, 30);
          const b = r(-20, 30);
          const c = a*x + b;
          const key = `lin:${a}x${b}=${c}`;
          return mk(`×× ${a}x ${b>=0?"+":""}${b} = ${c}, ××” x?`, x, "××©×•×•××”", key, {min:-50,max:60});
        }
        if (type === "seq"){
          const k = r(-4, 8);
          const term = (t)=> t*t + k;
          const s = [1,2,3,4].map(term);
          const ans = term(5);
          const key = `seq:${k}`;
          return mk(`×”×©×œ× ×¡×“×¨×”: ${s.join(", ")}, ?`, ans, "×¡×“×¨×”", key, {min:-10,max:80});
        }
        if (type === "frac"){
          const a = pick([1,2,3,4,5,6,7,8,9]);
          const b = pick([2,3,4,5,6,7,8,9,10,12]);
          if (a>=b) return null;
          const val = a/b;
          const key = `frac:${a}/${b}`;
          const ans = Math.round(val*100);
          return mk(`×›××” ××—×•×– ×–×” ×‘×¢×¨×š ${a}/${b}? (×‘×¢×™×’×•×œ)`, ans, "×©×‘×¨×™×", key, {min:0,max:100});
        }
        if (type === "geo"){
          const d = r(2, 14);
          const t = pick([10,15,20,25,30,40,45,50,60,75]);
          const ans = Math.round(d / (t/60));
          const key = `geo:${d}in${t}`;
          return mk(`×× ×¢×•×‘×¨×™× ${d} ×§"× ×‘-${t} ×“×§×•×ª â€” ××” ×”××”×™×¨×•×ª ×‘×§×"×©? (×‘×¢×™×’×•×œ)`, ans, "××”×™×¨×•×ª", key, {min:1,max:200});
        }
        if (type === "powers"){
          const base = pick([2,3,4,5,6,7,8,9]);
          const exp = pick([2,3,4]);
          const ans = Math.pow(base, exp);
          const key = `pow:${base}^${exp}`;
          return mk(`×›××” ×–×” ${base}^${exp}?`, ans, "×—×–×§×•×ª", key, {min:0,max:10000});
        }
        if (type === "roots"){
          const n = pick([9,16,25,36,49,64,81,100,121,144]);
          const ans = Math.round(Math.sqrt(n));
          const key = `root:${n}`;
          return mk(`××” ×”×©×•×¨×© ×”×¨×™×‘×•×¢×™ ×©×œ ${n}?`, ans, "×©×•×¨×©×™×", key, {min:0,max:50});
        }
        if (type === "avg"){
          const a = r(10, 90), b = r(10, 90), c = r(10, 90);
          const ans = Math.round((a+b+c)/3);
          const key = `avg:${a},${b},${c}`;
          return mk(`××” ×”×××•×¦×¢ (×‘×¢×™×’×•×œ) ×©×œ ${a}, ${b}, ${c}?`, ans, "×××•×¦×¢", key, {min:0,max:100});
        }
        return null;
      }

      function mk(qText, ans, tag, key, rangeHint){
        const ansText = String(ans);
        return { qText, ans, ansText, tag, key, rangeHint };
      }

      function makeOptions(ansText, n, hint){
        const ans = Number(ansText);
        const opts = new Set([String(ans)]);
        const min = hint?.min ?? (ans-30);
        const max = hint?.max ?? (ans+30);

        let guard = 0;
        while (opts.size < n && guard++ < 500){
          let cand;
          if (Math.random() < 0.65){
            const delta = pick([1,2,3,4,5,6,7,8,9,10,12,15,20]);
            cand = ans + (Math.random()<0.5 ? -delta : delta);
          } else {
            cand = r(min, max);
          }
          if (cand === ans) continue;
          opts.add(String(cand));
        }
        const arr = Array.from(opts);
        shuffle(arr);
        return arr;
      }
    }

    /* ======================
       Game 3: Memory
    ====================== */
    function renderMemoryGame(root){
      const symbols = ["ğŸ‰","âš½","ğŸ§","ğŸ®","ğŸ§ ","ğŸš€","ğŸ“š","ğŸ”¥","â­","ğŸ¯","ğŸ§Š","ğŸ•"];
      const pairs = isMobile() ? 8 : 10;
      const chosen = shuffle(symbols.slice()).slice(0, pairs);
      let deck = [...chosen, ...chosen].map((sym, i)=>({ id:i, sym }));
      shuffle(deck);

      let revealed = [];
      let matched = new Set();
      let moves = 0, combo = 0, bestCombo = 0;
      let locked = false;

      const start = performance.now();
      let timerId = null;

      const wrap = document.createElement("div");
      wrap.className = "mem-wrap";
      wrap.innerHTML = `
        <div class="gh-card">
          <div class="gh-row">
            <span class="gh-pill">××”×œ×›×™×: <span id="memMoves">0</span></span>
            <span class="gh-pill">×§×•××‘×•: <span id="memCombo">0</span></span>
            <span class="gh-pill">×–××Ÿ: <span id="memTime">0</span>s</span>
          </div>
          <div class="gh-help" style="margin-top:10px;">×ª××¦× ×–×•×’×•×ª. ×¨×¦×£ × ×›×•×Ÿ ××¢×œ×” ×§×•××‘×•.</div>
        </div>

        <div class="mem-grid" id="memGrid"></div>

        <div id="memEnd" class="gh-card" style="display:none;">
          <div style="font-weight:1100; font-size:1.05rem;">×¡×™×™××ª!</div>
          <div class="gh-help" style="margin-top:8px;">
            ××”×œ×›×™×: <b id="memEndMoves"></b> Â· ×–××Ÿ: <b id="memEndTime"></b>s Â· ×§×•××‘×• ×©×™×: <b id="memEndBest"></b>
          </div>
        </div>
      `;
      root.appendChild(wrap);

      const grid = wrap.querySelector("#memGrid");
      const movesEl = wrap.querySelector("#memMoves");
      const comboEl = wrap.querySelector("#memCombo");
      const timeEl  = wrap.querySelector("#memTime");
      const endBox  = wrap.querySelector("#memEnd");

      function render(){
        grid.innerHTML = "";
        deck.forEach((card, idx)=>{
          const el = document.createElement("button");
          el.type = "button";
          el.className = "mem-card";
          const isMatched = matched.has(idx);
          const isRevealed = revealed.includes(idx);

          if (isMatched) el.classList.add("matched");
          else if (isRevealed) el.classList.add("revealed");

          el.textContent = (isMatched || isRevealed) ? card.sym : "â”";
          el.disabled = isMatched || locked;

          el.addEventListener("click", ()=>onPick(idx));
          grid.appendChild(el);
        });
      }

      function onPick(idx){
        if (locked) return;
        if (matched.has(idx)) return;
        if (revealed.includes(idx)) return;

        revealed.push(idx);
        if (revealed.length === 1){ render(); return; }

        moves++;
        movesEl.textContent = String(moves);
        locked = true;
        render();

        const [a,b] = revealed;
        const ok = deck[a].sym === deck[b].sym;

        setTimeout(()=>{
          if (ok){
            matched.add(a); matched.add(b);
            combo++;
            bestCombo = Math.max(bestCombo, combo);
          } else {
            combo = 0;
          }
          comboEl.textContent = String(combo);
          revealed = [];
          locked = false;
          render();

          if (matched.size === deck.length){
            const sec = Math.round((performance.now()-start)/1000);
            endBox.style.display = "block";
            wrap.querySelector("#memEndMoves").textContent = String(moves);
            wrap.querySelector("#memEndTime").textContent = String(sec);
            wrap.querySelector("#memEndBest").textContent = String(bestCombo);
            if (timerId) { clearInterval(timerId); timerId=null; }
          }
        }, ok ? 420 : 620);
      }

      function tick(){
        const sec = Math.round((performance.now()-start)/1000);
        timeEl.textContent = String(sec);
      }

      timerId = setInterval(tick, 250);
      tick();
      render();

      return function cleanup(){ if (timerId) clearInterval(timerId); };
    }

    /* ======================
       Game 4: Dodge Arena (JOYSTICK on mobile)
    ====================== */
    function renderDodgeGame(root){
      const wrap = document.createElement("div");
      wrap.className = "canvas-wrap";

      wrap.innerHTML = `
        <div class="gh-card">
          <div class="gh-row">
            <span class="gh-pill">× ×™×§×•×“: <span id="dgScore">0</span></span>
            <span class="gh-pill">×©×™×: <span id="dgBest">0</span></span>
            <span class="gh-pill">×¨××”: <span id="dgLvl">1</span></span>
          </div>
          <div class="gh-help" style="margin-top:10px;">
            ××—×©×‘: <span class="kbd">WASD</span>/<span class="kbd">×—×¦×™×</span> Â· ××•×‘×™×™×œ: ×’â€™×•×™×¡×˜×™×§.
            <span class="kbd">P</span> ×¢×¦×•×¨/×”××©×š.
          </div>
        </div>

        <div class="canvas-box" id="dgBox">
          <canvas class="game-canvas" id="dgCanvas" width="860" height="460"></canvas>

          <div class="mcontrols">
            <div class="joy" id="dgJoy" aria-label="×’×•×™×¡×˜×™×§">
              <div class="knob" id="dgKnob"></div>
            </div>

            <div class="pad" aria-label="×¤×¢×•×œ×•×ª">
              <button type="button" id="dgPause">â¯</button>
              <button type="button" id="dgNothing1" style="opacity:.55; cursor:default;" disabled>â€¢</button>
              <button type="button" id="dgRestart">â†»</button>

              <button type="button" id="dgSlow">ğŸ¢</button>
              <button type="button" id="dgNothing2" style="opacity:.55; cursor:default;" disabled>â€¢</button>
              <button type="button" id="dgBoost">ğŸš€</button>

              <button type="button" id="dgNothing3" style="opacity:.55; cursor:default;" disabled>â€¢</button>
              <button type="button" id="dgNothing4" style="opacity:.55; cursor:default;" disabled>â€¢</button>
              <button type="button" id="dgNothing5" style="opacity:.55; cursor:default;" disabled>â€¢</button>
            </div>
          </div>
        </div>

        <div class="gh-card" id="dgEnd" style="display:none;">
          <div style="font-weight:1100;font-size:1.05rem;">× ×’××¨ ğŸ˜ˆ</div>
          <div class="gh-help" style="margin-top:8px;">××™×¤×•×¡ ×›×“×™ ×œ×”×ª×—×™×œ ××—×“×©.</div>
        </div>
      `;
      root.appendChild(wrap);

      const box = wrap.querySelector("#dgBox");
      const canvas = wrap.querySelector("#dgCanvas");
      const ctx = canvas.getContext("2d");

      const scoreEl = wrap.querySelector("#dgScore");
      const bestEl  = wrap.querySelector("#dgBest");
      const lvlEl   = wrap.querySelector("#dgLvl");
      const endEl   = wrap.querySelector("#dgEnd");

      let best = Number(localStorage.getItem("yaarat_game_dodge_best") || "0");
      bestEl.textContent = String(best);

      // Fullscreen button on mobile only
      fsBtn.style.display = isMobile() ? "inline-flex" : "none";
      fsBtn.onclick = async ()=>{
        try{
          if (!document.fullscreenElement) await box.requestFullscreen?.();
          else await document.exitFullscreen?.();
        }catch(e){}
      };

      // safer fit: don't let canvas become 0 => freezes / crashes
      function safeFitCanvas(){
        const rect = canvas.getBoundingClientRect();
        if (!rect.width || rect.width < 80) return; // ğŸ‘ˆ ×§×¨×™×˜×™: ×œ× ××’×“×™×œ×™× ×œ-0
        const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
        const targetW = Math.floor(rect.width * dpr);
        const targetH = Math.floor((rect.width * (460/860)) * dpr);
        if (targetW < 160 || targetH < 120) return;
        if (canvas.width !== targetW || canvas.height !== targetH){
          canvas.width = targetW;
          canvas.height = targetH;
        }
      }
      safeFitCanvas();

      let running = true;
      let paused = false;
      let lastT = performance.now();

      const player = { x: 0, y: 0, r: 10, vx:0, vy:0, speed: 300 };
      let bullets = [];
      let particles = [];
      let score = 0;
      let level = 1;
      let spawnTimer = 0;
      let spawnEvery = 0.85;
      let bulletSpeed = 150;
      let keys = Object.create(null);

      // mobile joystick vector
      let joyVec = {x:0,y:0};
      let boost = 0;
      let slow  = 0;

      function W(){ return canvas.width; }
      function H(){ return canvas.height; }

      function reset(){
        safeFitCanvas();
        bullets = [];
        particles = [];
        score = 0;
        level = 1;
        spawnTimer = 0;
        spawnEvery = 0.85;
        bulletSpeed = 150;
        player.r = 10;
        player.speed = 300;
        player.x = (W() || 860)/2;
        player.y = (H() || 460)/2;
        endEl.style.display = "none";
        paused = false;
        running = true;
        lastT = performance.now();
      }

      function togglePause(){ if (running) paused = !paused; }
      function spawnBullet(){
        const w=W(), h=H();
        const edge = Math.floor(Math.random()*4);
        let x,y;
        if (edge===0){ x = Math.random()*w; y = -14; }
        if (edge===1){ x = w+14; y = Math.random()*h; }
        if (edge===2){ x = Math.random()*w; y = h+14; }
        if (edge===3){ x = -14; y = Math.random()*h; }

        const dx = player.x - x;
        const dy = player.y - y;
        const jitter = (Math.random()*0.55 - 0.275);
        const ang = Math.atan2(dy,dx) + jitter;

        const sp = bulletSpeed * (0.9 + Math.random()*0.35);
        bullets.push({
          x,y, vx: Math.cos(ang)*sp, vy: Math.sin(ang)*sp,
          r: 6 + Math.random()*3, life: 12
        });
      }
      function addBurst(x,y, n=18){
        for (let i=0;i<n;i++){
          const a = Math.random()*Math.PI*2;
          const sp = 70 + Math.random()*200;
          particles.push({ x,y, vx: Math.cos(a)*sp, vy: Math.sin(a)*sp, life: 0.6 + Math.random()*0.7 });
        }
      }

      function step(dt){
        const w=W(), h=H();
        if (!w || !h) return;

        // input (desktop)
        let ix = 0, iy = 0;
        if (keys["ArrowLeft"] || keys["a"] || keys["A"]) ix -= 1;
        if (keys["ArrowRight"]|| keys["d"] || keys["D"]) ix += 1;
        if (keys["ArrowUp"]   || keys["w"] || keys["W"]) iy -= 1;
        if (keys["ArrowDown"] || keys["s"] || keys["S"]) iy += 1;

        // input (mobile joystick)
        if (isMobile()){
          ix += joyVec.x;
          iy += joyVec.y;
        }

        const ilen = Math.hypot(ix,iy) || 1;
        if (ix!==0 || iy!==0){ ix/=ilen; iy/=ilen; }

        let sp = player.speed;
        if (boost>0){ sp *= 1.22; boost -= dt; }
        if (slow>0){ sp *= 0.72; slow -= dt; }

        player.vx = ix * sp;
        player.vy = iy * sp;

        player.x += player.vx * dt;
        player.y += player.vy * dt;

        player.x = Math.max(player.r, Math.min(w-player.r, player.x));
        player.y = Math.max(player.r, Math.min(h-player.r, player.y));

        // difficulty
        score += dt * (10 + level*2.2);
        const newLevel = 1 + Math.floor(score/120);
        if (newLevel !== level){
          level = newLevel;
          spawnEvery = Math.max(0.23, 0.85 - (level-1)*0.06);
          bulletSpeed = 150 + (level-1)*24;
          player.speed = 300 + (level-1)*7;
          addBurst(player.x, player.y, 8);
        }

        spawnTimer += dt;
        while (spawnTimer >= spawnEvery){
          spawnTimer -= spawnEvery;
          spawnBullet();
          if (level >= 6 && Math.random() < 0.25) spawnBullet();
        }

        // bullets
        for (let i=bullets.length-1;i>=0;i--){
          const b = bullets[i];
          b.x += b.vx*dt;
          b.y += b.vy*dt;
          b.life -= dt;

          const dist = Math.hypot(b.x-player.x, b.y-player.y);
          if (dist < b.r + player.r){
            running = false;
            endEl.style.display = "block";
            addBurst(player.x, player.y, 32);
            if (score > best){
              best = Math.floor(score);
              localStorage.setItem("yaarat_game_dodge_best", String(best));
            }
            break;
          }
          if (b.life <= 0 || b.x < -60 || b.x > w+60 || b.y < -60 || b.y > h+60){
            bullets.splice(i,1);
          }
        }

        // particles
        for (let i=particles.length-1;i>=0;i--){
          const p = particles[i];
          p.x += p.vx*dt; p.y += p.vy*dt;
          p.vx *= (1 - 2.1*dt); p.vy *= (1 - 2.1*dt);
          p.life -= dt;
          if (p.life <= 0) particles.splice(i,1);
        }
      }

      function draw(){
        const w=W(), h=H();
        if (!w || !h) return;

        ctx.clearRect(0,0,w,h);

        // grid
        ctx.globalAlpha = themeIsDark() ? 0.22 : 0.20;
        ctx.strokeStyle = themeIsDark() ? "#93c5fd" : "#2563eb";
        ctx.lineWidth = 1;
        const stepG = Math.max(42, Math.round(w/18));
        for (let x=stepG;x<w;x+=stepG){ ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,h); ctx.stroke(); }
        for (let y=stepG;y<h;y+=stepG){ ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(w,y); ctx.stroke(); }
        ctx.globalAlpha = 1;

        // bullets
        bullets.forEach(b=>{
          ctx.beginPath();
          ctx.fillStyle = themeIsDark() ? "rgba(239,68,68,.88)" : "rgba(239,68,68,.72)";
          ctx.arc(b.x,b.y,b.r,0,Math.PI*2);
          ctx.fill();
        });

        // player
        ctx.beginPath();
        ctx.fillStyle = themeIsDark() ? "rgba(34,197,94,.95)" : "rgba(34,197,94,.82)";
        ctx.arc(player.x, player.y, player.r, 0, Math.PI*2);
        ctx.fill();

        // ring
        ctx.globalAlpha = 0.25;
        ctx.lineWidth = Math.max(5, Math.round(w/180));
        ctx.strokeStyle = themeIsDark() ? "#38bdf8" : "#2563eb";
        ctx.beginPath();
        ctx.arc(player.x, player.y, player.r+10, 0, Math.PI*2);
        ctx.stroke();
        ctx.globalAlpha = 1;

        // particles
        particles.forEach(p=>{
          ctx.globalAlpha = Math.max(0, Math.min(1, p.life));
          ctx.fillStyle = "#f59e0b";
          ctx.fillRect(p.x, p.y, 3, 3);
        });
        ctx.globalAlpha = 1;

        // HUD
        ctx.globalAlpha = 0.85;
        ctx.fillStyle = themeIsDark() ? "#e5e7eb" : "#0f172a";
        ctx.font = "900 14px system-ui, -apple-system, Segoe UI, Arial";
        ctx.fillText(paused ? "PAUSED" : "DODGE", 12, 20);
        ctx.globalAlpha = 1;
      }

      function loop(t){
        const dt = Math.min(0.033, (t-lastT)/1000);
        lastT = t;

        safeFitCanvas();
        if (running && !paused) step(dt);
        draw();

        scoreEl.textContent = String(Math.floor(score));
        bestEl.textContent  = String(best);
        lvlEl.textContent   = String(level);

        raf = requestAnimationFrame(loop);
      }

      function onKeyDown(e){
        keys[e.key] = true;
        if (e.key === "p" || e.key === "P") togglePause();
      }
      function onKeyUp(e){ keys[e.key] = false; }

      // Mobile joystick
      const joy = wrap.querySelector("#dgJoy");
      const knob= wrap.querySelector("#dgKnob");
      let joyDown = false;

      function setKnob(nx, ny){
        const max = 40;
        const x = Math.max(-max, Math.min(max, nx));
        const y = Math.max(-max, Math.min(max, ny));
        knob.style.transform = `translate(${x}px, ${y}px) translate(-50%,-50%)`;
        joyVec.x = x/max;
        joyVec.y = y/max;
      }
      function joyPos(ev){
        const rect = joy.getBoundingClientRect();
        const cx = rect.left + rect.width/2;
        const cy = rect.top + rect.height/2;
        return { x: ev.clientX - cx, y: ev.clientY - cy };
      }
      function onJoyDown(ev){
        joyDown = true;
        joy.setPointerCapture?.(ev.pointerId);
        const p = joyPos(ev);
        setKnob(p.x, p.y);
      }
      function onJoyMove(ev){
        if (!joyDown) return;
        const p = joyPos(ev);
        setKnob(p.x, p.y);
      }
      function onJoyUp(){
        joyDown = false;
        setKnob(0,0);
      }

      // buttons
      wrap.querySelector("#dgPause").addEventListener("click", togglePause);
      wrap.querySelector("#dgRestart").addEventListener("click", reset);
      wrap.querySelector("#dgBoost").addEventListener("click", ()=>{ boost = 0.35; });
      wrap.querySelector("#dgSlow").addEventListener("click", ()=>{ slow  = 0.45; });

      joy.addEventListener("pointerdown", onJoyDown);
      joy.addEventListener("pointermove", onJoyMove);
      joy.addEventListener("pointerup", onJoyUp);
      joy.addEventListener("pointercancel", onJoyUp);

      let raf = requestAnimationFrame(loop);
      window.addEventListener("keydown", onKeyDown);
      window.addEventListener("keyup", onKeyUp);
      window.addEventListener("resize", safeFitCanvas);

      // ğŸ‘ˆ ×—×©×•×‘: ×××ª×—×œ×™× ××—×¨×™ ×¤×¨×™×™× ×›×“×™ ×©×”×¤×× ×œ ×›×‘×¨ "× ×¤×ª×—" ×•×”×§× ×‘×¡ ×œ× ×™×”×™×” 0
      requestAnimationFrame(()=>reset());

      return function cleanup(){
        cancelAnimationFrame(raf);
        window.removeEventListener("keydown", onKeyDown);
        window.removeEventListener("keyup", onKeyUp);
        window.removeEventListener("resize", safeFitCanvas);
        joy.removeEventListener("pointerdown", onJoyDown);
        joy.removeEventListener("pointermove", onJoyMove);
        joy.removeEventListener("pointerup", onJoyUp);
        joy.removeEventListener("pointercancel", onJoyUp);
        fsBtn.onclick = null;
      };
    }

function renderSnakeGame(root){
  const ID = "dnx-ultra-v1";
  const STYLE_ID = "dnx-ultra-style";

  root.innerHTML = "";

  if (root.__dnxCleanup){
    try { root.__dnxCleanup(); } catch(e){}
    root.__dnxCleanup = null;
  }

  // âœ… remove old style
  document.getElementById(STYLE_ID)?.remove();

  // âœ… add style (clean)
  const st = document.createElement("style");
  st.id = STYLE_ID;
  st.textContent = `
:root{
  --dnx-bg: rgba(255,255,255,.80);
  --dnx-bg2: rgba(248,250,252,.72);
  --dnx-border: rgba(15,23,42,.10);
  --dnx-border2: rgba(15,23,42,.08);
  --dnx-text: rgba(15,23,42,.92);
  --dnx-muted: rgba(15,23,42,.72);

  --dnx-pill: rgba(2,6,23,.04);
  --dnx-pill2: rgba(2,6,23,.03);

  --dnx-shadow: 0 18px 55px rgba(2,6,23,.12);
  --dnx-shadow2: 0 12px 26px rgba(2,6,23,.10);

  --dnx-glass: blur(14px);
  --dnx-radius: 18px;

  --dnx-acc: #38bdf8;
  --dnx-accBorder: rgba(56,189,248,.50);
  --dnx-accGlow: 0 18px 55px rgba(56,189,248,.22);
}

.dnx-stage, .dnx-btn, .dnx-canvas, .dnx-mobilebar, .dnx-mobile{
  touch-action: none;
  -webkit-user-select: none;
  user-select: none;
}

/* dark theme vars */
html[data-theme="dark"]{
  --dnx-bg: rgba(2,6,23,.62);
  --dnx-bg2: rgba(15,23,42,.52);
  --dnx-border: rgba(148,163,184,.18);
  --dnx-border2: rgba(148,163,184,.14);
  --dnx-text: rgba(226,232,240,.92);
  --dnx-muted: rgba(226,232,240,.78);

  --dnx-pill: rgba(255,255,255,.06);
  --dnx-pill2: rgba(255,255,255,.04);

  --dnx-shadow: 0 22px 65px rgba(0,0,0,.28);
  --dnx-shadow2: 0 12px 26px rgba(0,0,0,.18);

  --dnx-accBorder: rgba(56,189,248,.55);
  --dnx-accGlow: 0 18px 60px rgba(56,189,248,.26);
}

@media (prefers-color-scheme: dark){
  html:not([data-theme]){
    --dnx-bg: rgba(2,6,23,.62);
    --dnx-bg2: rgba(15,23,42,.52);
    --dnx-border: rgba(148,163,184,.18);
    --dnx-border2: rgba(148,163,184,.14);
    --dnx-text: rgba(226,232,240,.92);
    --dnx-muted: rgba(226,232,240,.78);

    --dnx-pill: rgba(255,255,255,.06);
    --dnx-pill2: rgba(255,255,255,.04);

    --dnx-shadow: 0 22px 65px rgba(0,0,0,.28);
    --dnx-shadow2: 0 12px 26px rgba(0,0,0,.18);

    --dnx-accBorder: rgba(56,189,248,.55);
    --dnx-accGlow: 0 18px 60px rgba(56,189,248,.26);
  }
}

.dnx-wrap{ width:100%; display:grid; gap:12px; }

.dnx-hud{
  display:flex; align-items:center; justify-content:space-between;
  gap:10px; flex-wrap:wrap;
  padding:12px 14px;
  border-radius: var(--dnx-radius);
  border:1px solid var(--dnx-border);
  background: linear-gradient(135deg, var(--dnx-bg), var(--dnx-bg2));
  box-shadow: var(--dnx-shadow);
  backdrop-filter: var(--dnx-glass);
  -webkit-backdrop-filter: var(--dnx-glass);
  color: var(--dnx-text);
  font-family: system-ui, -apple-system, Segoe UI, Arial;
}

.dnx-left{display:flex; gap:10px; align-items:center; flex-wrap:wrap}

.dnx-pill{
  display:flex; gap:8px; align-items:center;
  padding:8px 12px; border-radius:999px;
  border:1px solid var(--dnx-border2);
  background: linear-gradient(135deg, var(--dnx-pill), var(--dnx-pill2));
  color: var(--dnx-text);
  font-weight:1000;
}

.dnx-pill-acc{
  border-color: var(--dnx-accBorder);
  background: linear-gradient(135deg, rgba(56,189,248,.22), rgba(34,197,94,.12));
  box-shadow: var(--dnx-accGlow);
}

.dnx-tip{ opacity:.92; color: var(--dnx-muted); font-weight:900; font-size:.92rem; }

.dnx-stage{
  position:relative;
  border-radius: var(--dnx-radius);
  overflow:hidden;
  border:1px solid var(--dnx-border);
  box-shadow: var(--dnx-shadow);
  background: rgba(255,255,255,.10);
  aspect-ratio: 860 / 460;
}

.dnx-canvas{
  width:100%;
  height:100%;
  display:block;
  touch-action: none;
}

.dnx-btn{
  padding:10px 12px;
  border-radius:14px;
  border:1px solid var(--dnx-border);
  background: linear-gradient(135deg, var(--dnx-bg), var(--dnx-bg2));
  color: var(--dnx-text);
  font-weight:1000;
  cursor:pointer;
  box-shadow: var(--dnx-shadow2);
  user-select:none;
  transition: transform .08s ease, filter .12s ease;
  font-family: system-ui, -apple-system, Segoe UI, Arial;
  touch-action:none;
}
.dnx-btn:hover{filter:brightness(1.03)}
.dnx-btn:active{transform:translateY(1px)}

.dnx-btn-acc{
  border-color: var(--dnx-accBorder);
  background: linear-gradient(135deg, rgba(56,189,248,.28), rgba(34,197,94,.14));
  box-shadow: var(--dnx-accGlow);
}

/* âœ… Overlay (clean + consistent) */
.dnx-overlay{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:7;
  pointer-events:none;
}
#dnxOverlay::before{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  background: rgba(0,0,0,0.08);
}
#dnxStartCard, #dnxOverCard, #dnxPausedCard{
  position:relative;
  z-index:1;
  pointer-events:auto;
}

.dnx-card{
  min-width:min(560px, calc(100% - 28px));
  padding:14px 14px;
  border-radius: var(--dnx-radius);
  border:1px solid var(--dnx-border);
  background: linear-gradient(135deg, var(--dnx-bg), var(--dnx-bg2));
  box-shadow: var(--dnx-shadow);
  backdrop-filter: var(--dnx-glass);
  -webkit-backdrop-filter: var(--dnx-glass);
  color: var(--dnx-text);
  font-family: system-ui, -apple-system, Segoe UI, Arial;
}
.dnx-title{font-weight:1150; font-size:1.12rem}
.dnx-sub{opacity:.92; margin-top:6px; color:var(--dnx-muted); font-weight:900; line-height:1.35}
.dnx-row{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px}

/* âœ… Mobile control bar (looks like joystick area) */
.dnx-mobilebar{
  display:none;
  width:100%;
  border-radius: 22px;
  border: 1px solid rgba(15,23,42,.12);
  background: rgba(255,255,255,.86);
  box-shadow: 0 14px 40px rgba(2,6,23,.16);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  padding: 10px 10px calc(10px + env(safe-area-inset-bottom));
}

html[data-theme="dark"] .dnx-mobilebar{
  border-color: rgba(148,163,184,.18);
  background: rgba(2,6,23,.55);
  box-shadow: 0 18px 55px rgba(0,0,0,.28);
}

.dnx-mobile{
  display:flex;
  gap:10px;
  width:100%;
}

@media (max-width:760px){
  .dnx-tip{ display:none; }
  .dnx-hud{ padding:10px 10px; gap:8px; }
  .dnx-left{ gap:6px }
  .dnx-pill{ padding:6px 10px; font-size:.9rem; }
  .dnx-stage{ border-radius:16px; aspect-ratio: 16 / 10; }
  .dnx-mobilebar{ display:block; }

  .dnx-mobile .dnx-btn{
    flex:1;
    padding:14px 12px;
    border-radius:18px;
    font-size:1rem;
    background: rgba(255,255,255,.70);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }
  html[data-theme="dark"] .dnx-mobile .dnx-btn{
    background: rgba(2,6,23,.40);
  }
}

/* Anti-double tap zoom on iOS within game area */
.dnx-wrap, .dnx-stage, .dnx-mobilebar, .dnx-btn, .dnx-canvas{
  -webkit-tap-highlight-color: transparent;
}
  `;
  document.head.appendChild(st);

  const wrap = document.createElement("div");
  wrap.className = "dnx-wrap";
  wrap.id = ID;

  // âœ… mobile buttons OUTSIDE stage + inside a "joystick-like" bar
  wrap.innerHTML = `
<div class="dnx-hud" dir="rtl">
  <div class="dnx-left">
    <div class="dnx-pill dnx-pill-acc">Dino ğŸ¦–</div>
    <div class="dnx-pill">× ×™×§×•×“: <span id="dnxScore">0</span></div>
    <div class="dnx-pill">×©×™×: <span id="dnxBest">0</span></div>
    <div class="dnx-pill">××”×™×¨×•×ª: <span id="dnxSpd">1</span>x</div>
    <div class="dnx-pill">××¦×‘: <span id="dnxMode">×™×•×</span></div>
  </div>

  <div class="dnx-left">
    <div class="dnx-tip">××—×©×‘: WASD/×—×¦×™× Â· ××•×‘×™×™×œ: ×›×¤×ª×•×¨×™×</div>
    <button type="button" id="dnxMute" class="dnx-btn" aria-label="Mute">ğŸ”ˆ</button>
    <button type="button" id="dnxRestart" class="dnx-btn" aria-label="Restart">××™×¤×•×¡</button>
    <button type="button" id="dnxPause" class="dnx-btn dnx-btn-acc" aria-label="Pause">×¢×¦×™×¨×”</button>
  </div>
</div>

<div class="dnx-stage" dir="rtl">
  <canvas id="dnxCanvas" class="dnx-canvas" width="960" height="560"></canvas>

  <div class="dnx-overlay" id="dnxOverlay">
    <div class="dnx-card" id="dnxStartCard">
      <div class="dnx-title">Dino ğŸ¦–</div>
      <div class="dnx-sub">××—×©×‘: ×¨×•×•×—/×—×¥ ×œ××¢×œ×” ×œ×§×¤×™×¦×” Â· ×—×¥ ×œ××˜×” ×œ×”×ª×›×•×¤×£ Â· P ×¢×¦×™×¨×” Â· R ××™×¤×•×¡ Â· M ×”×©×ª×§×”</div>
      <div class="dnx-row">
        <button type="button" id="dnxStartMute" class="dnx-btn">×”×ª×—×œ</button>
      </div>
    </div>

    <div class="dnx-card" id="dnxOverCard" style="display:none">
      <div class="dnx-title">× ×¤×¡×œ×ª</div>
      <div class="dnx-sub">×œ×—×¥ "××™×¤×•×¡" ××• × ×¡×” ×©×•×‘</div>
      <div class="dnx-row">
        <button type="button" id="dnxOverRestart" class="dnx-btn dnx-btn-acc">× ×¡×” ×©×•×‘</button>
        <button type="button" id="dnxOverMute" class="dnx-btn">ğŸ”ˆ</button>
      </div>
    </div>

    <div class="dnx-card" id="dnxPausedCard" style="display:none">
      <div class="dnx-title">××•×©×”×”</div>
      <div class="dnx-sub">×”××©×š ××• ×©× ×” ×§×•×œ</div>
      <div class="dnx-row">
        <button type="button" id="dnxResume" class="dnx-btn dnx-btn-acc">×”××©×š</button>
        <button type="button" id="dnxPauseMute" class="dnx-btn">ğŸ”ˆ</button>
      </div>
    </div>
  </div>
</div>

<!-- âœ… Joystick-like bar for mobile controls -->
<div class="dnx-mobilebar" aria-label="×¤×§×“×™× ×œ××•×‘×™×™×œ">
  <div class="dnx-mobile">
    <button type="button" id="dnxJump" class="dnx-btn dnx-btn-acc">×§×¤×™×¦×”</button>
    <button type="button" id="dnxDuck" class="dnx-btn">×”×ª×›×•×¤×£</button>
  </div>
</div>
`;

  root.appendChild(wrap);

  const canvas = wrap.querySelector("#dnxCanvas");
  const ctx = canvas.getContext("2d");

  const scoreEl = wrap.querySelector("#dnxScore");
  const bestEl  = wrap.querySelector("#dnxBest");
  const spdEl   = wrap.querySelector("#dnxSpd");
  const modeEl  = wrap.querySelector("#dnxMode");

  const overlay = wrap.querySelector("#dnxOverlay");
  const startCard = wrap.querySelector("#dnxStartCard");
  const overCard = wrap.querySelector("#dnxOverCard");
  const pausedCard = wrap.querySelector("#dnxPausedCard");

  const btnStartMute = wrap.querySelector("#dnxStartMute");

  const jumpBtn = wrap.querySelector("#dnxJump");
  const duckBtn = wrap.querySelector("#dnxDuck");

  const pauseBtn = wrap.querySelector("#dnxPause");
  const restartBtn = wrap.querySelector("#dnxRestart");
  const muteBtn = wrap.querySelector("#dnxMute");

  const overRestartBtn = wrap.querySelector("#dnxOverRestart");
  const overMuteBtn = wrap.querySelector("#dnxOverMute");
  const resumeBtn = wrap.querySelector("#dnxResume");
  const pauseMuteBtn = wrap.querySelector("#dnxPauseMute");

  // (Joystick not used in this version, keep null-safe)
  const joyEl = wrap.querySelector("#dnxJoy");
  const joyKnob = wrap.querySelector("#dnxJoyKnob");

  function pickBrand(){
    const cs = getComputedStyle(document.documentElement);
    const vars = ["--accent","--primary","--brand","--color-primary","--main","--theme"];
    for (const v of vars){
      const val = (cs.getPropertyValue(v) || "").trim();
      if (val) return val;
    }
    const meta = document.querySelector('meta[name="theme-color"]')?.getAttribute("content");
    return (meta && meta.trim()) ? meta.trim() : "#38bdf8";
  }
  function hexToRgb(hex){
    const h = (hex||"").trim();
    const m = h.match(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i);
    if (!m) return {r:56,g:189,b:248};
    let s = m[1];
    if (s.length===3) s = s.split("").map(ch=>ch+ch).join("");
    const n = parseInt(s,16);
    return { r:(n>>16)&255, g:(n>>8)&255, b:n&255 };
  }
  const BRAND = pickBrand();
  const brandRGB = hexToRgb(BRAND);

  const isDark = () => {
    const dt = document.documentElement.getAttribute("data-theme");
    if (dt) return dt === "dark";
    return window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches;
  };

  let audio = null;
  let muted = false;

  function ensureAudio(){
    if (audio) return audio;
    try{
      const AC = window.AudioContext || window.webkitAudioContext;
      if (!AC) return null;
      audio = new AC();
      return audio;
    }catch(e){ return null; }
  }
  function warm(){ try{ ensureAudio(); }catch(e){} }

  function tone(freq=440, dur=0.055, vol=0.045, type="sine"){
    if (muted) return;
    const ac = ensureAudio();
    if (!ac) return;
    try{
      if (ac.state === "suspended") ac.resume?.();
      const t0 = ac.currentTime;
      const o = ac.createOscillator();
      const g = ac.createGain();
      o.type = type;
      g.gain.setValueAtTime(0.0001, t0);
      o.frequency.setValueAtTime(freq, t0);
      g.gain.exponentialRampToValueAtTime(vol, t0 + 0.01);
      g.gain.exponentialRampToValueAtTime(0.0001, t0 + dur);
      o.connect(g); g.connect(ac.destination);
      o.start(t0); o.stop(t0 + dur + 0.02);
    }catch(e){}
  }

  const sfx = {
    jump(){ tone(540, 0.06, 0.045, "sine"); },
    land(){ tone(240, 0.05, 0.030, "triangle"); },
    score(){ tone(780, 0.04, 0.030, "sine"); },
    hit(){ tone(160, 0.12, 0.060, "sawtooth"); },
    ui(){ tone(520, 0.03, 0.028, "triangle"); }
  };

  function setMuted(v){
    muted = !!v;
    const icon = muted ? "ğŸ”‡" : "ğŸ”ˆ";
    if (muteBtn) muteBtn.textContent = icon;
    if (overMuteBtn) overMuteBtn.textContent = icon;
    if (pauseMuteBtn) pauseMuteBtn.textContent = icon;
  }

  function fitCanvas(){
    const rect = canvas.getBoundingClientRect();
    if (!rect.width || rect.width < 120) return;
    const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
    const targetW = Math.floor(rect.width * dpr);
    const targetH = Math.floor(rect.width * (460/860) * dpr);
    if (canvas.width !== targetW || canvas.height !== targetH){
      canvas.width = targetW;
      canvas.height = targetH;
    }
  }
  const groundY = () => Math.floor(canvas.height * 0.80);

  const NIGHT_EVERY = 260;
  const BASE_SPEED  = 360;
  const MAX_SPEED   = 880;
  const SCORE_RATE  = 10.5;
  const PASS_BONUS  = 12;

  let best = Number(localStorage.getItem("yaarat_game_dino_best") || "0");
  if (bestEl) bestEl.textContent = String(best);

  let alive = false;
  let paused = false;
  let startedOnce = false;

  let score = 0;
  let dist = 0;
  let speed = BASE_SPEED;

  let lastT = performance.now();
  let raf = null;

  let camShake = 0;
  let camX = 0, camY = 0;

  let clouds = [];
  let stars = [];
  let hills = [];
  let groundDots = [];
  let dust = [];
  let sparks = [];
  let obstacles = [];

  let spawnT = 0;
  let nextSpawn = 0.9;

  let runClock = 0;
  let flapClock = 0;
  let scoreClock = 0;
  let nightFade = 0;

  const player = {
    x: 0, y: 0,
    w: 38, h: 52,
    vy: 0,
    onGround: true,
    duck: false,
    squash: 0,
    coyote: 0,
  };

  function rnd(a,b){ return a + Math.random()*(b-a); }
  function clamp(x,a,b){ return Math.max(a, Math.min(b, x)); }
  function lerp(a,b,t){ return a + (b-a)*t; }

  function showOverlay(which){
    if (!overlay) return;
    overlay.style.display = "flex";
    if (startCard) startCard.style.display = (which==="start") ? "block" : "none";
    if (overCard) overCard.style.display = (which==="over") ? "block" : "none";
    if (pausedCard) pausedCard.style.display = (which==="paused") ? "block" : "none";
  }
  function hideOverlay(){ if (overlay) overlay.style.display = "none"; }

  function mkCloud(x,y){ return { x, y, r:rnd(14,30), vx:rnd(10,26), k:rnd(0.85,1.35) }; }
  function mkStar(){ return { x: Math.random(), y: Math.random(), a:rnd(0.25,0.95), s:rnd(0.6,1.8) }; }
  function mkHill(){ return { x: Math.random(), h: rnd(0.08, 0.20), w: rnd(0.18, 0.40), v: rnd(0.08, 0.16) }; }
  function mkGroundDot(){ return { x: Math.random(), s: rnd(1,3), a:rnd(0.18,0.55) }; }

  function resetWorld(){
    fitCanvas();
    alive = true;
    paused = false;

    score = 0;
    dist = 0;
    speed = BASE_SPEED;

    camShake = 0; camX = 0; camY = 0;

    runClock = 0;
    flapClock = 0;
    scoreClock = 0;
    nightFade = isDark() ? 1 : 0;

    player.duck = false;
    player.vy = 0;
    player.w = 38;
    player.h = 52;
    player.onGround = true;
    player.squash = 0;
    player.coyote = 0.08;
    player.x = Math.max(64, Math.floor(canvas.width * 0.12));
    player.y = groundY() - player.h;

    obstacles = [];
    dust = [];
    sparks = [];

    clouds = [];
    for (let i=0;i<4;i++){
      clouds.push(mkCloud(canvas.width*(0.12+i*0.25), canvas.height*(0.14+rnd(0,0.16))));
    }

    stars = [];
    for (let i=0;i<70;i++) stars.push(mkStar());

    hills = [];
    for (let i=0;i<7;i++) hills.push(mkHill());

    groundDots = [];
    for (let i=0;i<120;i++) groundDots.push(mkGroundDot());

    spawnT = 0;
    nextSpawn = 0.85 + Math.random()*0.6;

    lastT = performance.now();
  }

  function hardStart(withMute){
    try{
      startedOnce = true;
      paused = false;
      alive = false;

      setMuted(!!withMute);

      hideOverlay();
      resetWorld();

      alive = true;
      paused = false;
      lastT = performance.now();

      if (!raf) raf = requestAnimationFrame(loop);
    }catch(e){
      alive = false;
      paused = false;
      showOverlay("start");
    }
  }

  function die(){
    alive = false;
    sfx.hit();
    camShake = 0.35;

    const s = Math.floor(score);
    if (s > best){
      best = s;
      localStorage.setItem("yaarat_game_dino_best", String(best));
      if (bestEl) bestEl.textContent = String(best);
    }
    showOverlay("over");
  }

  function togglePause(){
    if (!startedOnce) return;
    if (!alive) return;
    paused = !paused;
    sfx.ui();
    if (paused) showOverlay("paused");
    else hideOverlay();
  }

  function jump(){
    if (!startedOnce) return;
    if (!alive || paused) return;

    if (player.onGround || player.coyote > 0){
      player.vy = -760;
      player.onGround = false;
      player.coyote = 0;
      player.squash = 0;
      sfx.jump();

      for (let i=0;i<12;i++){
        dust.push({
          x: player.x + rnd(6, player.w*0.4),
          y: player.y + player.h - rnd(0,4),
          vx: rnd(-220, -80),
          vy: rnd(-120, 60),
          r: rnd(1.8, 4.4),
          a: rnd(0.6, 1),
          life: rnd(0.18, 0.35)
        });
      }
    }
  }

  function setDuck(v){
    if (!startedOnce) return;
    if (!alive || paused) return;
    player.duck = !!v;
  }

  function spawnObstacle(){
    const roll = Math.random();
    const gy = groundY();

    if (dist > 12 && roll < 0.24){
      const size = rnd(18, 26);
      const hi = Math.random() < 0.55 ? 0.62 : 0.70;
      obstacles.push({ type:"bird", x:canvas.width+70, y:Math.floor(canvas.height*hi)-size, w:size*1.45, h:size, passed:false });
      return;
    }

    if (roll < 0.48){
      const w = rnd(24, 38);
      const h = rnd(16, 26);
      obstacles.push({ type:"rock", x:canvas.width+50, y:gy-h, w, h, passed:false });
      return;
    }

    const tall = Math.random() < 0.36;
    const h = tall ? rnd(70, 104) : rnd(52, 78);
    const w = rnd(16, 24);
    obstacles.push({ type:"cactus", x:canvas.width+50, y:gy-h, w, h, arms:Math.random()<0.65, double:Math.random()<0.22, passed:false });
  }

  function collide(ax,ay,aw,ah, bx,by,bw,bh){
    return ax < bx+bw && ax+aw > bx && ay < by+bh && ay+ah > by;
  }

  function rr(x,y,w,h,r){
    r = Math.max(0, Math.min(r, Math.min(w,h)/2));
    ctx.beginPath();
    ctx.moveTo(x+r, y);
    ctx.arcTo(x+w, y, x+w, y+h, r);
    ctx.arcTo(x+w, y+h, x, y+h, r);
    ctx.arcTo(x, y+h, x, y, r);
    ctx.arcTo(x, y, x+w, y, r);
    ctx.closePath();
  }

  function step(dt){
    dist += dt;
    speed = clamp(BASE_SPEED + dist*24, BASE_SPEED, MAX_SPEED);

    const cycle = Math.floor(score / NIGHT_EVERY);
    const targetNight = isDark() ? 1 : (cycle % 2);
    nightFade += (targetNight - nightFade) * Math.min(1, dt*1.1);

    runClock += dt * clamp(speed/240, 1.0, 2.7);
    flapClock += dt * 10.5;

    scoreClock += dt * SCORE_RATE;
    if (scoreClock >= 1){
      const add = Math.floor(scoreClock);
      score += add;
      scoreClock = scoreClock % 1;
      if (add > 0 && (Math.floor(score) % 100 === 0)) sfx.score();
    }

    const g = 1950;
    player.vy += g * dt;

    const targetH = player.duck ? 32 : 52;
    const targetW = player.duck ? 54 : 38;

    const prevH = player.h;
    player.h += (targetH - player.h) * Math.min(1, dt*18);
    player.w += (targetW - player.w) * Math.min(1, dt*18);
    player.y += (prevH - player.h);

    player.y += player.vy * dt;

    const gy = groundY();
    const wasAir = !player.onGround;

    if (player.y + player.h >= gy){
      player.y = gy - player.h;
      player.vy = 0;
      player.onGround = true;
      player.coyote = 0.08;

      if (wasAir){
        player.squash = 1;
        sfx.land();
        for (let i=0;i<10;i++){
          dust.push({
            x: player.x + rnd(10, player.w*0.6),
            y: gy - rnd(0,2),
            vx: rnd(-240, -90),
            vy: rnd(-140, 40),
            r: rnd(1.8, 4.2),
            a: rnd(0.55, 0.95),
            life: rnd(0.18, 0.34)
          });
        }
      }
    } else {
      player.onGround = false;
      player.coyote = Math.max(0, player.coyote - dt);
    }
    player.squash = Math.max(0, player.squash - dt*6);

    spawnT += dt;
    const base = Math.max(0.52, 1.08 - dist*0.02);
    if (spawnT >= nextSpawn){
      spawnT = 0;
      nextSpawn = base + Math.random()*0.75;
      spawnObstacle();
      if (dist > 22 && Math.random() < 0.16) spawnObstacle();
    }

    for (let i=obstacles.length-1;i>=0;i--){
      const o = obstacles[i];
      o.x -= speed * dt;

      if (!o.passed && (o.x + o.w) < player.x){
        o.passed = true;
        score += PASS_BONUS;
        for (let k=0;k<6;k++){
          sparks.push({ x: player.x + player.w, y: player.y + player.h*0.35, vx: rnd(80,240), vy:rnd(-160,60), a:1, life:rnd(0.12,0.22) });
        }
        if (Math.random() < 0.35) sfx.score();
      }

      if (o.x + o.w < -160) obstacles.splice(i,1);
    }

    clouds.forEach(c=>{
      c.x -= (c.vx * c.k + speed*0.06) * dt;
      if (c.x < -160){
        c.x = canvas.width + 200;
        c.y = canvas.height*(0.12+rnd(0,0.18));
        c.vx = rnd(10,26);
        c.r = rnd(14,30);
        c.k = rnd(0.85,1.35);
      }
    });

    hills.forEach(h=>{
      h.x -= (speed * h.v) * dt / canvas.width;
      if (h.x < -0.5) h.x = 1.2;
    });

    groundDots.forEach(d=>{
      d.x -= (speed*0.30) * dt / canvas.width;
      if (d.x < -0.1) { d.x = 1.2; d.s = rnd(1,3); d.a = rnd(0.18,0.55); }
    });

    for (let i=dust.length-1;i>=0;i--){
      const p = dust[i];
      p.life -= dt;
      p.x += p.vx * dt;
      p.y += p.vy * dt;
      p.vy += 1400 * dt;
      p.a = clamp(p.life / 0.35, 0, 1) * 0.9;
      if (p.life <= 0) dust.splice(i,1);
    }

    for (let i=sparks.length-1;i>=0;i--){
      const s = sparks[i];
      s.life -= dt;
      s.x += s.vx * dt;
      s.y += s.vy * dt;
      s.vy += 1100 * dt;
      s.a = clamp(s.life / 0.22, 0, 1);
      if (s.life <= 0) sparks.splice(i,1);
    }

    const pad = 7;
    const px = player.x + pad, py = player.y + pad;
    const pw = Math.max(10, player.w - 2*pad);
    const ph = Math.max(10, player.h - 2*pad);

    for (const o of obstacles){
      const extra = (o.type === "bird") ? 2 : 0;
      if (collide(px,py,pw,ph, o.x,o.y+extra,o.w,o.h-extra*2)){
        die();
        break;
      }
    }

    if (camShake > 0){
      camShake = Math.max(0, camShake - dt*2.8);
      const amt = camShake * (isDark() ? 10 : 8);
      camX = (Math.random()*2-1) * amt;
      camY = (Math.random()*2-1) * amt * 0.6;
    } else { camX = 0; camY = 0; }
  }

  function draw(){
    const w = canvas.width, h = canvas.height;
    if (!w || !h) return;

    ctx.setTransform(1,0,0,1,0,0);
    ctx.clearRect(0,0,w,h);
    ctx.translate(camX, camY);

    const gy = groundY();
    const night = nightFade;

    const sky = ctx.createLinearGradient(0,0,0,h);
    const dayTop = [125,211,252];
    const dayMid = [224,242,254];
    const nt = [
      Math.floor(lerp(10, brandRGB.r, 0.10)),
      Math.floor(lerp(16, brandRGB.g, 0.10)),
      Math.floor(lerp(38, brandRGB.b, 0.12))
    ];
    const nb = [2,6,23];

    const top = [
      Math.floor(lerp(dayTop[0], nt[0], night)),
      Math.floor(lerp(dayTop[1], nt[1], night)),
      Math.floor(lerp(dayTop[2], nt[2], night))
    ];
    const mid = [
      Math.floor(lerp(dayMid[0], nb[0], night)),
      Math.floor(lerp(dayMid[1], nb[1], night)),
      Math.floor(lerp(dayMid[2], nb[2], night))
    ];

    sky.addColorStop(0, `rgba(${top[0]},${top[1]},${top[2]},1)`);
    sky.addColorStop(0.55, `rgba(${mid[0]},${mid[1]},${mid[2]},1)`);
    sky.addColorStop(1, `rgba(${nb[0]},${nb[1]},${nb[2]},1)`);
    ctx.fillStyle = sky;
    ctx.fillRect(-40,-40,w+80,h+80);

    const orbY = h*0.18;
    const orbX = w*0.78;

    ctx.globalAlpha = (1-night) * 0.85;
    ctx.fillStyle = "rgba(255,255,255,.85)";
    ctx.beginPath(); ctx.arc(orbX, orbY, 24, 0, Math.PI*2); ctx.fill();
    ctx.globalAlpha = (1-night) * 0.25;
    ctx.beginPath(); ctx.arc(orbX, orbY, 44, 0, Math.PI*2); ctx.fill();

    ctx.globalAlpha = night * 0.9;
    ctx.fillStyle = "rgba(226,232,240,.95)";
    ctx.beginPath(); ctx.arc(orbX, orbY, 20, 0, Math.PI*2); ctx.fill();
    ctx.globalAlpha = night * 0.55;
    ctx.fillStyle = "rgba(2,6,23,.65)";
    ctx.beginPath(); ctx.arc(orbX+8, orbY-6, 18, 0, Math.PI*2); ctx.fill();
    ctx.globalAlpha = 1;

    if (night > 0.08){
      ctx.fillStyle = "rgba(255,255,255,1)";
      for (const s of stars){
        ctx.globalAlpha = s.a * night;
        ctx.fillRect(s.x*w, s.y*(h*0.62), s.s, s.s);
      }
      ctx.globalAlpha = 1;
    }

    ctx.globalAlpha = lerp(0.35, 0.16, night);
    ctx.fillStyle = night > 0.5 ? "rgba(203,213,225,.85)" : "rgba(100,116,139,.55)";
    clouds.forEach(c=>{
      ctx.beginPath();
      ctx.arc(c.x, c.y, c.r, 0, Math.PI*2);
      ctx.arc(c.x + c.r*0.9, c.y + c.r*0.12, c.r*0.78, 0, Math.PI*2);
      ctx.arc(c.x - c.r*0.9, c.y + c.r*0.18, c.r*0.70, 0, Math.PI*2);
      ctx.fill();
    });
    ctx.globalAlpha = 1;

    ctx.globalAlpha = 0.9;
    hills.forEach((m, idx)=>{
      const x = m.x*w;
      const base = gy + h*0.02;
      const hh = h*m.h;
      const ww = w*m.w;

      const a = lerp(0.18, 0.30, night);
      const tint = idx % 2 ? 0.10 : 0.16;
      ctx.fillStyle = `rgba(${Math.floor(lerp(15, brandRGB.r, tint))},${Math.floor(lerp(23, brandRGB.g, tint))},${Math.floor(lerp(42, brandRGB.b, tint))},${a})`;
      ctx.beginPath();
      ctx.moveTo(x-ww, base);
      ctx.quadraticCurveTo(x, base-hh, x+ww, base);
      ctx.lineTo(x+ww, h+40);
      ctx.lineTo(x-ww, h+40);
      ctx.closePath();
      ctx.fill();
    });
    ctx.globalAlpha = 1;

    const grd = ctx.createLinearGradient(0, gy, 0, h);
    if (night > 0.35){
      grd.addColorStop(0, "rgba(15,23,42,.82)");
      grd.addColorStop(1, "rgba(2,6,23,.98)");
    } else {
      grd.addColorStop(0, "rgba(148,163,184,.38)");
      grd.addColorStop(1, "rgba(241,245,249,1)");
    }
    ctx.fillStyle = grd;
    ctx.fillRect(-40, gy, w+80, h-gy+80);

    ctx.fillStyle = night > 0.5 ? "rgba(148,163,184,.9)" : "rgba(51,65,85,.55)";
    groundDots.forEach(d=>{
      const x = d.x*w;
      ctx.globalAlpha = d.a;
      ctx.fillRect(x, gy + 10 + (d.s%2)*6, d.s, d.s);
    });
    ctx.globalAlpha = 1;

    ctx.strokeStyle = `rgba(${brandRGB.r},${brandRGB.g},${brandRGB.b},${lerp(0.18,0.34, night)})`;
    ctx.lineWidth = Math.max(2, Math.round(w/430));
    ctx.beginPath(); ctx.moveTo(-20, gy); ctx.lineTo(w+20, gy); ctx.stroke();

    for (const p of dust){
      ctx.globalAlpha = p.a * 0.9;
      ctx.fillStyle = night > 0.5 ? "rgba(148,163,184,.95)" : "rgba(51,65,85,.55)";
      ctx.beginPath(); ctx.arc(p.x, p.y, p.r, 0, Math.PI*2); ctx.fill();
    }
    for (const s of sparks){
      ctx.globalAlpha = s.a;
      ctx.fillStyle = `rgba(${brandRGB.r},${brandRGB.g},${brandRGB.b},1)`;
      ctx.fillRect(s.x, s.y, 2, 2);
    }
    ctx.globalAlpha = 1;

    obstacles.forEach(o=>{
      if (o.type === "cactus"){
        const fill = night > 0.45 ? "rgba(34,197,94,.92)" : "rgba(22,163,74,.80)";
        const stroke = night > 0.45 ? "rgba(134,239,172,.26)" : "rgba(20,83,45,.18)";
        ctx.fillStyle = fill;
        ctx.strokeStyle = stroke;
        ctx.lineWidth = Math.max(2, Math.round(w/560));
        rr(o.x, o.y, o.w, o.h, 12);
        ctx.fill(); ctx.stroke();

        if (o.arms){
          const ah = Math.max(14, o.h*0.18);
          const aw = Math.max(12, o.w*1.05);
          const ax = o.x + o.w*0.55;
          const ay = o.y + o.h*0.38;
          rr(ax, ay, aw, ah, 10);
          ctx.fill(); ctx.stroke();
        }

        if (o.double){
          ctx.globalAlpha = 0.85;
          rr(o.x - o.w*1.12, o.y + o.h*0.12, o.w*0.95, o.h*0.88, 12);
          ctx.fill(); ctx.stroke();
          ctx.globalAlpha = 1;
        }

        ctx.globalAlpha = 0.16;
        ctx.fillStyle = "white";
        rr(o.x + o.w*0.12, o.y + o.h*0.08, o.w*0.18, o.h*0.78, 10);
        ctx.fill();
        ctx.globalAlpha = 1;
      }

      if (o.type === "rock"){
        const fill = night > 0.45 ? "rgba(148,163,184,.78)" : "rgba(51,65,85,.34)";
        const stroke = night > 0.45 ? "rgba(226,232,240,.18)" : "rgba(15,23,42,.12)";
        ctx.fillStyle = fill;
        ctx.strokeStyle = stroke;
        ctx.lineWidth = Math.max(2, Math.round(w/600));
        rr(o.x, o.y, o.w, o.h, 12);
        ctx.fill(); ctx.stroke();

        ctx.globalAlpha = 0.16;
        ctx.fillStyle = "white";
        rr(o.x + o.w*0.10, o.y + o.h*0.18, o.w*0.24, o.h*0.55, 10);
        ctx.fill();
        ctx.globalAlpha = 1;
      }

      if (o.type === "bird"){
        const body = night > 0.45 ? "rgba(226,232,240,.90)" : "rgba(15,23,42,.42)";
        const wing = night > 0.45
          ? `rgba(${brandRGB.r},${brandRGB.g},${brandRGB.b},.42)`
          : `rgba(${brandRGB.r},${brandRGB.g},${brandRGB.b},.22)`;

        const flap = Math.sin(flapClock + o.x*0.01) * 0.5 + 0.5;
        const wy = o.y + o.h*(0.12 + flap*0.22);
        const wh = o.h*(0.35 + flap*0.28);

        ctx.fillStyle = body;
        rr(o.x, o.y, o.w, o.h, 12);
        ctx.fill();

        ctx.fillStyle = wing;
        rr(o.x + o.w*0.14, wy, o.w*0.58, wh, 12);
        ctx.fill();

        ctx.globalAlpha = 0.8;
        ctx.fillStyle = night > 0.45 ? "rgba(2,6,23,.92)" : "rgba(255,255,255,.85)";
        ctx.fillRect(o.x + o.w*0.74, o.y + o.h*0.35, 3, 3);
        ctx.globalAlpha = 1;
      }
    });

    const body = (night > 0.45) ? "rgba(226,232,240,.96)" : "rgba(15,23,42,.82)";
    const sq = player.squash;
    const scaleY = 1 - sq*0.10;
    const scaleX = 1 + sq*0.08;

    const dX = player.x + player.w/2;
    const dY = player.y + player.h/2;

    ctx.save();
    ctx.translate(dX, dY);
    ctx.scale(scaleX, scaleY);
    ctx.translate(-dX, -dY);

    const frame = (player.onGround && !player.duck) ? (Math.floor(runClock*8) % 4) : 0;

    ctx.fillStyle = body;
    rr(player.x, player.y, player.w, player.h, 14);
    ctx.fill();

    ctx.globalAlpha = 0.16;
    ctx.fillStyle = `rgba(${brandRGB.r},${brandRGB.g},${brandRGB.b},1)`;
    rr(player.x + player.w*0.10, player.y + player.h*0.24, player.w*0.50, player.h*0.64, 14);
    ctx.fill();
    ctx.globalAlpha = 1;

    ctx.fillStyle = body;
    rr(player.x - player.w*0.26, player.y + player.h*0.58, player.w*0.32, player.h*0.20, 12);
    ctx.fill();

    const headBob = (player.onGround && !player.duck) ? Math.sin(runClock*10)*0.8 : 0;

    ctx.fillStyle = (night > 0.45) ? "rgba(2,6,23,.40)" : "rgba(255,255,255,.30)";
    if (player.duck){
      rr(player.x + player.w*0.14, player.y + player.h*0.80, player.w*0.22, player.h*0.22, 8);
      rr(player.x + player.w*0.56, player.y + player.h*0.80, player.w*0.22, player.h*0.22, 8);
      ctx.fill();
    } else if (player.onGround){
      const a = [
        [0.18,0.82, 0.58,0.78],
        [0.20,0.80, 0.56,0.82],
        [0.18,0.78, 0.58,0.82],
        [0.20,0.82, 0.56,0.78],
      ][frame];
      rr(player.x + player.w*a[0], player.y + player.h*a[1], player.w*0.20, player.h*0.22, 8);
      rr(player.x + player.w*a[2], player.y + player.h*a[3], player.w*0.20, player.h*0.22, 8);
      ctx.fill();
    }

    ctx.fillStyle = (night > 0.45) ? "rgba(2,6,23,.92)" : "rgba(248,250,252,.92)";
    ctx.fillRect(player.x + player.w*0.72, player.y + player.h*0.28 + headBob*0.2, 3, 3);

    if (player.duck){
      ctx.globalAlpha = 0.55;
      ctx.fillRect(player.x + player.w*0.55, player.y + player.h*0.56, player.w*0.30, 2);
      ctx.globalAlpha = 1;
    }

    ctx.restore();
    if (modeEl) modeEl.textContent = night > 0.5 ? "×œ×™×œ×”" : "×™×•×";
  }

  function loop(t){
    const dt = Math.min(0.033, (t - lastT)/1000);
    lastT = t;

    fitCanvas();
    if (alive && !paused) step(dt);
    draw();

    if (scoreEl) scoreEl.textContent = String(Math.floor(score));
    if (bestEl)  bestEl.textContent  = String(best);
    if (spdEl)   spdEl.textContent   = String(Math.round((speed/BASE_SPEED)*10)/10);

    raf = requestAnimationFrame(loop);
  }

  function hardRestart(){
    if (!startedOnce) return;
    sfx.ui();
    hideOverlay();
    resetWorld();
  }

  function onKeyDown(e){
    const k = e.key;

    if (k === "r" || k === "R"){ e.preventDefault(); hardRestart(); return; }
    if (k === "m" || k === "M"){ e.preventDefault(); setMuted(!muted); if (!muted) sfx.ui(); return; }
    if (k === "p" || k === "P"){ e.preventDefault(); togglePause(); return; }

if (!startedOnce){
  if (k === " " || k === "Enter" || k === "ArrowUp"){
    e.preventDefault();
    setMuted(true);
    hardStart(true);
  }
  return;
}


    if (!alive || paused) return;

    if (k === " " || k === "ArrowUp" || k === "w" || k === "W"){ e.preventDefault(); jump(); }
    if (k === "ArrowDown" || k === "s" || k === "S"){ e.preventDefault(); setDuck(true); }
  }

  function onKeyUp(e){
    const k = e.key;
    if (k === "ArrowDown" || k === "s" || k === "S") setDuck(false);
  }

  function bindTap(el, fn) {
    if (!el) return () => {};
    let lastTouch = 0;

    const fire = (e) => {
      try { if (e && e.cancelable) e.preventDefault(); } catch {}
      try { e.stopPropagation(); } catch {}
      warm();
      fn(e);
    };

    const onPointerDown = (e) => fire(e);
    const onTouchStart = (e) => { lastTouch = Date.now(); fire(e); };
    const onClick = (e) => {
      if (Date.now() - lastTouch < 450) return;
      fire(e);
    };

    el.addEventListener("pointerdown", onPointerDown, { passive:false, capture:true });
    el.addEventListener("touchstart", onTouchStart, { passive:false, capture:true });
    el.addEventListener("click", onClick, { passive:false, capture:true });

    return () => {
      el.removeEventListener("pointerdown", onPointerDown, { capture:true });
      el.removeEventListener("touchstart", onTouchStart, { capture:true });
      el.removeEventListener("click", onClick, { capture:true });
    };
  }

  function bindHold(el, onDown, onUp) {
    if (!el) return () => {};
    let down = false;

    const start = (e) => {
      down = true;
      try { if (e && e.cancelable) e.preventDefault(); } catch {}
      try { e.stopPropagation(); } catch {}
      warm();
      onDown(e);
    };

    const end = (e) => {
      if (!down) return;
      down = false;
      onUp(e);
    };

    el.addEventListener("pointerdown", start, { passive:false, capture:true });
    el.addEventListener("touchstart", start, { passive:false, capture:true });

    window.addEventListener("pointerup", end, { passive:false, capture:true });
    window.addEventListener("pointercancel", end, { passive:false, capture:true });
    window.addEventListener("touchend", end, { passive:false, capture:true });
    window.addEventListener("touchcancel", end, { passive:false, capture:true });

    return () => {
      el.removeEventListener("pointerdown", start, { capture:true });
      el.removeEventListener("touchstart", start, { capture:true });

      window.removeEventListener("pointerup", end, { capture:true });
      window.removeEventListener("pointercancel", end, { capture:true });
      window.removeEventListener("touchend", end, { capture:true });
      window.removeEventListener("touchcancel", end, { capture:true });
    };
  }

  const unStart2 = bindTap(btnStartMute, () => { setMuted(true); hardStart(true); lastT = performance.now(); });

  const unOverRestart = bindTap(overRestartBtn, () => hardRestart());
  const unResume      = bindTap(resumeBtn, () => togglePause());

  const unMute1 = bindTap(muteBtn, () => { setMuted(!muted); if (!muted) sfx.ui(); });
  const unMute2 = bindTap(overMuteBtn, () => { setMuted(!muted); if (!muted) sfx.ui(); });
  const unMute3 = bindTap(pauseMuteBtn, () => { setMuted(!muted); if (!muted) sfx.ui(); });

  const unPause   = bindTap(pauseBtn, () => togglePause());
  const unRestart = bindTap(restartBtn, () => hardRestart());

const unJump = bindTap(jumpBtn, () => { 
  if (!startedOnce) { setMuted(true); hardStart(true); }
  else jump();
});

const unDuck = bindHold(
  duckBtn,
  () => { 
    if (!startedOnce) { setMuted(true); hardStart(true); }
    else setDuck(true);
  },
  () => { if (startedOnce) setDuck(false); }
);


const unCanvas = bindTap(canvas, () => {
  if (!startedOnce) { setMuted(true); hardStart(true); return; }
  if (!paused) jump();
});


  // keep joystick code null-safe (not used)
  let unJoy = () => {};
  if (joyEl && joyKnob){
    // (left as-is if you ever add the HTML for joystick)
  }

  const OPT_KEYDOWN = { passive:false, capture:true };
  const OPT_KEYUP   = { capture:true };
  const OPT_RESIZE  = false;

  window.addEventListener("keydown", onKeyDown, OPT_KEYDOWN);
  window.addEventListener("keyup", onKeyUp, OPT_KEYUP);
  window.addEventListener("resize", fitCanvas, OPT_RESIZE);

  fitCanvas();
  showOverlay("start");
  lastT = performance.now();
  raf = requestAnimationFrame(loop);

  function cleanup(){
    if (raf) cancelAnimationFrame(raf);
    raf = null;

    window.removeEventListener("keydown", onKeyDown, OPT_KEYDOWN);
    window.removeEventListener("keyup", onKeyUp, OPT_KEYUP);
    window.removeEventListener("resize", fitCanvas, OPT_RESIZE);

    try { unStart1(); } catch {}
    try { unStart2(); } catch {}
    try { unOverRestart(); } catch {}
    try { unResume(); } catch {}
    try { unMute1(); } catch {}
    try { unMute2(); } catch {}
    try { unMute3(); } catch {}
    try { unPause(); } catch {}
    try { unRestart(); } catch {}
    try { unJump(); } catch {}
    try { unDuck(); } catch {}
    try { unCanvas(); } catch {}
    try { unJoy(); } catch {}
  }

  root.__dnxCleanup = cleanup;
  return cleanup;
}










    // helpers
    function shuffle(arr){
      for (let i=arr.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [arr[i],arr[j]]=[arr[j],arr[i]];
      }
      return arr;
    }
    function r(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }
    function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

    // auto: first chip active on mobile (nice UX)
    if (isMobile()){
      const first = document.querySelector(".gchip");
      if (first){ first.classList.add("active"); }
    }

  })();
  </script>
</section>





  <section id="home-poll-mini" class="section-light reveal-on-scroll">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">×¡×§×¨ ×”×©×‘×•×¢</h2>
        <p class="section-subtitle">
          ××¦×‘×™×¢×™× ×‘×§×œ×™×§ ×•×¨×•××™× ××™×“ ××™×š ×”×©×›×‘×” / ×‘×™×ª ×”×¡×¤×¨ ×—×•×©×‘×™×.
          ××¤×©×¨ ×œ×”×™×›× ×¡ ×œ×¢××•×“ ×”×¡×§×¨×™× ×›×“×™ ×œ×¨××•×ª ××ª ×›×œ ×”×¡×§×¨×™× ×”×§×•×“××™×.
        </p>
      </div>

      <div class="home-poll-card">
        <div class="home-poll-header">
          <span class="home-poll-badge">×¡×§×¨ ×”×©×‘×•×¢</span>
          <span class="home-poll-status-text" id="home-poll-status">×˜×•×¢×Ÿ ×¡×§×¨ ×¤×¢×™×œ...</span>
        </div>

        <div class="home-poll-body" id="home-poll-root">
          <p class="empty-msg">×˜×•×¢×Ÿ ×¡×§×¨...</p>
        </div>

        <div class="home-poll-footer">
          <span class="home-poll-votes" id="home-poll-total">0 ×”×¦×‘×¢×•×ª ×¢×“ ×¢×›×©×™×•</span>
          <a href="polls.html" class="home-poll-link">××¢×‘×¨ ×œ×›×œ ×”×¡×§×¨×™× Â»</a>
        </div>
      </div>
    </div>
  </section>

  <section id="requests" class="section-light reveal-on-scroll">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title" id="requests-title">×ª×™×‘×ª ×‘×§×©×•×ª</h2>
        <p class="section-subtitle" id="requests-subtitle">×¨×•×¦×™× ×œ×‘×§×© ××©×”×•? ×™×© ×¨×¢×™×•×Ÿ ×œ×©×™×¤×•×¨?</p>
      </div>

      <div class="card request-box">
        <h3 id="requests-box-title">×©×œ×™×—×ª ×‘×§×©×” ×œ××•×¢×¦×ª ×”×ª×œ××™×“×™× / ×”× ×”×œ×”</h3>
        <p id="requests-body">
          ×œ××™×œ×•×™ ×˜×•×¤×¡ ×”×‘×§×©×•×ª â€“ ×œ×—×¦×• ×¢×œ ×”×›×¤×ª×•×¨, ××œ××• ×¤×¨×˜×™× ×‘×§×¦×¨×” ×•× ×—×–×•×¨ ××œ×™×›× ×‘×”×§×“×.
        </p>
        <a
          href="https://docs.google.com/forms/d/e/1FAIpQLScisdjJ5h9t7VgSOa8hmnmrJh6H5VSy84uyE32hhOgDQEU05w/viewform?usp=sharing&ouid=106991680453150303010"
          target="_blank"
          class="btn"
        >
          ×œ××¢×‘×¨ ×œ×˜×•×¤×¡ ×”×‘×§×©×•×ª
        </a>
      </div>
    </div>
  </section>

  <section id="contact" class="section-light reveal-on-scroll">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title" id="contact-section-title">×™×¦×™×¨×ª ×§×©×¨</h2>
        <p class="section-subtitle" id="contact-section-subtitle">× ×™×ª×Ÿ ×œ×¤× ×•×ª ××œ×™× ×• ×‘×›×œ ×©××œ×”, ×‘×§×©×” ××• ×”×ª×™×™×¢×¦×•×ª.</p>
      </div>

      <div class="contact-flex">
        <div class="contact-box contact-info">
          <p>ğŸ“ ×˜×œ×¤×•×Ÿ: <span id="contact-phone">04-6440334</span></p>
          <p>âœ‰ï¸ ××™××™×™×œ: <span id="contact-email">@example.com</span></p>
          <p>ğŸ“ ×›×ª×•×‘×ª: <span id="contact-address">×¨×—×•×‘ ×œ×“×•×’××” 10, ××’×“×œ ×”×¢××§</span></p>
        </div>

        <div class="contact-box map-container-small">
          <iframe
            src="https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d8626.962069771827!2d35.248568840191005!3d32.67741984975948!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x151c4d61e49b7fdf%3A0x844e2317b042759e!2z15HXmSLXoSDXmdei16jXqiDXlNei157XpyDXl9eYIteR!5e0!3m2!1siw!2sil!4v1764975107997!5m2!1siw!2sil"
            allowfullscreen=""
            loading="lazy">
          </iframe>
        </div>
      </div>
    </div>
  </section>

<footer class="site-footer">
  <div class="footer-inner">

    <!-- RIGHT: socials -->
    <div class="footer-col footer-right">
      <a class="soc" href="https://www.facebook.com/p/%D7%97%D7%98%D7%99%D7%91%D7%AA-%D7%94%D7%A0%D7%A2%D7%95%D7%A8%D7%99%D7%9D-%D7%99%D7%A2%D7%A8%D7%AA-%D7%94%D7%A2%D7%9E%D7%A7-%D7%9E%D7%92%D7%93%D7%9C-%D7%94%D7%A2%D7%9E%D7%A7-61565220180198/"
         target="_blank" rel="noopener">
        <img src="face.jpg" alt="Facebook">
      </a>
      <a class="soc" href="https://www.instagram.com/yaarathaemeq/"
         target="_blank" rel="noopener">
        <img src="inst.jpg" alt="Instagram">
      </a>
    </div>

    <!-- CENTER: copyright -->
    <div class="footer-col footer-center">
      Â© 2026 Â· ×›×œ ×”×–×›×•×™×•×ª ×©××•×¨×•×ª ×œ×‘×™×ª ×¡×¤×¨ ×™×¢×¨×ª ×”×¢××§
    </div>

    <!-- LEFT: developed by -->
    <div class="footer-col footer-left">
      <a href="https://ptzwebsitebuilding.vercel.app/"
         target="_blank" rel="noopener"
         class="footer-dev">
        <img src="peretzinho.png" alt="Peretzinho">
        <span>Developed by Peretzinho</span>
      </a>
    </div>

  </div>
</footer>



  <div id="to-top">â†‘</div>

<script>
(function () {
  const snippetEl = document.getElementById("hero-latest-snippet");
  const btnEl = document.getElementById("hero-latest-btn");
  const board = document.getElementById("home-board");
  if (!snippetEl || !btnEl || !board) return;

  function getCleanText(el){
    return (el?.textContent || "").replace(/\s+/g," ").trim();
  }

  function hasRealNews(){
    const t = getCleanText(board);
    if (!t) return false;
    if (t.includes("××™×Ÿ ×¢×“×™×™×Ÿ ×—×“×©×•×ª")) return false;
    if (t.includes("××™×Ÿ ×¢×“×™×™×Ÿ ×—×“×©×•×ª ×‘××ª×¨")) return false;
    return true;
  }

  function applyLatest(){
    // ×œ×•×§×— ××ª ×”×‘×œ×•×§ ×”×¨××©×•×Ÿ ×©×”×•× ×œ× empty-msg
    const firstItem =
      board.querySelector(":scope > :not(.empty-msg)") ||
      board.querySelector(".news-item, .board-item, article, .post, .card") ||
      board;

    const text = getCleanText(firstItem);
    if (!text) return false;

    // ××—×¤×© ×œ×™× ×§ ×œ×›×ª×‘×”
    const link =
      firstItem.querySelector("a[href]") ||
      board.querySelector("a[href]");

    snippetEl.textContent = text;

    if (link && link.getAttribute("href")) {
      btnEl.href = link.getAttribute("href");
      btnEl.textContent = "×œ×›×ª×‘×” ×”××œ××” â†’";
    } else {
      btnEl.href = "news.html";
      btnEl.textContent = "×œ×›×œ ×”×¢×“×›×•× ×™× â†’";
    }
    return true;
  }

  function showEmpty(){
    snippetEl.textContent = "×¢×“×™×™×Ÿ ××™×Ÿ ×¢×“×›×•×Ÿ ×—×“×©. ×‘×¨×’×¢ ×©×™×¢×œ×” â€“ ×”×•× ×™×•×¤×™×¢ ×›××Ÿ.";
    btnEl.href = "news.html";
    btnEl.textContent = "×œ×›×œ ×”×¢×“×›×•× ×™× â†’";
  }

  // 1) ×× ×›×‘×¨ ×™×© ×—×“×©×•×ª â€“ ××™×™×©×
  if (hasRealNews() && applyLatest()) return;

  // 2) ××—×›×” ×œ×˜×¢×™× ×” ×××™×ª×™×ª (poll ×§×¦×¨) ×•××– ××™×™×©×
  let tries = 0;
  const timer = setInterval(() => {
    tries++;
    if (hasRealNews() && applyLatest()) {
      clearInterval(timer);
    }
    if (tries >= 30) { // ~15 ×©× ×™×•×ª
      clearInterval(timer);
      if (!hasRealNews()) showEmpty();
    }
  }, 500);

})();
</script>


  <script>
    document.addEventListener("DOMContentLoaded", () => {
      document.body.classList.add("page-loaded");

      const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add("is-visible");
            observer.unobserve(entry.target);
          }
        });
      }, { threshold: 0.15 });

      document.querySelectorAll(".reveal-on-scroll").forEach((el) => observer.observe(el));
    });
  </script>

  <script>
    (function () {
      const btn = document.getElementById("nav-toggle");
      const menu = document.getElementById("nav-mobile");
      if (!btn || !menu) return;

      btn.addEventListener("click", (e) => {
        e.stopPropagation();
        const isOpen = menu.classList.toggle("open");
        btn.setAttribute("aria-expanded", String(isOpen));
        menu.setAttribute("aria-hidden", String(!isOpen));
      });

      menu.querySelectorAll("a").forEach((a) => {
        a.addEventListener("click", () => {
          menu.classList.remove("open");
          btn.setAttribute("aria-expanded", "false");
          menu.setAttribute("aria-hidden", "true");
        });
      });

      document.addEventListener("click", (e) => {
        if (menu.contains(e.target) || btn.contains(e.target)) return;
        menu.classList.remove("open");
        btn.setAttribute("aria-expanded", "false");
        menu.setAttribute("aria-hidden", "true");
      });
    })();
  </script>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.addEventListener('controllerchange', () => window.location.reload());

      navigator.serviceWorker.register('/service-worker.js')
        .then(reg => {
          if (!reg.waiting) return;

          const banner = document.getElementById('update-banner');
          banner.style.display = 'block';

          banner.onclick = () => reg.waiting.postMessage({ action: 'skipWaiting' });

          reg.waiting.addEventListener('statechange', (e) => {
            if (e.target.state === 'activated') window.location.reload();
          });
        })
        .catch(err => console.error('SW registration failed:', err));
    }
  </script>
<script>
(() => {
  const input = document.getElementById("globalSearchInput");
  const resBox = document.getElementById("globalSearchResults");
  const clearBtn = document.getElementById("globalSearchClear");
  if(!input || !resBox) return;

  const candidates = () => {
    // ×ª×ª××™× ×‘×§×œ×•×ª: ×œ×•×§×— ×›×•×ª×¨×•×ª + ×›×¨×˜×™×¡×™× × ×¤×•×¦×™×
    const nodes = Array.from(document.querySelectorAll(
      "h1,h2,h3,.home-board-item,.home-exam-item,.grade-card,.card,.news-card,a[href]"
    ));

    // ××¡× ×Ÿ ×›×¤×™×œ×•×™×•×ª ×•××—×–×™×¨ â€œ××•×‘×™×™×§×˜×™×â€
    const out = [];
    const seen = new Set();
    nodes.forEach(n => {
      const text = (n.innerText || n.textContent || "").trim();
      if(text.length < 3) return;

      let target = n.closest("section") || n.closest("[id]") || n;
      const id = target.id || n.id || "";
      if(!id) return;

      const key = id + "::" + text.slice(0,40);
      if(seen.has(key)) return;
      seen.add(key);

      out.push({ text, id });
    });
    return out;
  };

  const data = candidates();

  function render(q){
    q = q.trim().toLowerCase();
    if(!q){
      resBox.hidden = true;
      resBox.innerHTML = "";
      return;
    }

    const hits = data
      .filter(x => x.text.toLowerCase().includes(q))
      .slice(0, 8);

    if(!hits.length){
      resBox.hidden = false;
      resBox.innerHTML = `<div class="gs-item"><div class="gs-title">×œ× ××¦××ª×™ ×›×œ×•× ğŸ˜…</div><div class="gs-meta">× ×¡×” ××™×œ×” ××—×¨×ª</div></div>`;
      return;
    }

    resBox.hidden = false;
    resBox.innerHTML = hits.map(h => `
      <a class="gs-item" href="#${h.id}">
        <div class="gs-title">${escapeHtml(h.text.slice(0,60))}</div>
        <div class="gs-meta">×¤×ª×—</div>
      </a>
    `).join("");
  }

  function escapeHtml(s){
    return String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");
  }

  input.addEventListener("input", () => render(input.value));
  clearBtn.addEventListener("click", () => { input.value=""; render(""); input.focus(); });

  document.addEventListener("click", (e) => {
    if(resBox.contains(e.target) || input.contains(e.target)) return;
    resBox.hidden = true;
  });
})();
</script>

<script type="module" src="firebase-config.js"></script>
<script src="accessibility.js"></script>
<script type="module" src="home-poll-mini.js"></script>
<script type="module" src="app.js?v=41"></script>
<script type="module" src="home-class-picker.js"></script>
<script type="module" src="./urgent.js"></script>
<script type="module" src="index.js?v=1"></script>
<script type="module" src="/analytics.js"></script>

</body>
</html>